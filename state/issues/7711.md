---
number: 7711
title: "TUI streaming inconsistent - '(no output)' shown during some tool executions"
author: quantummecharobots
created: 2026-02-03T04:19:04Z
updated: 2026-02-03T04:19:04Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7711
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

TUI streaming output is inconsistent. Some commands show real-time streaming output during execution, while others show "(no output)" until the command completes. This makes it appear frozen when running longer operations.

## Version

- openclaw: 2026.2.1
- Platform: macOS 26.2 (Darwin 25.2.0, arm64)
- Node: 25.3.0

## Steps to Reproduce

1. Start `openclaw tui`
2. Run various commands that invoke tools (exec, etc.)
3. Observe that some show streaming output while others show "(no output)" until completion

## Expected Behavior

All tool executions should show streaming output in real-time as the tool produces output.

## Actual Behavior

Intermittent - some commands stream properly, others show "(no output)" during execution and only display results after completion.

## Analysis

After investigation, a potential root cause was identified:

In `server-methods/chat.js` (the TUI/webchat handler), there is no `context.addChatRun()` call after setting up the chat abort controller. Compare to `server-bridge-methods-chat.js` (line ~309) which does call `ctx.addChatRun()`.

Without this registration:
1. `chatRunState.registry.peek(evt.runId)` returns undefined in the agent event handler
2. `sessionKey` becomes undefined in streaming events
3. TUI filters out events where `evt.sessionKey !== state.currentSessionKey` (in `tui-event-handlers.js` line 56-58)
4. All streaming deltas are silently dropped

The intermittent nature suggests multiple code paths, some of which properly register the run and others that don't.

## Relevant Files

- `/dist/gateway/server-methods/chat.js` - missing `addChatRun` 
- `/dist/gateway/server-bridge-methods-chat.js` - has `addChatRun` (working reference)
- `/dist/gateway/server-chat.js` - `createAgentEventHandler` checks sessionKey
- `/dist/tui/tui-event-handlers.js` - filters events by sessionKey

## Comments


## Links

- None detected yet
