---
number: 3323
title: "fix: groupPolicy 'open' ignored when explicit group configs exist"
author: impozzible
created: 2026-01-28T12:51:50Z
updated: 2026-01-28T15:07:52Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3323
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

When `groupPolicy: "open"` is configured, groups should be allowed without needing explicit entries in `channels.whatsapp.groups`. However, if ANY group has explicit configuration (e.g., `requireMention: true`), ALL other groups are blocked.

## Steps to Reproduce

1. Configure WhatsApp with:
```json
{
  "channels": {
    "whatsapp": {
      "groupPolicy": "open",
      "groupAllowFrom": ["*"],
      "groups": {
        "123456789@g.us": { "requireMention": true }
      }
    }
  }
}
```

2. Get mentioned in a different group (e.g., `987654321@g.us`)
3. The bot does NOT respond, even though `groupPolicy: "open"`

## Expected Behavior

With `groupPolicy: "open"`, all groups should be allowed. Explicit group entries should only be used for per-group settings (like `requireMention`), not as an implicit allowlist.

## Actual Behavior

The presence of any explicit group config in `channels.whatsapp.groups` creates an implicit allowlist, blocking all groups not explicitly listed â€” even when `groupPolicy: "open"`.

## Root Cause

In `src/config/group-policy.ts`, `resolveChannelGroupPolicy()`:

```typescript
const allowlistEnabled = Boolean(groups && Object.keys(groups).length > 0);
```

This enables allowlist mode whenever ANY group config exists, ignoring the `groupPolicy` setting.

## Proposed Fix

Only enable allowlist when `groupPolicy === "allowlist"`:

```typescript
const groupPolicy = channelConfig?.groupPolicy ?? "open";
const allowlistEnabled = groupPolicy === "allowlist" && Boolean(groups && Object.keys(groups).length > 0);
```

## Environment

- Clawdbot version: 2026.1.24-3
- Channel: WhatsApp

## Comments


## Links

- None detected yet
