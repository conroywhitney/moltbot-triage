---
number: 2321
title: "[Feature]: security audit: warn when API keys appear in auth profile names"
author: spanishflu-est1918
created: 2026-01-26T18:25:23Z
updated: 2026-01-28T06:02:45Z
labels: ["enhancement"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2321
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

Users can accidentally create auth profile names that contain their actual API key:

```json
{
  "auth": {
    "profiles": {
      "anthropic:sk-[REDACTED]": {
        "provider": "anthropic",
        "mode": "token"
      }
    }
  }
}
```

This typically happens when:
- Copy-pasting from provider dashboards
- Misconfigured import scripts
- Confusion between profile ID and token value

Profile names appear in:
- Logs (session routing, model selection)
- Error messages
- UI dropdowns
- Potentially shared configs

## Proposed Solution

Add a check to `security audit` that scans auth profile keys for patterns matching known API key formats:

- `sk-ant-*` (Anthropic)
- `sk-proj-*`, `sk-*` (OpenAI)
- `gsk_*` (Groq)
- `xai-*` (xAI)
- Generic high-entropy strings > 32 chars

## Example Warning

```
WARN  auth.profiles.key_in_name  API key detected in profile name
  Profile "anthropic:sk-ant-[REDACTED]..." appears to contain an API key.
  Profile names are not secrets and may appear in logs.
  Fix: Rename to a descriptive ID like "anthropic:personal" or "anthropic:work"
```

## Severity

Suggest WARN level (not CRITICAL) since the token itself is stored separately and this is primarily an information disclosure risk in logs/UI.

## Comments


## Links

- None detected yet
