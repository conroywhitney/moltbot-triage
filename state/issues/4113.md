---
number: 4113
title: "Matrix: Include reply-to message content in inbound context"
author: andreasdueren
created: 2026-01-29T17:59:59Z
updated: 2026-01-29T17:59:59Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4113
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Feature Request

When a user replies to a specific message in Matrix (using the native reply feature), the Matrix plugin currently passes the `ReplyToId` (event ID) to the agent, but **not the content of the replied-to message**.

This means the agent cannot see *which* message the user is referring to, making reply-based conversations difficult. The user has to manually quote or describe what they're replying to.

### Current behavior
- `m.relates_to.m.in_reply_to.event_id` is extracted and passed as `ReplyToId`
- The agent sees the event ID (e.g. `$abc123`) but has no way to retrieve its content
- Result: Agent asks "what do you mean?" when user replies to a specific message

### Expected behavior
- When a message has `m.in_reply_to`, fetch the referenced event's content
- Include the quoted message text in the agent prompt (e.g. as `[Replying to: "..."]` or a similar envelope)
- This would allow the agent to understand context without the user having to repeat themselves

### Context
The Matrix protocol already includes the replied-to content in the `formatted_body` as a blockquote (`<mx-reply>`), but this is stripped during body extraction. Either:
1. Parse the `<mx-reply>` block from `formatted_body` and include it as context, or
2. Fetch the original event via the Matrix client SDK and include its body

### References
- Handler code: `extensions/matrix/src/matrix/monitor/handler.ts` (line ~433: `replyToEventId`)
- Thread resolution: `extensions/matrix/src/matrix/monitor/threads.ts`

## Comments


## Links

- None detected yet
