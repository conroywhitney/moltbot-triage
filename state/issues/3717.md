---
number: 3717
title: "Feature Request: turn:complete and gateway:pre-restart hook events"
author: Rsteen76
created: 2026-01-29T03:04:23Z
updated: 2026-01-29T03:04:23Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/3717
duplicate_of: null
related_issues: [1913,2538,3574]
blocks: []
blocked_by: []
---

## Description

## Summary

Proposing two new hook events for context preservation:
- \	urn:complete\ — Fires after each successful agent turn
- \gateway:pre-restart\ — Fires before SIGUSR1 restart processing (related to #1913)

## Motivation

Building an assistant that maintains context across sessions and restarts. Currently, critical context (credentials, decisions, progress) can be lost during compaction or restarts.

The existing \session-memory\ hook only fires on \/new\ and \/reset\ — there's no way to capture context incrementally during a conversation or before a restart.

## Use Case

Auto-extract important facts to a knowledge graph after each turn, and checkpoint context before any restart.

## Prior Art
- Claude-Mem uses PostToolUse hook for incremental extraction
- #1913 requests \gateway:shutdown\ for similar cleanup
- #2538 requests \	ool:start\/\	ool:end\ for real-time feedback

## Implementation Notes

Audited the codebase — clean insertion points identified:
- \	urn:complete\ → \^Ggent-runner.ts\ before \inalizeWithFollowup()\
- \gateway:pre-restart\ → \un-loop.ts\ in \onSigusr1()\

## Questions Before Implementation
1. Is there a design reason these hooks don't exist yet?
2. Concerns about per-turn hook performance? (Re: #3574 OOM issue)
3. Would a PR be welcome?

Happy to implement if there's interest.

## Environment
- Clawdbot version: 2026.1.24-3
- Use case: Personal AI assistant with persistent knowledge graph

## Comments


## Links

- None detected yet
