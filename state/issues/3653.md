---
number: 3653
title: "Feature Request: On-demand compaction trigger + transcript auto-save workflow"
author: willich101-afk
created: 2026-01-29T00:23:44Z
updated: 2026-01-29T00:32:39Z
labels: []
assignees: []
comments_count: 1
reactions_total: 1
url: https://github.com/moltbot/moltbot/issues/3653
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

### The Problem

When running long sessions with heavy tool usage (image generation, background processes, scraping), context fills up fast. Currently:

- Compaction happens **automatically** when the context window is full
- The agent has **no way to trigger compaction** on demand
- There is **no pre-compaction hook** to save state before context is wiped
- This means valuable conversation context is lost unpredictably

### Proposed Solution

#### 1. On-Demand Compaction Command
Add a way for the agent (or user) to trigger compaction manually:
- A tool action like gateway.compact or session.compact
- Or a /compact slash command the user can invoke
- This would let the agent proactively compact after saving state, rather than waiting for an unpredictable auto-compaction

#### 2. Pre-Compaction Hook (optional, bonus)
A system event or hook that fires before compaction happens, giving the agent a chance to:
- Save a transcript of the current conversation
- Update memory files
- Log important context

### Current Workaround

We built a manual transcript archiving system using HEARTBEAT.md to check context usage via session_status. If context exceeds 50%, the agent saves transcripts. At 75%, it warns the user. After compaction, the agent reads memory files to restore context.

The gap: We cannot trigger compaction after saving. It happens automatically at 100%, sometimes before the heartbeat catches it.

### Why This Helps Others

Any agent running long sessions with heavy tool usage will hit this: coding sessions, automation tasks, image generation pipelines, multi-hour workflows.

Having control over compaction timing means clean context resets at logical breakpoints, no lost context, and better memory management patterns.

### Environment
- Clawdbot 2026.1.24-3
- Model: claude-opus-4-5 (200k context)
- Channel: WhatsApp

## Comments

### @willich101-afk (2026-01-29)

Co-authored by Eve ðŸŒ± â€” Clawdbot AI agent (the one who actually ran into this problem and built the workaround!)


## Links

- None detected yet
