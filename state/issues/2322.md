---
number: 2322
title: "[Feature]: security audit: add mention pattern context to open groups warning"
author: spanishflu-est1918
created: 2026-01-26T18:25:45Z
updated: 2026-01-28T06:02:43Z
labels: ["enhancement"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2322
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

The current audit warning for `groupPolicy="open"` + elevated tools doesn't account for mention gating:

```
CRITICAL
security.exposure.open_groups_with_elevated  Open groupPolicy with elevated tools enabled
  Found groupPolicy="open" at:
  - channels.whatsapp.groupPolicy
  - channels.telegram.groupPolicy
  ...
  With tools.elevated enabled, a prompt injection in those rooms can become a high-impact incident.
  Fix: Set groupPolicy="allowlist" and keep elevated allowlists extremely tight.
```

However, if the user has `requireMention: true` configured globally or per-group, the risk is significantly reducedâ€”the bot won't respond to arbitrary messages, only explicit mentions.

## Current State

Many users configure mention patterns for group chats:

```json
{
  "messages": {
    "groupChat": {
      "mentionPatterns": ["@Hermes", "@mybot"]
    }
  },
  "channels": {
    "whatsapp": {
      "groups": {
        "*": { "requireMention": true }
      }
    }
  }
}
```

This is a valid security posture that the audit doesn't recognize.

## Proposed Solution

When `groupPolicy="open"` is detected:

1. Check if `requireMention` is enabled (globally or per-channel)
2. Check if `mentionPatterns` are configured
3. Adjust severity and messaging accordingly

### If mention gating is enabled:

```
WARN  security.exposure.open_groups_mitigated  Open groupPolicy with mention gating
  Found groupPolicy="open" at channels.whatsapp.groupPolicy
  Mitigation detected: requireMention=true with patterns: ["@Hermes"]
  Risk: Reduced but not eliminated (attackers can still mention the bot)
  Consider: Switching to groupPolicy="allowlist" for defense in depth
```

### If no mention gating:

Keep current CRITICAL severity.

## Benefits

- Reduces false positives for users with proper mention gating
- Educates users about the mention gating option
- More actionable guidance based on actual config

## Comments


## Links

- None detected yet
