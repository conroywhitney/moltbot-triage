---
number: 2654
title: "[Bug]: Cron isolation internal errors (gateway timeout) leak to messaging surfaces via postToMain"
author: Wei-EVA
created: 2026-01-27T08:09:09Z
updated: 2026-01-28T05:59:49Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2654
duplicate_of: null
related_issues: [919,1755,2415]
blocks: []
blocked_by: []
---

## Description

## Bug

When a cron isolated job encounters a gateway timeout, the internal error message `"âš ï¸ ğŸ§² Cron: list failed: gateway timeout after 10000ms"` is forwarded to the WhatsApp group chat via the `postToMain` mechanism. All group members can see this cryptic system error.

## Steps to Reproduce

1. Configure a cron job with `sessionTarget: "isolated"` + `isolation.postToMainPrefix: "Cron"` + `deliver: true` targeting a WhatsApp group
2. Job fires at scheduled time
3. During execution, the cron agent internally calls `cron list` (or another gateway API)
4. Gateway responds slowly (>10000ms timeout)
5. Error message is forwarded to the group chat as if it were a normal agent reply

## Expected Behavior

- Internal gateway timeout errors should NOT leak to messaging surfaces
- `postToMain` should filter/suppress system-level errors (gateway timeouts, tool failures, etc.)
- Errors should be logged internally only, or replaced with a user-friendly fallback message
- At minimum, the `postToMainMode` summary/full filter should strip internal error prefixes

## Actual Behavior

The raw error `"âš ï¸ ğŸ§² Cron: list failed: gateway timeout after 10000ms"` is sent directly to the WhatsApp family group chat, visible to all members.

## Screenshot

The error appears right after a successful cron delivery (morning family schedule reminder):

```
â˜˜ï¸ æ—©å®‰ï¼å‘¨äºŒå®¶åº­æ—¥ç¨‹æé†’ â˜˜ï¸          08:01 âœ“
âš ï¸ ğŸ§² Cron: list failed: gateway timeout after 10000ms   08:01 âœ“
```

## Environment

- Clawdbot version: 2026.1.24-0
- Node: v22.17.1
- OS: macOS 24.6.0 (arm64)
- Channel: WhatsApp
- Provider: Anthropic (claude-opus-4-5)

## Cron Job Config (relevant fields)

```json
{
  "sessionTarget": "isolated",
  "wakeMode": "next-heartbeat",
  "payload": {
    "kind": "agentTurn",
    "deliver": true,
    "channel": "whatsapp",
    "to": "<group-id>@g.us"
  },
  "isolation": {
    "postToMainPrefix": "Cron",
    "postToMainMode": "summary",
    "postToMainMaxChars": 2000
  }
}
```

## Suggested Fix

In the `postToMain` pipeline (where isolated session output is relayed to the main session or delivery target), add a filter to detect and suppress internal system errors:

- Check if the message matches known error patterns (`gateway timeout`, `list failed`, tool errors, etc.)
- If the isolated session produced only an error (no user-facing content), either:
  - Suppress delivery entirely and log the error
  - Replace with a generic fallback: "âš ï¸ Scheduled task encountered a temporary issue"
  - Route to admin/owner DM only instead of the group target

## Related Issues

- #919 (closed) â€” Raw API error JSON forwarded to Telegram
- #2415 (open) â€” Tool ENOENT errors leak to messaging surfaces  
- #1755 (open) â€” Feature request: Cron job retry policy on API failures

All three share a common theme: internal errors reaching user-facing messaging surfaces.

## Comments

### @Evizero (2026-01-27)

maybe relevant to #2422 which is about improving cron isolation


## Links

- None detected yet
