---
number: 6174
title: "Nextcloud Talk: Bot responses fail with 401 (signature rejected) on Talk 22.x"
author: maxxeee
created: 2026-02-01T10:46:11Z
updated: 2026-02-01T21:04:24Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6174
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description


## Environment
- **OpenClaw version:** 2026.1.29
- **Nextcloud version:** 32.0.3.2
- **Nextcloud Talk (spreed) version:** 22.0.8
- **Deployment:** Nextcloud AIO (Docker)

## Problem
The Nextcloud Talk plugin successfully **receives** webhook messages from Nextcloud, but **sending responses fails** with HTTP 401 (Unauthorized).

## Steps to reproduce
1. Install bot on Nextcloud:
   ```bash
   occ talk:bot:install "Bot" "<secret>" "http://<gateway>:8788/nextcloud-talk-webhook" --feature webhook --feature response --feature reaction

2. Enable bot in a room
3. Send message in room → OpenClaw receives it via webhook ✅
4. OpenClaw tries to respond → 401 error
Error log

nextcloud-talk final reply failed: Error: Nextcloud Talk: authentication failed - check bot secret

Investigation

• Webhook signature verification works (incoming messages received)
• Response uses same secret with HMAC-SHA256(random + body, secret)
• Headers: X-Nextcloud-Talk-Bot-Random, X-Nextcloud-Talk-Bot-Signature
• Fresh bot installation with new secret still fails
• Manual curl test with same signature method also returns 401
Possible cause

The bot response API signature format may have changed in Talk 22.x.

## Comments


## Links

- None detected yet
