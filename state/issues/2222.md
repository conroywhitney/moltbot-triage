---
number: 2222
title: "Add first-token timeout for faster model failover"
author: Tonii0908
created: 2026-01-26T13:27:09Z
updated: 2026-01-29T08:41:48Z
labels: ["enhancement"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2222
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When a model doesn't respond at all (no tokens), Clawdbot waits the full `agents.defaults.timeoutSeconds` (default 600s = 10 minutes) before failing over to the next model.

### Example from logs:

```
12:47:13 embedded run start: provider=google-antigravity model=gemini-3-pro-high
12:57:13 embedded run timeout: timeoutMs=600000
12:57:13 Profile google-antigravity:user@example.com timed out (possible rate limit). Trying next account...
```

The model produced **zero tokens** for 10 minutes before failover triggered.

## Expected behavior

A separate, shorter timeout (e.g. 30-60s) for "no first token received" that triggers immediate failover.

### Distinction:
- **Model is streaming slowly** → wait (use run timeout)
- **Model produces nothing at all** → fail fast (use first-token timeout)

## Suggested solution

Add a config option like:
```json
{
  "agents": {
    "defaults": {
      "firstTokenTimeoutSeconds": 60
    }
  }
}
```

If no token is received within this window, treat it as a timeout and trigger profile rotation / model failover immediately.

## Environment
- Clawdbot version: 2026.1.24-3
- Primary model: google-antigravity/gemini-3-pro-high
- Fallbacks configured: yes

## Comments

### @tonydehnke (2026-01-29)

+1 - this would really help with Synthetic provider issues.

I'm seeing hangs where the model produces zero tokens for 2+ minutes before the typing TTL expires. The current behavior:

1. Request goes to Kimi K2.5 via Synthetic
2. No first token received
3. Wait... wait... (no timeout, no failover)
4. Typing indicator TTL expires after 2 minutes
5. User gets nothing

A configurable `firstTokenTimeoutSeconds` (defaulting to 30-60s as you suggested) would be perfect. If no token arrives in that window, trigger immediate failover to the next model in the chain (e.g., MiniMax → Gemini Flash).

This would make the existing fallback configuration actually useful for hung requests, not just explicit errors.


## Links

- None detected yet
