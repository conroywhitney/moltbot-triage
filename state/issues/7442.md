---
number: 7442
title: "[BUG] Streaming event sequence gaps - events silently dropped during active sessions"
author: henrybottter
created: 2026-02-02T20:50:37Z
updated: 2026-02-02T20:50:37Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7442
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

During active Claude Code / OpenClaw gateway sessions, the client reports streaming event sequence gaps where one or more events are silently dropped. The user sees: `event gap detected (expected seq X, got Y); refresh recommended`

This occurs both early in sessions (seq 164) and deep into long sessions (seq 12162, 17693, 20183, 20300), suggesting it is not purely related to session duration.

## Steps to Reproduce

1. Run an active session with tool usage (web search, file reads, edits, browser snapshots)
2. Continue session for any duration (observed from minutes to hours)
3. Observe intermittent event gap warnings in the client

## Observed Behavior

### Session 1 (Claude Code CLI on Windows, 2026-02-02):
- 11:14 — `expected seq 17693, got 17695` (2 events lost)
- 11:57 — `expected seq 20183, got 20184` (1 event lost)
- 12:10 — `expected seq 20300, got 20301` (1 event lost)

### Session 2 (OpenClaw gateway webchat on Windows, 2026-02-02):
- 18:44 — `expected seq 12162, got 12163` (1 event lost, correlated with WebSocket "max payload size exceeded")
- 21:35 — `expected seq 164, got 165` (1 event lost, 2 minutes after fresh gateway restart, no large payloads)

### Key observations:
- Gateway logs show NO sequence/gap errors on the gateway side
- The seq 164 gap occurred very early in a fresh session, ruling out session duration as sole cause
- One gap correlated with a WebSocket "max payload size exceeded" error (large browser snapshot response)
- Other gaps had no correlated errors

## Expected Behavior

All streaming events should be delivered in sequence without gaps. If a transient error occurs, events should be retried or the client should be able to recover gracefully without manual refresh.

## Environment

- OpenClaw version: 2026.2.1 (ed4529e)
- Claude Code: latest
- OS: Windows 10 (10.0.19045)
- Node.js: v24.13.0
- Model: claude-opus-4-5
- Channels: webchat (WebSocket) + Telegram
- Tool usage: heavy (50+ tool calls between some gaps)

## Impact

- Silent data loss — user cannot know what was in dropped events
- Potential context corruption if dropped events contained tool results
- "refresh recommended" is vague — unclear if this means restart session or just reload UI
- Occurs across both Claude Code CLI and OpenClaw gateway webchat

## Questions for maintainers

1. Are dropped events recoverable server-side?
2. Does the client have a retry mechanism for gaps?
3. Is this related to Anthropic API streaming or to the local WebSocket relay?
4. Could large response payloads (e.g. browser snapshots > WS max payload) cause upstream gaps?
5. Is there a configuration to increase WebSocket max payload size?

## Comments


## Links

- None detected yet
