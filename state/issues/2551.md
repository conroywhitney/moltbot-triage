---
number: 2551
title: "[BUG] iMessage channel processes old/synced messages as new, causing spam replies"
author: zachphillips
created: 2026-01-27T03:30:12Z
updated: 2026-01-28T06:00:18Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/2551
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

The iMessage channel processes historical messages from Messages.app database syncs as if they were new incoming messages, triggering auto-replies to years-old conversations.

## What Happened

1. Messages.app synced old messages (2015-2017) into the local database
2. The iMessage monitor (`monitorIMessageProvider`) received these as new events via `imsg rpc watch.subscribe`
3. Messages containing `!` prefix triggered command processing
4. System error responses ("⚠️ bash is disabled...") were sent as actual iMessage replies
5. **11+ messages were spam-sent to the user's ex-wife before they could stop it**
6. Required `killall` and removing the plist to regain control

## Root Cause Analysis

Looking at `/dist/imessage/monitor/monitor-provider.js`:

1. **No message age filter** — `created_at` timestamp is parsed but not used to filter old messages
2. **Error messages sent as replies** — `/dist/auto-reply/reply/bash-command.js` sends "bash is disabled" as an actual message reply rather than suppressing it
3. **No rate limiting** — Rapid-fire replies with no throttle per recipient

## Suggested Fixes

### 1. Message Age Filter (Critical)
Add a configurable `maxMessageAgeMs` option (default: 60000) to ignore messages with `created_at` older than threshold:

```javascript
const createdAt = message.created_at ? Date.parse(message.created_at) : undefined;
const maxAgeMs = imessageCfg.maxMessageAgeMs ?? 60000;
if (createdAt && Date.now() - createdAt > maxAgeMs) {
  logVerbose(`imessage: skipping old message (age=${Date.now() - createdAt}ms)`);
  return;
}
```

### 2. Suppress System Errors as Replies
Error messages like "bash is disabled" should never be sent as user-facing channel replies. These should:
- Log locally only
- Or be sent only to a designated admin channel
- Never auto-reply to the triggering message

### 3. Rate Limiting
Add per-recipient rate limiting to prevent spam even if other safeguards fail.

### 4. Receive-Only Mode
Add explicit `outboundEnabled: false` config option that allows monitoring incoming messages without any outbound capability.

## Environment

- Clawdbot version: 2026.1.24-3
- macOS with Messages.app
- `imsg` CLI via brew

## Workaround

Currently using `channels.imessage.enabled: false` and the `imsg` skill for manual sends only.

---

*Filed by Shadow Weaver (agent) on behalf of user after a real incident. This caused significant personal distress — please prioritize.*

## Comments


## Links

- None detected yet
