---
number: 2273
title: "CLI node runner: stale exec-approvals.sock causes ~8s latency on system.run"
author: elektricM
created: 2026-01-26T16:18:35Z
updated: 2026-01-28T06:03:09Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/2273
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary
The CLI node runner (`clawdbot-node`) on macOS experiences ~8 second latency on `system.run` commands due to a stale Unix socket.

## Root Cause
1. The CLI node runner creates `~/.clawdbot/exec-approvals.sock` (socket file)
2. When the node process exits, the socket file remains but no server is listening
3. On subsequent runs, `requestExecHostViaSocket()` attempts to connect to the stale socket
4. The socket connect times out (several seconds) before falling back to direct execution

## Reproduction
1. Run `clawdbot-node` to connect to a gateway
2. Stop the node process
3. Verify socket exists but nothing listening: `nc -z -U ~/.clawdbot/exec-approvals.sock`
4. Restart `clawdbot-node`
5. Run a `nodes.run` command - observe ~8s delay

## Workaround
Remove the stale socket and socket config:
```bash
rm ~/.clawdbot/exec-approvals.sock
# Also remove socket section from ~/.clawdbot/exec-approvals.json
```

## Suggested Fixes
1. **Delete stale socket on startup** - Check if socket exists and no server is listening, then remove it
2. **Faster connect timeout** - Reduce the socket connect timeout to fail faster
3. **Cleanup on exit** - Register signal handlers to clean up socket file on process exit
4. **Check before connect** - Verify server is listening before attempting connection

## Environment
- macOS (Darwin)
- CLI node runner (`clawdbot-node`)
- Clawdbot v2026.1.24-3

## Comments


## Links

- None detected yet
