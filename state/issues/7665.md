---
number: 7665
title: "[Bug]: Browser control service timeout and CDP port start failure"
author: jhzhang09
created: 2026-02-03T03:13:49Z
updated: 2026-02-03T03:20:14Z
labels: []
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7665
duplicate_of: null
related_issues: [7630]
blocks: []
blocked_by: []
---

## Description

### Description
The browser control service frequently enters an unreachable state, timing out after 15000ms. Even after a gateway restart, attempts to start a browser profile fail with port-related errors.

### Steps to Reproduce
1. Run a long session involving multiple browser actions and potential LLM timeouts (429/408).
2. Encounter a session reset or model switch.
3. Call `browser action=start` or any browser action.
4. Observe timeout error.

### Observed Errors
- `Can't reach the openclaw browser control service (timed out after 15000ms).`
- `Error: Failed to start Chrome CDP on port 18800 for profile "openclaw".`

### Context
- Model: Gemini 3 Flash / Claude 4.5 Thinking
- Platform: Debian Linux
- Runtime version: 2026.2.1

Possible relation to Issue #7630 regarding session lane deadlocks.

## Comments

### @jhzhang09 (2026-02-03)

### Technical Analysis & Hypothesis

Based on further investigation within the Debian environment (RDP/xrdp), this deadlock appears to be a conflict between the user's graphical session (X11) and the agent's background browser automation.

#### 1. X11 Display & Authority Lock
When an RDP session is active (e.g., `DISPLAY=:10`), Chrome's startup sequence may attempt to attach to the existing X server context or become blocked by stale `.Xauthority` / Socket files in `/tmp/.X11-unix/`. If the automation engine attempts to launch Chrome while the OS is in a "disconnected but not logged out" state, it can lead to indefinite hangs during the handshake, triggering the 15s timeout.

#### 2. SingletonLock Persistence
Non-graceful exits (e.g., model 429 errors or gateway force-kills) leave a `SingletonLock` file in the `UserDataDir`. Subsequent attempts to start the browser via the control service may fail because the new process tries to "delegate" to the defunct process holding the lock, resulting in the "Failed to start CDP on port X" error.

#### 3. GPU/Sandbox Conflict in Virtualized Environments
In environments without hardware acceleration, the automation engine's attempt to inherit GUI environment variables while potentially needing `--disable-gpu` can cause the process to hang at the kernel level during rendering initialization.

#### Recommended Fixes:
- Implement automatic detection and cleanup of `SingletonLock` files before browser launch.
- Add a "Safe Mode" or "Headless Force" fallback when the primary CDP handshake fails.
- Improved logging for the `browser/service` subsystem to distinguish between IPC failure and browser process hang.


## Links

- None detected yet
