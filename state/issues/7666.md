---
number: 7666
title: "Sub-agent announce fails with gateway timeout when parent session is active"
author: a692570
created: 2026-02-03T03:14:16Z
updated: 2026-02-03T03:15:05Z
labels: []
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7666
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

Sub-agent announce-back consistently fails with `gateway timeout after 60000ms` when the parent session lane is actively in use (user chatting with the main agent).

## Reproduction

1. Have an active conversation in a Telegram group topic session
2. Spawn a sub-agent via `sessions_spawn`
3. Sub-agent completes successfully (generates response, `stopReason: stop`)
4. Announce step never delivers to chat
5. Gateway log shows: `announce queue drain failed for <session>: Error: gateway timeout after 60000ms`

## Environment

- OpenClaw version: tested on both `2026.1.30` and `2026.2.1`
- Channel: Telegram (group with forum topics)
- Parent session: `agent:main:telegram:group:<id>:topic:1`
- Sub-agent models: tested with both LiteLLM/Kimi and LiteLLM/MiniMax

## Logs

```
2026-02-01T20:00:26.409Z Subagent announce failed: Error: gateway timeout after 60000ms
2026-02-01T20:02:13.688Z announce queue drain failed for agent:main:main: Error: gateway timeout after 60000ms
2026-02-01T23:16:36.144Z announce queue drain failed for agent:main:main: Error: gateway timeout after 60000ms
2026-02-02T02:54:54.313Z announce queue drain failed for agent:main:main: Error: gateway timeout after 60000ms
2026-02-02T20:32:30.325Z Subagent announce failed: Error: gateway timeout after 60000ms
2026-02-03T02:43:34.676Z announce queue drain failed for agent:main:telegram:group:<id>:topic:1: Error: gateway timeout after 60000ms
```

Also observed lane wait warnings:
```
2026-02-03T02:15:16.303Z [diagnostic] lane wait exceeded: lane=session:agent:main:telegram:group:<id>:topic:1 waitedMs=46036 queueAhead=0
2026-02-03T02:44:10.254Z [diagnostic] lane wait exceeded: lane=session:agent:main:telegram:group:<id>:topic:1 waitedMs=95248 queueAhead=0
```

## Analysis

The announce step needs to run an agent call on the parent session lane to format and deliver the result. When the parent session is actively processing a user message (or the user is chatting frequently), the lane is occupied. The announce queues behind it, waits, and times out after 60 seconds.

This affects both DM sessions (`agent:main:main`) and group topic sessions.

## Expected Behavior

Sub-agent announces should reliably deliver to chat regardless of parent session activity. Possible approaches:
- Announce could bypass the session lane (deliver directly without an agent formatting call)
- Announce could use a separate lane/queue with higher priority
- Announce timeout could be extended or made configurable

## Workaround

Main agent manually checks sub-agent results via `sessions_list` / `sessions_history` and relays them to chat.

## Comments

### @a692570 (2026-02-03)

**Additional finding:** This is NOT channel-specific. Announce has been failing since Jan 30 across all session types:

- `agent:main:main` (DM/default session, pre-group)
- `agent:main:telegram:group:<id>:topic:1` (group topic session)

Full log shows **every single announce has failed** since sub-agents were first configured (Jan 30). Two error types:
1. `gateway timeout after 60000ms` (lane busy, announce times out)
2. `gateway closed (1006 abnormal closure)` (WebSocket dropped during wait)

This means announce-back has likely **never worked** for sessions with active conversation. It's a lane scheduling issue, not a channel or Telegram issue.


## Links

- None detected yet
