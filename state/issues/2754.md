---
number: 2754
title: "Duplicate plugin ID warning after plugin update due to leftover backup folder"
author: jungjaehoon-lifegamez
created: 2026-01-27T12:50:21Z
updated: 2026-01-28T05:59:08Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2754
duplicate_of: null
related_issues: [1750]
blocks: []
blocked_by: []
---

## Description

## Environment
- Clawdbot version: 2026.1.24-3
- OS: Linux (SteamOS)
- Node.js: v22.x

## Steps to Reproduce
1. Install plugin: `clawdbot plugins install @jungjaehoon/clawdbot-mama`
2. Update plugin: `clawdbot plugins update clawdbot-mama`
3. Restart gateway: `clawdbot gateway restart`
4. Observe "duplicate plugin id detected: clawdbot-mama" warning in logs

## Expected Behavior
Backup folder should be cleaned up after successful update, or excluded during discovery.

## Actual Behavior
- `.backup-{timestamp}` folder remains in `~/.clawdbot/extensions/`
- `discovery.js` scans all subdirectories including backup folders
- Same plugin ID is loaded twice, causing warning

## Root Cause Analysis

`dist/plugins/install.js` (lines 93-96):
```javascript
const backupPath = `${existingPath}.backup-${Date.now()}`;
await fs.rename(existingPath, backupPath);
```

`dist/plugins/discovery.js` (lines 78-94):
```javascript
const entries = await fs.readdir(extensionsPath, { withFileTypes: true });
for (const entry of entries) {
  if (entry.isDirectory()) {
    // Backup folders are processed here too
  }
}
```

## Suggested Fix

**Option A:** Exclude backup folders in discovery.js
```javascript
if (entry.isDirectory() && !entry.name.startsWith('.backup-')) {
```

**Option B:** Delete backup folder after successful update in install.js
```javascript
await fs.rm(backupPath, { recursive: true });
```

## Workaround
```bash
rm -rf ~/.clawdbot/extensions/*.backup-*
```

---

## Context

Related to #1750 - After MCP support was added, I tried using mcporter to integrate [MAMA](https://github.com/jungjaehoon-lifegamez/MAMA) (Memory-Augmented MCP Assistant). However, mcporter couldn't replicate the hooks/skills-based auto-context injection experience I had with Claude Code.

So I developed a native Clawdbot plugin [@jungjaehoon/clawdbot-mama](https://www.npmjs.com/package/@jungjaehoon/clawdbot-mama) using lifecycle hooks (`before_agent_start`, `agent_end`) and published it to npm.

While testing the 0.1.x â†’ 0.2.0 version update in production, I discovered this bug and traced the root cause.

## Comments


## Links

- None detected yet
