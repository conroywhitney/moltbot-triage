---
number: 4552
title: "The Clawdbot gateway crashes with an unhandled promise rejection during normal operation, causing the entire process to terminate."
author: EddieItelman
created: 2026-01-30T09:37:02Z
updated: 2026-01-30T13:14:06Z
labels: []
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4552
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

                                                                                                                                                                                                                                                            
 Unhandled promise rejection: TypeError: fetch failed                                                                                                                                                                                                         
     at node:internal/deps/undici/undici:16416:13                                                                                                                                                                                                             
     at processTicksAndRejections (node:internal/process/task_queues:104:5)                                                                                                                                                                                   
                                                                                                                                                                                                                                                              
 ```                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                              
   ## Pattern Observed                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                              
   The crashes occur **4-11 minutes after agent runs complete**, suggesting a background task (health check, telemetry, or periodic cleanup) making HTTP requests without proper error handling.                                                              
                                                                                                                                                                                                                                                              
   Example timestamps from logs:                                                                                                                                                                                                                              
   - Agent completes at 07:19:38, crash at 07:23:40 (4 min later)                                                                                                                                                                                             
   - Agent completes at 07:30:58, crash at 07:41:38 (11 min later)                                                                                                                                                                                            
   - Agent completes at 08:52:32, crash at 08:56:51 (4 min later)                                                                                                                                                                                             
   - Agent starts at 09:21:57, crash at 09:22:24 (27 sec later - during run)                                                                                                                                                                                  
                                                                                                                                                                                                                                                              
   ## Environment                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                              
   - Version: Clawdbot 2026.1.24-3                                                                                                                                                                                                                            
   - Node: v25.4.0                                                                                                                                                                                                                                            
   - OS: macOS (Darwin 25.2.0 arm64)                                                                                                                                                                                                                          
   - Model: Claude Sonnet 4.5                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                              
   ## Impact                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                              
   - Gateway process terminates completely                                                                                                                                                                                                                    
   - All active sessions lost                                                                                                                                                                                                                                 
   - Requires manual restart                                                                                                                                                                                                                                  
   - Happens multiple times per session when under load                                                                                                                                                                                                       
                                                                                                                                                                                                                                                              
   ## Expected Behavior                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                              
   Network fetch failures should be caught and handled gracefully, not crash the entire gateway process.                                                                                                                                                      
                                                                                                                                                                                                                                                              
   ## Suggested Fix                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                              
   Add try/catch or .catch() handlers around all fetch calls, especially in background tasks like:                                                                                                                                                            
   - Health checks to AI providers                                                                                                                                                                                                                            
   - Telemetry reporting                                                                                                                                                                                                                                      
   - Update checks                                                                                                                                                                                                                                            
   - Heartbeat operations                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                              
   ## Reproduction                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                              
   Occurs during normal agent operation, especially when:                                                                                                                                                                                                     
   - Multiple sequential agent runs                                                                                                                                                                                                                           
   - Long-running commands via exec tool                                                                                                                                                                                                                      
   - Network under moderate load                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                              
   The exact trigger is unclear, but the unhandled promise suggests a background task lacking error handling.                  

## Comments

### @Glucksberg (2026-01-30)

ðŸ”— **Related:** Same unhandled `fetch failed` rejection pattern as #4501 and #4622. PR #4540 adds a global `unhandledRejection` handler in gateway startup to log and gracefully handle these instead of crashing.


## Links

- None detected yet
