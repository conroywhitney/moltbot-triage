---
number: 5789
title: "[Bug]: Invalid agents.defaults.model config causes high CPU instead of clean exit"
author: lucletoffe
created: 2026-02-01T00:02:14Z
updated: 2026-02-02T00:17:43Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5789
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When a satellite agent config file (e.g., `~/.openclaw/openclaw-*.json`) contains an invalid schema for `agents.defaults.model`, the gateway logs the error but does not exit cleanly. Instead, it continues running with extremely high CPU usage (100%+ per process).

## Steps to Reproduce

1. Create a satellite agent config with an invalid `model` format:
```json
{
  "agents": {
    "defaults": {
      "workspace": "/home/user/agent-workspace",
      "model": "anthropic/claude-sonnet-4-5"
    }
  },
  "channels": { "telegram": { "enabled": true, "botToken": "..." } },
  "gateway": { "port": 18790 }
}
```

2. Start the gateway: `systemctl --user start openclaw-gateway`
3. Observe the gateway process consuming 100%+ CPU continuously

## Expected Behavior

- Gateway should log a clear error and exit with non-zero status
- Error message should show the expected format:
  ```
  agents.defaults.model: expected { primary: "provider/model" }, received string
  ```

## Actual Behavior

- Gateway logs the error: `agents.defaults.model: Invalid input: expected object, received string`
- But the process does NOT exit - it continues running
- CPU usage spikes to 100-130% per spawned process
- Multiple gateway processes may spawn, compounding the issue
- System becomes sluggish/unresponsive

## Environment

- OpenClaw version: 2026.1.29
- Node: 25.1.0 / 25.2.1
- OS: Linux (Arch)

## Suggested Fix

1. Wrap satellite agent config loading in try/catch with clean `process.exit(1)` on validation failure
2. Improve Zod error message to show expected object schema for `model` field (e.g., `{ primary: "..." }`)

## Workaround

Correct the config format:
```json
"model": { "primary": "anthropic/claude-sonnet-4-5" }
```

## Comments


## Links

- None detected yet
