---
number: 6962
title: "[Bug]: Cron job agentId not resolved correctly - runs logged to undefined.jsonl"
author: doanbactam
created: 2026-02-02T07:24:16Z
updated: 2026-02-02T07:24:16Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6962
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

### Describe the bug

When running cron jobs with `sessionTarget: "isolated"`, the scheduler fails to resolve `agentId` correctly, causing:
1. Run logs written to `~/.openclaw/cron/runs/undefined.jsonl` instead of `{agentId}.jsonl`
2. Agent receives prompt in wrong session context (e.g., `luc-tuyet-ky` heartbeat runs in `main` session as a different agent identity)

### Environment

- **OpenClaw version:** [run `openclaw --version`]
- **OS:** Windows 11 (native, not WSL)
- **Node:** 22.x

### Steps to reproduce

1. Configure cron job with:
   ```json
   {
     "jobId": "heartbeat-luc-tuyet-ky",
     "sessionTarget": "isolated",
     "agentId": "luc-tuyet-ky",
     ...
   }
   ```
2. Ensure agent folder exists: `~/.openclaw/agents/luc-tuyet-ky/`
3. Wait for cron trigger
4. Check `~/.openclaw/cron/runs/` - logs appear in `undefined.jsonl`

### Expected behavior

Run logs should be written to `luc-tuyet-ky.jsonl` and agent should run in isolated session with correct identity.

### Actual behavior

- `agentId` resolves to `undefined`
- Agent runs in `main` session with wrong identity context
- Heartbeat tagged for Agent A gets routed to Agent B's session

### Additional context

Job config is correct. Suspect the issue is in `gateway/src/scheduler/` when resolving agentId for isolated sessions.

## Comments


## Links

- None detected yet
