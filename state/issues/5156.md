---
number: 5156
title: "[Bug]: skills-remote bin probe throws unhandled AbortError every heartbeat when node security denies system.run"
author: Samar-Bons
created: 2026-01-31T04:09:14Z
updated: 2026-02-02T00:20:09Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5156
duplicate_of: null
related_issues: [5152]
blocks: []
blocked_by: []
---

## Description

## Description

The gateway throws an unhandled `AbortError` promise rejection before every heartbeat when a paired node is connected but `system.run`/`system.which` commands are denied by the default security policy.

## Error Log

```
2026-01-30T22:01:08.495Z [clawdbot] Unhandled promise rejection: AbortError: This operation was aborted
    at node:internal/deps/undici/undici:15422:13
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-01-30T22:01:27.583Z [skills-remote] remote bin probe timed out (Samarjit's Mac mini (...) @ 127.0.0.1); check node connectivity
```

## Pattern

- AbortError occurs **~4 seconds before each heartbeat**
- Followed by "bin probe timed out" **~19 seconds later**
- Happens every heartbeat cycle (~15-20 min)
- Node IS connected and paired (verified via `nodes status`)

## Root Cause

1. Gateway probes node for available binaries via `system.run` before heartbeat
2. Default security policy denies `system.run` on nodes
3. Probe fetch times out after 19 seconds
4. Timeout throws AbortError that is not caught

## Impact

- **Log noise**: Unhandled rejection logged every heartbeat
- **Cron jobs missed**: If gateway restarts during probe timeout at exact cron time, scheduled jobs miss their window (this happened to us at 2:00 AM)

## Environment

- OS: macOS 26.0 (arm64)
- Node: v24.4.1  
- OpenClaw: 2026.1.24-3
- Setup: Gateway + macOS companion app on same machine (127.0.0.1)

## Workaround

Add to config:
```json
"gateway": {
  "nodes": {
    "allowCommands": ["system.which"]
  }
}
```

## Expected Behavior

1. Bin probe timeout should be caught and handled gracefully (not throw unhandled rejection)
2. If `system.run`/`system.which` is denied by policy, probe should skip or fail fast (not wait 19 sec)
3. Gateway should not restart on probe timeout

## Related

- #5152 (similar unhandled fetch failure pattern)

## Comments


## Links

- None detected yet
