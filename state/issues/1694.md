---
number: 1694
title: "WhatsApp: Image attachment dropped when caption contains only @mention in group"
author: ajmantha
created: 2026-01-25T04:25:52Z
updated: 2026-01-28T06:03:37Z
labels: ["bug", "question"]
assignees: []
comments_count: 2
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/1694
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When sending an image in a WhatsApp group with a caption that contains **only** an @mention (e.g., just `@Chotu`), the image attachment is dropped and only the mention text is received by the bot.

## Steps to Reproduce

1. In a WhatsApp group where Clawdbot is present
2. Send an image with caption containing only an @mention (e.g., `@BotName`)
3. Observe that the bot receives only the mention text, not the image

## Expected Behavior

The bot should receive both:
- The image attachment (as `mediaType`/`mediaPath` or `<media:image>` placeholder)
- The mention text

## Actual Behavior

- `mediaType: null`
- `mediaPath: null`
- Only the mention text is received in the body

## Log Evidence

Inbound message log shows:
```json
{
  "body": "@112069286342866",
  "mediaType": null,
  "mediaPath": null
}
```

When the same image is sent with additional text (e.g., `@BotName here's the floor plan`), the text comes through but the image is still missing.

## Environment

- Clawdbot version: 2026.1.22
- Channel: WhatsApp (Baileys)
- Context: Group chat with mention-gating enabled

## Workaround

None found yet. Sending images in DMs may work (untested).

## Notes

This may be an upstream Baileys issue with how `imageMessage` with `caption` containing mentions is processed, but worth investigating the Clawdbot media extraction pipeline as well.

## Comments

### @steipete (2026-01-25)

Thanks for the report. We can’t reproduce this yet. To debug, please share a sanitized `messages.upsert` payload from the gateway for a failing message (image + caption that is only an @mention) and, if possible, one for a working image+caption. Also confirm:
- Is the image view-once or edited?
- Does the same image arrive when caption is empty or plain text (no mention)?
You can grab this by enabling verbose logs and dumping the raw `msg.message` JSON for the inbound event.


### @ajmantha (2026-01-25)

## Update: Bug is intermittent

Just tested again with the exact same scenario (image + @mention-only caption in group) and **this time it worked**!

### ✅ Working payload (just received):
```json
{
  "from": "120363406500032323@g.us",
  "to": "+918977908952",
  "body": "@112069286342866",
  "mediaPath": "/home/ajaym/.clawdbot/media/inbound/f57980cc-b9b3-4c60-968a-6f83283f7b18.jpg",
  "mediaType": "image/jpeg",
  "timestamp": 1769318422000
}
```

### ❌ Broken payload (from earlier today):
```json
{
  "from": "120363406500032323@g.us",
  "to": "+918977908952",
  "body": "@112069286342866",
  "mediaPath": null,
  "mediaType": null,
  "timestamp": 1769312439000
}
```

### Notes:
- Same group, same user, same message format
- Bug appears to be **intermittent/timing-related**
- Both messages had identical body content (just the @mention)
- No view-once or editing involved

The inconsistency suggests this might be a race condition in Baileys' message processing or WhatsApp Web's media delivery pipeline.


## Links

- None detected yet
