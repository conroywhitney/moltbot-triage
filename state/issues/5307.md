---
number: 5307
title: "Voice Call TTS defaults to Edge instead of configured OpenAI + WhatsApp messagePrefix not applied"
author: jmclawton-coder
created: 2026-01-31T09:39:18Z
updated: 2026-02-02T00:19:40Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5307
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# OpenClaw Bug Report

**Version:** 2026.1.29  
**Platform:** macOS (Apple Silicon)  
**Date:** 2026-01-31

---

## Bug 1: Voice Call TTS defaults to Edge instead of configured OpenAI

### Description
Inbound voice calls fail to play the greeting because the TTS system defaults to "edge" (Microsoft Edge TTS) instead of the configured OpenAI provider. Edge TTS is not supported for telephony, causing the call to connect silently.

### Config (relevant parts)
```json
{
  "messages": {
    "tts": {
      "provider": "openai",
      "openai": {
        "apiKey": "sk-proj-...",
        "voice": "onyx"
      }
    }
  },
  "plugins": {
    "entries": {
      "voice-call": {
        "config": {
          "tts": {
            "provider": "openai",
            "openai": {
              "apiKey": "sk-proj-...",
              "voice": "onyx"
            }
          },
          "inboundGreeting": "Hello James, this is Watson. How can I help you?"
        }
      }
    }
  }
}
```

### Error Logs
```
[MediaStream] TTS playback error: Error: TTS conversion failed: edge: unsupported for telephony
    at Object.synthesizeForTelephony (telephony-tts.ts:39:15)
[voice-call] Telephony TTS failed, falling back to Twilio <Say>: TTS conversion failed: edge: unsupported for telephony
[voice-call] Failed to speak initial message: Missing webhook URL for this call (provider state not initialized)
```

### Expected Behavior
TTS should use the configured OpenAI provider for telephony audio synthesis.

### Actual Behavior
TTS defaults to "edge" provider despite explicit OpenAI configuration, then fails because Edge is unsupported for telephony. The Twilio `<Say>` fallback also fails due to missing webhook URL.

### Root Cause (suspected)
In `dist/tts/tts.js`, the `getTtsProvider()` function falls back to "edge" when it can't resolve an API key:
```javascript
if (resolveTtsApiKey(config, "openai")) return "openai";
// ...
return "edge";
```

The config structure passed to `textToSpeechTelephony` may not be correctly mapping `messages.tts.openai.apiKey` to where `resolveTtsApiKey` expects it.

---

## Bug 2: WhatsApp messagePrefix config not applied

### Description
The `channels.whatsapp.messagePrefix` setting is not being applied to outbound messages. Messages show `[openclaw]` instead of the configured `[Watson]`.

### Config
```json
{
  "channels": {
    "whatsapp": {
      "messagePrefix": "[Watson] "
    }
  },
  "messages": {
    "messagePrefix": "[Watson]"
  }
}
```

### Expected Behavior
Outbound WhatsApp messages should be prefixed with `[Watson]`.

### Actual Behavior
Messages are prefixed with `[openclaw]` (the hardcoded default).

### Notes
- Config is definitely loaded correctly (verified via `gateway config.get`)
- Full gateway restart doesn't fix it
- Setting both `channels.whatsapp.messagePrefix` AND `messages.messagePrefix` doesn't fix it
- The default `[openclaw]` fallback in `resolveMessagePrefix()` is being used despite config being set

---

## Steps to Reproduce

### Bug 1 (Voice TTS)
1. Configure voice-call plugin with Twilio provider
2. Set `messages.tts.provider: "openai"` with valid API key
3. Set `plugins.entries.voice-call.config.tts.provider: "openai"` with valid API key
4. Enable inbound calls with greeting
5. Call the Twilio number
6. Observe: Call connects but no audio plays, logs show Edge TTS error

### Bug 2 (Message Prefix)
1. Set `channels.whatsapp.messagePrefix: "[Watson]"`
2. Restart gateway
3. Send a message via WhatsApp
4. Observe: Message shows `[openclaw]` prefix instead of `[Watson]`

---

## Environment
- Node.js: v25.5.0
- OpenClaw: 2026.1.29
- macOS: Darwin 25.2.0 (arm64)
- WhatsApp: Personal account via web linking
- Twilio: Programmable Voice with ngrok tunnel

## Comments


## Links

- None detected yet
