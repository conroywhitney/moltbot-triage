---
number: 2438
title: "WhatsApp reply-to-sender shows raw LID instead of phone number/name"
author: dweddepohl
created: 2026-01-26T23:18:59Z
updated: 2026-01-28T06:01:48Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2438
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## WhatsApp reply-to-sender shows raw LID instead of phone number/name

### Description
When a message quotes/replies to another message in a WhatsApp group, the `replyToSender` field shows the raw WhatsApp Linked ID (e.g. `16123324027071@lid`) instead of resolving it to a phone number or contact name.

This causes confusion for the agent who may misinterpret who sent the quoted message.

### Steps to reproduce
1. In a WhatsApp group chat, have someone quote/reply to a message
2. The inbound message envelope shows:
   ```
   [Replying to 16123324027071@lid id:3A204F1DC6C9EAEC97DD]
   Message content here
   [/Replying]
   ```
3. Expected: phone number (+31612345678) or contact name
4. Actual: raw LID format

### Root cause
In `dist/web/inbound/extract.js`, the `describeReplyContext()` function uses the synchronous `jidToE164()`:

```javascript
const senderE164 = senderJid ? (jidToE164(senderJid) ?? senderJid) : undefined;
const sender = senderE164 ?? "unknown sender";
```

For `@lid` JIDs, `jidToE164()` cannot resolve to a phone number because it doesn't have access to the LID lookup from the Baileys signal repository. It falls back to returning the raw JID.

### Suggested fix
1. Make `describeReplyContext()` async
2. Pass the `lidLookup` (from `sock.signalRepository?.lidMapping`) to the extract function
3. Use `resolveJidToE164()` instead of `jidToE164()` for the reply sender resolution

The async `resolveJidToE164()` in `utils.js` already supports LID lookup via `opts.lidLookup.getPNForLID()`.

### Environment
- Clawdbot version: (latest npm)
- WhatsApp Web integration via Baileys

## Comments


## Links

- None detected yet
