---
number: 2003
title: "Slack ack reaction not removed when block streaming is enabled"
author: lanceretter
created: 2026-01-25T23:55:33Z
updated: 2026-01-28T15:39:04Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 1
url: https://github.com/moltbot/moltbot/issues/2003
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

When `removeAckAfterReply: true` is configured, the ack reaction (e.g., ðŸ‘€) is added when a message is received but never removed after the reply is delivered â€” **if block streaming is enabled**.

## Root Cause

In `dist/slack/monitor/message-handler/dispatch.js`, the code checks:

```js
if (!queuedFinal) {
    // ... early return, never calls removeAckReactionAfterReply
    return;
}
```

When block streaming is used, replies are counted in `counts.block` (not `counts.final`), so `queuedFinal` is always `false` even though a reply was delivered.

## Fix

Change the condition to check if ANY reply was delivered:

```js
const anyReplyDelivered = queuedFinal || (counts.block ?? 0) > 0 || (counts.final ?? 0) > 0;
if (!anyReplyDelivered) {
    // ... early return
    return;
}
```

## Config to reproduce

```json
{
  "messages": {
    "ackReaction": "eyes",
    "ackReactionScope": "all",
    "removeAckAfterReply": true
  }
}
```

With block streaming enabled (default), the eyes reaction is added but never removed.

## Version

Tested on Clawdbot 2026.1.24-3

## Comments

### @joncursi (2026-01-28)

I have the same issue in Discord, but even when block streaming is disabled. Moltbot thinks this feature is broken in general ðŸ¤” 


## Links

- None detected yet
