---
number: 7052
title: "Feature Request: Auto-summarize/compress context before hitting token limit to prevent brain freeze"
author: pstabell
created: 2026-02-02T10:20:52Z
updated: 2026-02-02T10:20:52Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7052
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When a long session fills up the context window, the agent hits a hard wall — it can't process anything, including saving its own state. The only recovery is a session reset (`/new` or `/reset`), which:

1. **Nukes all in-flight work** — any tool chains mid-execution are lost
2. **Orphans tool results** — tool_result blocks leak across the session boundary, causing LLM rejection errors like:
   ```
   LLM request rejected: unexpected tool_use_id found in tool_result blocks
   ```
3. **Loses all conversational context** — the agent starts fresh with no memory of what was being discussed (memory files help, but only if the agent had a chance to write them before freezing)

## The Catch-22

The agent can't checkpoint its own state when it's already frozen. By the time the context limit is hit, it's too late to save anything. The solution needs to happen *before* the limit is reached.

## Proposed Solution

Implement automatic context management before hitting the token limit:

### Option A: Auto-Summarization
- Monitor token usage as the conversation grows
- At a configurable threshold (e.g., 80% of context window), automatically summarize older parts of the conversation
- Replace verbose history with a compressed summary, freeing up space
- The agent continues seamlessly without losing context

### Option B: Rolling Context Window
- Keep the most recent N messages in full detail
- Automatically compress/summarize older messages
- Maintain a "session state" file that gets updated periodically so recovery after a reset is smoother

### Option C: Pre-Freeze Checkpoint
- When approaching the limit, trigger an automatic checkpoint that saves:
  - Current working context / task state
  - Key decisions and progress
  - Any in-flight tool operations
- On reset, the new session can load this checkpoint automatically

### Bug Fix: Orphaned Tool Results
Separately, the session reset should clean up any pending tool_use/tool_result pairs so they don't leak across boundaries and cause LLM rejection errors.

## Environment

- Clawdbot with Claude models (Opus, Sonnet)
- Long sessions with heavy tool use (browser automation, file editing, multi-step workflows) hit this most often
- Memory files partially mitigate but don't solve the core problem

## Impact

This is one of the biggest UX pain points for power users running long complex sessions. The agent becomes increasingly capable throughout a session as it builds context, then loses everything at the worst possible moment.

## Comments


## Links

- None detected yet
