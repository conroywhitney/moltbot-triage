---
number: 7627
title: "Bug: soul-evil hook config keys rejected by schema validation"
author: joaosnet
created: 2026-02-03T02:12:14Z
updated: 2026-02-03T02:12:14Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7627
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# Issue: Erro na configuraÃ§Ã£o do hook soul-evil - chaves nÃ£o reconhecidas

## DescriÃ§Ã£o
Ao tentar configurar o hook soul-evil com opÃ§Ãµes avanÃ§adas, o sistema rejeita as chaves `file`, `chance` e `purge` com uma mensagem de erro de validaÃ§Ã£o de esquema.

## Passos para reproduzir
1. Adicionar as seguintes configuraÃ§Ãµes ao hook soul-evil no arquivo de configuraÃ§Ã£o:
```json
soul-evil: {
  enabled: true,
  file: SOUL_EVIL.md,
  chance: 0.5,
  purge: { at: 21:00, duration: 15m }
}
```

2. Reiniciar o gateway OpenClaw

## Resultado esperado
O hook soul-evil deveria aceitar as configuraÃ§Ãµes e alternar entre SOUL.md e SOUL_EVIL.md conforme as regras definidas.

## Resultado atual
O sistema retorna o seguinte erro de validaÃ§Ã£o:
```
Invalid config at C:\Users\joaod\.openclaw\openclaw.json:
- hooks.internal.entries.soul-evil: Unrecognized keys: file, chance, purge
```

## AnÃ¡lise
Analisando o cÃ³digo fonte do hook soul-evil (`C:\Users\joaod\AppData\Roaming\npm\node_modules\openclaw\dist\hooks\bundled\soul-evil\handler.js` e `C:\Users\joaod\AppData\Roaming\npm\node_modules\openclaw\dist\hooks\soul-evil.js`), Ã© possÃ­vel confirmar que:

1. O handler aceita essas opÃ§Ãµes (`file`, `chance`, `purge`) e as processa corretamente
2. As funÃ§Ãµes `resolveSoulEvilConfigFromHook` e `decideSoulEvil` estÃ£o implementadas e prontas para usar essas configuraÃ§Ãµes
3. O problema estÃ¡ no esquema de validaÃ§Ã£o de configuraÃ§Ã£o que nÃ£o reconhece essas chaves como vÃ¡lidas para o hook

## SoluÃ§Ã£o proposta
Adicionar as chaves `file`, `chance` e `purge` ao esquema de validaÃ§Ã£o do hook soul-evil para que possam ser utilizadas conforme documentado.

## Workaround
Atualmente, o hook soul-evil pode ser usado com funcionalidade limitada (apenas habilitado/desabilitado), mas sem as opÃ§Ãµes avanÃ§adas de controle de probabilidade e horÃ¡rio de ativaÃ§Ã£o.

## Comments


## Links

- None detected yet
