---
number: 3465
title: "[Feature]: x402 payment protocol extension"
author: zauthofficial
created: 2026-01-28T16:56:20Z
updated: 2026-01-28T17:46:38Z
labels: ["enhancement", "r: third-party-extension"]
assignees: []
comments_count: 4
reactions_total: 5
url: https://github.com/moltbot/moltbot/issues/3465
duplicate_of: null
related_issues: [3016]
blocks: []
blocked_by: []
---

## Description

## Summary

We would like to contribute an extension that enables moltbot agents to make payments via the [x402 protocol](https://www.x402.org/) using USDC on Base (EVM) and Solana (SVM).

**Note:** We previously submitted [PR #3016](https://github.com/moltbot/moltbot/pull/3016) which was closed due to size. We're opening this issue first to align on the approach before resubmitting.

## Proposed Solution

### Two tools, one plugin.

**1. `x402_payment`** - Execute paid API calls with automatic USDC payment
- Detects x402-enabled endpoints (402 response with payment requirements)
- Supports both EVM (Base, Base Sepolia) and SVM (Solana, devnet, testnet)
- Configurable max payment limit per request
- Automatic network detection from endpoint response
- Returns payment receipt with amount paid

**2. `x402_discover`** - Search a directory of x402-enabled APIs
- Query by keyword, network, or verification status
- Returns endpoint URL, method, pricing, description, and success rate
- Helps agents find services they can pay for autonomously
- Directory powered by [zauth](https://zauthx402.com)

### Configuration

```json
{
  "plugins": {
    "entries": {
      "x402": {
        "enabled": true,
        "config": {
          "evmPrivateKey": "0x...",
          "svmPrivateKey": "base58...",
          "maxPaymentUSDC": "0.50",
          "defaultNetwork": "base"
        }
      }
    }
  }
}
```

### Dependencies

- `@x402/fetch` - Official x402 payment wrapper
- `@x402/evm` - EVM payment scheme (Base)
- `@x402/svm` - SVM payment scheme (Solana)
- `viem` - EVM wallet/signing (already common in web3 projects)
- `@solana/kit` - Solana wallet/signing
- `bs58` - Base58 encoding for Solana keys

### Implementation Details

Self-contained in `extensions/x402/` (no changes to moltbot core)
~800 lines of implementation code (not including packages)
Includes test suite
Handles both v1 and v2 x402 protocol versions
Graceful error handling for insufficient funds, network issues, etc.

## Alternatives Considered

**1. External payment service**
- Could use a separate x402 service to handle payments, like an MCP server
- Rejected: adds deployment complexity, latency, and a point of failure. Host of the server would store user's SVM and EVM hot wallets, privacy concern. 

**2. EVM-only (no Solana)**
- Simpler implementation with fewer dependencies
- Rejected (willing to reconsider for V1): Solana x402 endpoints exist and limiting to EVM reduces utility

## Additional Context

### What is x402?

[x402](https://www.x402.org/) is an open protocol for machine-to-machine payments using HTTP status code 402 (Payment Required). When an agent hits a paid endpoint:

1. Server returns 402 with payment requirements (amount, address, network)
2. Client signs and submits payment
3. Client retries request with payment proof
4. Server validates and returns the resource

### Why This Matters

This enables agents to autonomously:
Pay for premium API access (weather, finance, AI services)
Purchase compute resources on-demand
Access paywalled content
Execute multi-step tasks that require payments

Without human intervention for each transaction.

### Links

x402 Protocol: https://www.x402.org/
Coinbase x402 SDK: https://github.com/coinbase/x402
zauth Directory: https://zauthx402.com
Closed PR: https://github.com/moltbot/moltbot/pull/3016

### Open Questions

Are you open to x402/payment extensions in general?
Any concerns with the proposed dependencies?
Would you prefer this split into smaller PRs (e.g., core payment tool first, then discovery tool) ? 

Happy to discuss and iterate on the approach so we can get x402 implemented with moltbot!

## Comments

### @bencbernstein (2026-01-28)

++++++

### @thewilloftheshadow (2026-01-28)

Ignore the close here, just getting the autoresponse:

### @moltbot-barnacle (2026-01-28)

This would be better made as a third-party extension with our SDK that you maintain yourself. Docs: https://docs.molt.bot/plugin.

### @JimboSlice3231 (2026-01-28)

Great idea 


## Links

- None detected yet
