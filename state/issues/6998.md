---
number: 6998
title: "[Bug]: Gateway Authentication Has No Rate Limiting"
author: coygeek
created: 2026-02-02T08:43:35Z
updated: 2026-02-02T08:43:35Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6998
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## CVSS Assessment

| Metric | Value |
|--------|-------|
| **Score** | 9.1 / 10.0 |
| **Severity** | Critical |
| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N |

> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)


## Summary

The gateway authentication endpoint has no rate limiting, lockout, or delay mechanisms. An attacker can repeatedly attempt authentication with no throttling, enabling credential brute force attacks.

## Affected Code

**File:** `src/gateway/auth.ts:238-291`

```typescript
export async function authorizeGatewayConnect(params: {
  auth: ResolvedGatewayAuth;
  connectAuth?: ConnectAuth | null;
  // ...
}): Promise<GatewayAuthResult> {
  // No rate limiting - directly checks credentials
  if (auth.mode === "token") {
    if (!connectAuth?.token) {
      return { ok: false, reason: "token_missing" };
    }
    if (!safeEqual(connectAuth.token, auth.token)) {
      return { ok: false, reason: "token_mismatch" };
    }
    return { ok: true, method: "token" };
  }
  // Password auth also has no rate limiting
```

## Attack Surface

**How is this reached?**
- [x] Network (HTTP/WebSocket endpoint, API call)
- [ ] Adjacent Network (same LAN, requires network proximity)
- [ ] Local (local file, CLI argument, environment variable)
- [ ] Physical (requires physical access to machine)

**Authentication required?**
- [x] None (unauthenticated/public access)
- [ ] Low (any authenticated user)
- [ ] High (admin/privileged user only)

**Entry point:** Gateway WebSocket connection authentication

## Exploit Conditions

**Complexity:**
- [x] Low (no special conditions, works reliably)
- [ ] High (requires race condition, specific config, or timing)

**User interaction:**
- [x] None (automatic, no victim action needed)
- [ ] Required (victim must click, visit, or perform action)

**Prerequisites:** Network access to gateway

## Impact Assessment

**Scope:**
- [x] Unchanged (impact limited to vulnerable component)
- [ ] Changed (can affect other components, escape sandbox)

**What can an attacker do?**

| Impact Type | Level | Description |
|-------------|-------|-------------|
| Confidentiality | High | Successful brute force grants full gateway access |
| Integrity | High | Attacker can execute any gateway command |
| Availability | None | No direct availability impact (DoS handled elsewhere) |

## Steps to Reproduce

1. Identify gateway WebSocket endpoint
2. Create script to attempt authentication with password list
3. No delays, no lockouts, no CAPTCHA
4. Continue until correct password found
5. Gain full gateway access

## Recommended Fix

Implement rate limiting with exponential backoff:

```typescript
const authAttempts = new Map<string, { count: number; lastAttempt: number }>();

function checkRateLimit(clientId: string): { allowed: boolean; retryAfter?: number } {
  const now = Date.now();
  const attempt = authAttempts.get(clientId);

  if (attempt) {
    const backoff = Math.min(30000, 1000 * Math.pow(2, attempt.count - 1));
    if (now - attempt.lastAttempt < backoff) {
      return { allowed: false, retryAfter: backoff - (now - attempt.lastAttempt) };
    }
  }
  return { allowed: true };
}
```

## References

- **CWE:** [CWE-307](https://cwe.mitre.org/data/definitions/307.html) - Improper Restriction of Excessive Authentication Attempts

## Comments


## Links

- None detected yet
