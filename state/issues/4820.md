---
number: 4820
title: "voice-call plugin: Streaming returns 404, non-streaming ignores Gather callbacks"
author: base698
created: 2026-01-30T18:20:29Z
updated: 2026-02-02T03:59:32Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4820
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# voice-call plugin: Streaming returns 404, non-streaming ignores Gather callbacks

## Summary

The voice-call plugin has two related bugs that prevent bidirectional phone conversations:

1. **Streaming mode (`streaming.enabled: true`)**: The webhook returns `<Connect><Stream url="wss://.../voice/stream"/>` TwiML, but the WebSocket endpoint is never created â€” requests to `/voice/stream` return 404.

2. **Non-streaming mode (`streaming.enabled: false`)**: The webhook ignores `SpeechResult` from Twilio's `<Gather>` callbacks and returns `<Pause length="30"/>` instead of processing the speech and responding.

## Environment

- **OpenClaw version**: 2026.1.29
- **OS**: macOS (arm64)
- **Provider**: Twilio
- **Exposure**: Tailscale Funnel

## Reproduction Steps

### Streaming Mode (default)

1. Configure voice-call plugin with `streaming.enabled: true` (or omit, as it seems to be default)
2. Initiate a call via `voice_call` tool or CLI
3. Answer the call
4. Observe: call connects but no audio because WebSocket fails

```bash
# Test the stream endpoint
curl -I "https://your-funnel-url/voice/stream"
# Returns: HTTP 404
```

### Non-Streaming Mode

1. Set `streaming.enabled: false` in config
2. Restart gateway
3. Initiate a call
4. Answer and speak after the greeting
5. Observe: no response, call eventually times out

```bash
# Simulate what Twilio sends after Gather
curl -X POST "http://127.0.0.1:3335/voice/webhook" \
  -d "CallSid=CAxxxx" \
  -d "SpeechResult=Hello this is a test" \
  -d "Confidence=0.9" \
  -d "CallStatus=in-progress"

# Returns: <Response><Pause length="30"/></Response>
# Expected: <Response><Say>...</Say><Gather>...</Gather></Response>
```

## Expected Behavior

### Streaming Mode
The `/voice/stream` WebSocket endpoint should be created and handle bidirectional audio via Twilio Media Streams.

### Non-Streaming Mode  
When `SpeechResult` is received from a `<Gather>` callback, the plugin should:
1. Process the transcribed speech
2. Send it to the agent for a response
3. Return TwiML with `<Say>` containing the response and another `<Gather>` to continue the conversation

## Workaround

I created a standalone Node.js webhook that handles the Gather flow correctly. It:
1. Returns `<Gather input="speech">` TwiML on initial call
2. Receives `SpeechResult` from Twilio  
3. Returns `<Say>` with a response

This works perfectly, confirming the issue is in the plugin, not Twilio or the network setup.

## Config Used

```json
{
  "plugins": {
    "entries": {
      "voice-call": {
        "enabled": true,
        "config": {
          "provider": "twilio",
          "twilio": {
            "accountSid": "ACxxxx",
            "authToken": "xxxx"
          },
          "fromNumber": "+1xxx",
          "publicUrl": "https://xxx.ts.net/voice/webhook",
          "serve": {
            "port": 3335,
            "bind": "127.0.0.1",
            "path": "/voice/webhook"
          },
          "streaming": {
            "enabled": false,
            "streamPath": "/voice/stream"
          },
          "outbound": {
            "defaultMode": "conversation"
          },
          "tts": {
            "provider": "openai",
            "openai": { "voice": "alloy" }
          }
        }
      }
    }
  }
}
```

## Additional Context

- Outbound `notify` mode works (plays TTS greeting and hangs up)
- `<Record>` captures audio correctly
- The issue is specifically with bidirectional conversation flow
- Tested on 2026-01-30 with extensive debugging

## Comments

### @mazamizo21 (2026-02-02)

Please check this out : [openclaw-voicecall-twilio-no-audio-fix.md](https://github.com/user-attachments/files/24999621/openclaw-voicecall-twilio-no-audio-fix.md)


## Links

- None detected yet
