---
number: 7227
title: "[Security] Accessibility permissions requested for 'node' exposes all npm packages to GUI automation"
author: scottrich
created: 2026-02-02T15:43:46Z
updated: 2026-02-02T15:43:46Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7227
duplicate_of: null
related_issues: [940,1754,3067,7139]
blocks: []
blocked_by: []
---

## Description

## Summary

OpenClaw's Peekaboo skill (and potentially other macOS GUI automation features) triggers macOS to request **Accessibility permissions for the `node` executable itself**, not for a specific OpenClaw app bundle. This is a significant security risk.

## The Problem

When a user grants Accessibility permissions to `node`:
- ✅ OpenClaw's Peekaboo skill gains GUI automation capabilities
- ❌ **Every npm package on the system** also gains GUI automation capabilities

This includes:
- All globally installed npm packages
- All npm packages in any project on the machine
- Malicious packages installed as dependencies
- Supply chain compromised packages

**Accessibility permissions grant the ability to:**
- Control other applications
- Read screen content
- Simulate keyboard/mouse input
- Bypass security dialogs

Granting this to `node` means any npm package can do these things.

## Why This Is Worse Than Other Permissions

Unlike file system access (which can be sandboxed) or network access (which can be monitored), **Accessibility permissions cannot be scoped per-package**. It's all-or-nothing for the entire `node` executable.

## Current User Experience

1. User installs OpenClaw via npm
2. Peekaboo skill is enabled by default (bundled skill)
3. User asks OpenClaw to take a screenshot or automate something
4. macOS shows: **"node" was prevented from modifying apps on your Mac**
5. User is prompted to grant Accessibility to `node` in System Settings
6. **No warning is given about the security implications**

Most users will grant this permission thinking it's only for OpenClaw.

## Real-World Attack Scenario

1. Developer has OpenClaw installed with `node` granted Accessibility
2. Developer installs a compromised npm package in any project
3. That package's postinstall script can now:
   - Read their password manager
   - Exfiltrate clipboard contents
   - Automate clicks in their banking app
   - Bypass 2FA prompts by reading SMS notifications
   - Control Slack/Discord to send messages as them

## Existing Related Issues

- #3067 (closed): Proposed .app wrapper solution, but closed in mass triage
- #940 (closed): Reported Peekaboo permission issues, treated as bug not security issue
- #1754 (closed): Computer tool proposal
- #7139 (open): Broader isolation concerns, but doesn't mention node permission issue

## Proposed Solutions

### Immediate (Required)

1. **Disable Peekaboo by default** - Make GUI automation skills opt-in
2. **Add prominent security warning** when enabling Peekaboo:
   

### Short-term (High Priority)

3. **Reopen and prioritize #3067** - Create signed wrapper app bundle
   - Users grant permissions to `OpenClaw.app`, not `node`
   - Wrapper is code-signed with stable identity
   - Only OpenClaw gains permissions, not all npm packages

### Long-term (Best Solution)

4. **Process isolation** - Run GUI automation in separate sandboxed process
   - Similar to browser architecture (renderer processes)
   - GUI automation runs with permissions, main gateway doesn't
   - Limits blast radius if OpenClaw itself is compromised

## Current Workaround

Users concerned about security can disable Peekaboo:

```json
{
  "skills": {
    "entries": {
      "peekaboo": { "enabled": false }
    }
  }
}
```

But this requires users to:
1. Know about the security risk
2. Know how to configure skills
3. Manually edit config

**Most users will not do this.**

## Impact Assessment

- **Severity**: High
- **Likelihood**: Medium (requires user to grant permission, but prompt is not clearly explained)
- **Affected users**: All macOS users running OpenClaw via npm/node
- **Not affected**: Users who never enable Peekaboo, users running from signed .app bundle (if it exists)

## Recommendations

1. **Document this risk prominently** in installation guides
2. **Make Peekaboo opt-in** instead of default-enabled
3. **Add security warning** when enabling skills that require system permissions
4. **Prioritize .app wrapper solution** from #3067
5. Consider whether bundling Peekaboo by default is appropriate given security tradeoffs

## Environment

- macOS 26.3.0 (Sequoia)
- OpenClaw 2026.1.30
- Node.js v25.5.0
- Peekaboo installed via homebrew

---

This is not a theoretical risk - granting Accessibility to `node` is a real security issue that expands the attack surface to the entire npm ecosystem. Users should be clearly warned before being prompted to grant these permissions.

## Comments


## Links

- None detected yet
