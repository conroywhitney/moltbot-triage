---
number: 6727
title: "[Bug]: Control UI freezes when 'Show Thinking' (brain icon) is enabled with large sessions"
author: ndbroadbent
created: 2026-02-02T00:37:34Z
updated: 2026-02-02T02:57:21Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6727
duplicate_of: null
related_issues: [6190,6554,6647,6650]
blocks: []
blocked_by: []
---

## Description

## Summary

The Control UI (webchat dashboard) regularly freezes when the "Show Thinking" toggle (brain icon) is enabled, especially with sessions containing many assistant messages with reasoning/thinking content.

## Environment
- OpenClaw version: 2026.1.30
- Browser: Safari/Chrome on macOS
- Gateway mode: local

## Steps to Reproduce

1. Open Control UI at http://127.0.0.1:18789/
2. Have a session with multiple assistant responses that include thinking/reasoning content
3. Enable the "Show Thinking" toggle (brain icon in the chat header)
4. UI freezes or becomes extremely slow/unresponsive

## Root Cause Analysis

After investigating the source code, the issue is in `ui/src/ui/chat/message-extract.ts` and `ui/src/ui/chat/grouped-render.ts`:

1. When `showReasoning` is enabled, `extractThinkingCached()` is called for every assistant message
2. The extracted thinking content is **not truncated** - entire blocks (can be 10KB+ each) are rendered
3. With many messages, this results in massive DOM renders causing browser freeze
4. Unlike tool cards which have truncation (`TOOL_INLINE_THRESHOLD`, `PREVIEW_MAX_CHARS`), thinking content has no limits

## Proposed Fix

Add truncation for thinking/reasoning content similar to tool card truncation:

```typescript
// In constants.ts
export const THINKING_MAX_CHARS = 500;
export const MESSAGE_TEXT_MAX_CHARS = 50000;

// In message-extract.ts
function truncateWithEllipsis(text: string, maxChars: number): string {
  if (text.length <= maxChars) return text;
  return text.slice(0, maxChars) + "â€¦ [truncated]";
}

// Apply truncation in extractThinking()
if (parts.length > 0) {
  const joined = parts.join("\n");
  return truncateWithEllipsis(joined, THINKING_MAX_CHARS);
}
```

A future enhancement could add an "expand" button to show full content in a sidebar (similar to tool results), but basic truncation would immediately fix the freeze issue.

## Related Issues

- #6650 / #6647 - Tool Result Session Bloat (related but focuses on storage, not rendering)
- #6554 - Audio attachments causing dashboard freeze (similar symptom, different cause)
- #6190 - Session log growing and bot hanging (server-side, not UI rendering)

## Questions

1. Would a PR implementing the truncation fix be welcome?
2. Should the truncation threshold be configurable via settings?
3. Should truncated thinking content have an "expand" option (sidebar view like tool results)?

Happy to submit a PR if this approach is acceptable, or adjust based on feedback.

## Comments


## Links

- None detected yet
