---
number: 6924
title: "Cron job nextRunAtMs incorrectly recalculated after gateway restart"
author: adminwcmf
created: 2026-02-02T06:16:00Z
updated: 2026-02-02T06:16:00Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6924
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When the gateway is restarted (e.g., after a config change via `config.patch`), cron jobs with `schedule.kind: "every"` have their `nextRunAtMs` recalculated based on the current time rather than the last run time.

## Steps to Reproduce

1. Create a cron job with `schedule: { kind: "every", everyMs: 12600000 }` (3.5 hours)
2. Let it run successfully at time T
3. Restart the gateway (e.g., via `config.patch`)
4. Check `cron list` - the `nextRunAtMs` is now based on restart time, not T + everyMs

## Expected Behavior

After gateway restart, `nextRunAtMs` should remain `lastRunAtMs + everyMs` to maintain the original schedule.

## Actual Behavior

`nextRunAtMs` is recalculated as `restartTime + everyMs`, causing the job to run later than expected.

## Example

- Job last ran at: 04:42 UTC
- Expected next run: 08:12 UTC (04:42 + 3.5h)
- Gateway restarted at: 06:08 UTC
- Actual next run after restart: 09:38 UTC (06:08 + 3.5h)

This could cause issues for time-sensitive tasks (e.g., refreshing sessions that expire after 4 hours).

## Environment

- OpenClaw version: 2026.1.30
- OS: Linux (Ubuntu on AWS EC2)

## Comments


## Links

- None detected yet
