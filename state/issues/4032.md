---
number: 4032
title: "[Bug]: Message ordering conflict when switching between Anthropic and AIHubMix providers"
author: liuwenyong1985
created: 2026-01-29T15:16:13Z
updated: 2026-01-29T15:16:13Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/4032
duplicate_of: null
related_issues: [998,999]
blocks: []
blocked_by: []
---

## Description

### Describe the bug

When switching models between `anthropic/claude-opus-4-5` (direct) and `aihubmix/claude-opus-4-5-20251101`, a "Message ordering conflict" error is triggered consistently. This appears related to #998 but with a different trigger condition.

### Steps to reproduce

1. Start with `anthropic/claude-opus-4-5` model
2. Use `/model aihub` to switch to AIHubMix provider
3. Send any message
4. Error appears: "Message ordering conflict - please try again. If this persists, use /new to start a fresh session."
5. Using `/new` does not resolve the issue

### Expected behavior

- Model switching should work seamlessly between providers
- Session should not be corrupted when switching providers

### Actual behavior

- Switching from Anthropic direct to AIHubMix triggers message ordering conflict
- Error persists even after `/new` command

### Environment

- **Clawdbot version:** 2026.1.24-3
- **Channel:** Telegram
- **Models:**
  - `anthropic/claude-opus-4-5` (direct, alias: opus)
  - `aihubmix/claude-opus-4-5-20251101` (OpenAI-compatible API, alias: aihub)
- **AIHubMix config:** Uses `openai-completions` API mode

### Additional context

This may be related to #998 (fixed in PR #999), but the trigger is different - it's provider switching rather than a specific model's response format. The fix in #999 may not cover this case where two providers have subtly different response formats.

## Comments


## Links

- None detected yet
