---
number: 6979
title: "Add model delineation to Discord responses"
author: dreamingbinary
created: 2026-02-02T07:49:34Z
updated: 2026-02-02T07:49:34Z
labels: []
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/6979
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

Currently, Discord responses from moltbot show no indication of which Claude model was used (Sonnet, Haiku, or Opus). This makes it difficult to:
- Know which model handled your request
- Debug model-specific issues
- Understand performance/quality tradeoffs
- Track model usage patterns

## Proposed Solution

Add model delineation to Discord responses, e.g.:
```
**[Claude 3.5 Sonnet]**
Your response here...
```

Or with Discord embeds:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Claude 3.5 Sonnet â”‚
â”‚ Your response...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Research & Design Document

Comprehensive research completed: `specs/spec-discord-model-delineation.md`

### Key Findings

**Architecture Constraint**: Model info determined AFTER agent execution, but Discord messages sent DURING streaming via callbacks.

**Solutions**:
1. **Phase 1 (4-6 hours)**: Session context injection + text prefix - most practical starting point
2. **Phase 2 (4-8 hours)**: Discord embeds with rich formatting - most visually appealing
3. **Quick option (2-3 hours)**: Text prefix only - simplest but less polished

### Implementation Approaches

| Approach | Effort | Feasibility | Quality |
|----------|--------|-------------|---------|
| Text prefix | 2h | Very High | Low |
| Session context injection | 4-6h | High | Medium |
| Discord embeds | 4-8h | Medium | High |
| Post-send indicator | 3-4h | Medium | Low |

### Recommended Path

1. **Phase 1**: Inject model through execution callbacks, add text prefix format
2. **Phase 2**: Build Discord embed formatter for rich display
3. **Phase 3**: Config system for format customization per-channel

### Key Files Involved

- **Agent execution**: `src/agents/pi-embedded-runner/run.ts` (model determined here)
- **Callback types**: `src/agents/pi-embedded-runner/run/params.ts`
- **Message dispatch**: `src/agents/pi-embedded-subscribe.ts`
- **Discord send**: `src/discord/send.outbound.ts` (where formatting happens)
- **Outbound adapter**: `src/channels/plugins/outbound/discord.ts`

## Design Review Questions

### Core Design
1. Should model always be shown or configurable per-channel/account?
2. Format preference: text prefix, Discord embed, footer, or reaction?
3. Detail level: just "Sonnet" or full "Claude 3.5 Sonnet"?

### Implementation
4. Start with Phase 1 (text + context) or jump to Phase 2 (embeds)?
5. How to handle repeated model indicator in chunked responses?
6. Should other channels (WhatsApp, Signal, Telegram) also show model?

### Testing
7. Which models to test with? Real API or mock responses?
8. Beta test with small user group first?

## Next Steps

1. Review spec document: `specs/spec-discord-model-delineation.md`
2. Team alignment on design approach and format preference
3. Answer design review questions
4. Plan implementation sprint (Phase 1 or 1+2)

## Related Documentation

- Full spec: `specs/spec-discord-model-delineation.md`
- Discord send code: `src/discord/send.outbound.ts`
- Agent execution: `src/agents/pi-embedded-runner/run.ts`
- Discord API embeds: https://discord.com/developers/docs/resources/message#embed-object

## Comments


## Links

- None detected yet
