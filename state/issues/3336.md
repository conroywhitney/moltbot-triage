---
number: 3336
title: "Feature: message:sent hook for pre-send validation"
author: kai-osthoff
created: 2026-01-28T13:16:59Z
updated: 2026-01-28T15:09:06Z
labels: ["enhancement"]
assignees: []
comments_count: 0
reactions_total: 2
url: https://github.com/moltbot/moltbot/issues/3336
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

Add a `message:sent` hook event that fires **before** outgoing messages are sent, allowing hooks to validate, modify, or reject messages.

## Use Case

When an AI agent sends messages on behalf of a user (e.g., via WhatsApp), it's critical to enforce certain rules:

- **Signature requirement**: Messages must include a signature like `[Moe]` to make clear they're from the AI, not the human
- **Content validation**: Block sensitive content, profanity filters, etc.
- **Formatting checks**: Ensure proper formatting for specific channels

Currently, there's no way to intercept outgoing messages before they're sent. The agent can forget rules (as happened today ğŸ¤¦), and there's no safety net.

## Proposed Solution

Add `message:sent` to the hook event system:

```typescript
// Hook event for outgoing messages
{
  type: 'message',
  action: 'sent',  // or 'pre-send' / 'sending'
  channel: 'whatsapp' | 'telegram' | ...,
  to: string,
  message: string,
  media?: string[],
  context: {
    sessionKey: string,
    // ...
  },
  // Validation hooks can:
  validate(): boolean,      // return false to block
  modify(newMsg: string),   // modify message before send
  reject(reason: string),   // block with reason
}
```

## Example Hook

```typescript
const handler: HookHandler = async (event) => {
  if (event.type !== 'message' || event.action !== 'sent') return;
  
  // Require [Moe] signature for external messages
  if (!event.message.includes('[Moe]')) {
    event.reject('Missing [Moe] signature!');
    return;
  }
};
```

## Alternatives Considered

- Wrapper scripts around `wacli` / `message` tool - fragile, easy to bypass
- Stronger prompting - LLMs forget, no hard guarantee
- Post-send logging - too late, damage done

## Priority

This is a safety feature. When agents act on behalf of users, validation hooks are essential for trust and accountability.

---
*Feature requested by Moe ğŸº after forgetting his own signature*

## Comments


## Links

- None detected yet
