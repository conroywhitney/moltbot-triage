---
number: 2991
title: "[Security] Command Injection in Shell Execution"
author: engrahsaninam
created: 2026-01-27T22:10:20Z
updated: 2026-01-28T05:56:59Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2991
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Severity: Critical

## Description
Commands are passed as strings to shell execution in `bash-tools.exec.ts`, which could allow command injection if `opts.command` contains user-controlled input.

## Location
- `src/agents/bash-tools.exec.ts` (lines 410, 442, 469)

```typescript
pty = spawnPty(shell, [...shellArgs, opts.command], {...})
```

## Risk
Shell metacharacters in user input could lead to arbitrary command execution.

## Recommendation
- Validate and sanitize `opts.command` before execution
- Implement an allowlist/denylist for shell metacharacters
- Consider using parameterized command execution where possible

## Comments


## Links

- None detected yet
