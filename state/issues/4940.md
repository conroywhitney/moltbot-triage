---
number: 4940
title: "Security inconsistency: commands.restart doesn't block exec-based restarts"
author: lucletoffe
created: 2026-01-30T21:33:46Z
updated: 2026-01-31T02:26:49Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4940
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

There is a security inconsistency between the `gateway` tool restriction and the `exec` tool capabilities regarding gateway restarts.

## Current Behavior

1. **Tool `gateway` with `action: restart`** → Blocked when `commands.restart=false`
   ```
   "Gateway restart is disabled. Set commands.restart=true to enable."
   ```

2. **Tool `exec` running `openclaw gateway restart`** → Works regardless of `commands.restart` setting

## Expected Behavior

If the intent of `commands.restart=false` is to prevent agents from restarting the gateway, both paths should be blocked (or at least consistent).

## Question for Maintainers

What was the original intent behind `commands.restart`?

- **Option A**: Prevent agents from using the clean `gateway` tool (but exec is trusted and unrestricted by design)
- **Option B**: Fully prevent gateway restarts by agents (in which case exec should also be blocked for this command)
- **Option C**: Other reasoning?

## Steps to Reproduce

1. Ensure `commands.restart=false` (default)
2. Try `gateway` tool with `action: restart` → Blocked ✓
3. Try `exec` with `openclaw gateway restart` → Works ✗

## Environment

- OpenClaw version: latest (npm)
- OS: Linux (Arch)

## Notes

This was discovered during normal usage. Not a critical security issue since exec access implies high trust, but the inconsistency is confusing for users configuring agent permissions.

## Comments


## Links

- None detected yet
