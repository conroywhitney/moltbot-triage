---
number: 2743
title: "Double SIGUSR1 on config.apply causes race condition / orphaned sessions"
author: vibemarketing99
created: 2026-01-27T12:18:17Z
updated: 2026-01-28T05:59:10Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2743
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

When `config.apply` is called, the gateway restarts via SIGUSR1. However, a second SIGUSR1 is immediately triggered (within 1-2 seconds) because `meta.lastTouchedAt` gets updated during the restart, and the file watcher detects this as a config change.

## Evidence from logs

```
12:05:42 → SIGUSR1, restarting
12:05:43 → ANOTHER SIGUSR1 just 1 second later

12:12:10 → SIGUSR1, restarting  
12:12:12 → ANOTHER SIGUSR1 2 seconds later
```

Error during double-restart:
```
[clawdbot] Uncaught exception: Error: Max reconnect attempts (0) reached after code 1006
    at GatewayPlugin.handleReconnectionAttempt
```

Also seeing:
```
[reload] config change requires gateway restart (meta.lastTouchedAt)
[gateway] shutdown timed out; exiting without full cleanup
```

## Impact

- Agent sessions become orphaned
- Agent stops responding (no crash, just unresponsive)
- Discord WebSocket connections fail during the race
- User has to manually restart gateway

## Expected Behavior

- `meta.lastTouchedAt` changes should NOT trigger a restart (it's metadata, not config)
- Or: file watcher should be disabled during restart grace period
- Or: debounce SIGUSR1 signals

## Environment

- Clawdbot version: 2026.1.23-1
- Node: v25.4.0
- OS: macOS (Darwin 24.6.0 arm64)
- Config: 5 Discord bot accounts, Telegram, WhatsApp

## Workaround

Batch config changes and avoid frequent `config.apply` calls.

## Comments


## Links

- None detected yet
