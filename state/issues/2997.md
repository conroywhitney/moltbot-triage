---
number: 2997
title: "[Security] Hook Tokens Accepted in Query Parameters"
author: engrahsaninam
created: 2026-01-27T22:10:52Z
updated: 2026-01-28T05:56:13Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2997
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Severity: Medium

## Description
Hook tokens can still be passed via query parameters (deprecated but still supported), which exposes tokens in logs, browser history, and referrer headers.

## Location
- `src/gateway/server-http.ts` (lines 79-92)

```typescript
if (fromQuery) {
  logHooks.warn("Hook token provided via query parameter is deprecated...");
}
```

## Risk
Tokens in URLs appear in:
- Server access logs
- Browser history
- Referrer headers sent to external sites
- Proxy logs

## Recommendation
- Remove query parameter support entirely
- Require tokens only via Authorization header or X-Moltbot-Token header
- Add migration documentation for users still using query parameters

## Comments


## Links

- None detected yet
