---
number: 6101
title: "当 Agent 执行 exec 命令时，回复不会发送到 WhatsApp"
author: bzhz2023
created: 2026-02-01T08:37:00Z
updated: 2026-02-01T21:04:33Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6101
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

**环境：**
- OpenClaw 版本：`2026.1.30`
- Gateway：`ws://127.0.0.1:18789`
- Channel：WhatsApp（正常工作，能接收和发送消息）
- Agent：main session（正常）

**问题：**

当 Agent 执行 `exec` 命令时，Agent 生成的回复不会发送到 WhatsApp。但纯文字回复正常发送。

**重现步骤：**

1. 用户给 Agent 发一条消息（如"帮我检查状态"）
2. Agent 执行 `exec` 命令（如 `openclaw status`）
3. Agent 生成回复（如"当前状态：..."）
4. **预期**：回复应该发送到 WhatsApp  
   **实际**：WhatsApp 上没有收到回复（但 Dashboard/UI 能看到回复）

**影响：**

- 用户无法及时知道命令执行状态
- 需要打开 Dashboard 才能看到回复
- 影响使用体验

**日志片段：**

```
2026-02-01T08:13:17.546Z [whatsapp] Inbound message +8615267039090 -> +8618967126950 (direct, 57 chars)
2026-02-01T08:15:08.364Z [whatsapp] Inbound message +8615267039090 -> +8618967126950 (direct, 83 chars)
2026-02-01T08:18:29.469Z [whatsapp] Inbound message +8615267039090 -> +8618967126950 (direct, 97 chars)
```

（只看到 inbound 消息，没有看到 outbound 消息）

**临时规避方案：**

在使用 WhatsApp 通道时，避免在单条回复中同时执行命令和生成回复。改为：
1. 先发送一条"正在执行命令..."的纯文字回复
2. 执行命令
3. 执行完后，再发送一条确认消息

**期望修复：**

无论 Agent 是否执行命令，所有回复都应该正确发送到 WhatsApp。命令执行和消息发送应该在独立的线程/进程中隔离，避免相互阻塞。

## Comments


## Links

- None detected yet
