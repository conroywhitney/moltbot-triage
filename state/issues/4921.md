---
number: 4921
title: "[Bug]: LLM provider failover doesn't trigger on ECONNREFUSED errors because the error code is missing from the failover classifier."
author: GeorgeBronner
created: 2026-01-30T21:19:24Z
updated: 2026-01-30T21:24:03Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4921
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary
LLM provider failover does not trigger when primary provider is unreachable due to ECONNREFUSED or other connection failure errors. Users receive connection errors instead of  
  automatic failover to backup providers.    

## Steps to reproduce
  1. Configure a primary LLM provider (e.g., Ollama at 192.168.1.100:11434) and a fallback provider                                                                                 
  2. Power off or stop the primary provider so it refuses connections                                                                                                             
  3. Send a message to the bot 

## Expected behavior
The bot should automatically fail over to the configured backup provider and respond to the user normally.

## Actual behavior
The bot returns a "connection error" message to the user. Logs show run_completed status and only attempts to the primary provider. The fallback is never attempted. 

## Environment
  - Clawdbot version: latest (commit da71eaebd)                                                                                                                                   
  - OS: Any                                                                                                                                                                       
  - Install method (pnpm/npx/docker/etc): Any

## Proposed fix:
1. add ECONNREFUSED, ENOTFOUND, ENETUNREACH, EHOSTUNREACH   to src/agents/failover-error.ts (line 124-127)
2. or extract shared error codes into a common module rather than duplicating them.

## Comments


## Links

- None detected yet
