---
number: 4435
title: "Telegram onboarding: require authentication key on first message to prevent unauthorized access"
author: henritik-pr
created: 2026-01-30T06:43:35Z
updated: 2026-01-30T06:43:35Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4435
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When setting up a new Clawdbot instance with Telegram, the default onboarding wizard configures the bot with:
- `dmPolicy: "open"`
- `allowFrom: ["*"]`

This means **any Telegram user** who finds or guesses the bot username can send messages and interact with the agent — which has full access to the workspace (files, exec, memory, etc.).

### Real-world impact

We discovered this on a production instance: a second user was able to message the bot and access the entire workspace content, including sensitive data. The bot responded normally as if it were a legitimate user.

## Proposed Solution

**Require an authentication key on first contact via Telegram.**

When a new (unknown) user messages the bot for the first time:
1. The bot should prompt for a secret key / passphrase
2. The key is defined during setup or in the config (`channels.telegram.enrollmentKey` or similar)
3. If the key matches → the user's Telegram ID is automatically added to `allowFrom`
4. If the key doesn't match → the message is rejected, no agent interaction

This would:
- Prevent unauthorized access by default (secure-by-default)
- Remove the need to manually find and configure Telegram user IDs
- Allow easy onboarding: just share the bot username + a secret key with the intended user

## Current Workaround

Manually set `dmPolicy: "allowlist"` and `allowFrom: ["<telegram_user_id>"]` after onboarding. This requires:
1. Temporarily opening the bot (`allowFrom: ["*"]`)
2. Having the user send a message to discover their Telegram ID
3. Adding the ID and re-locking

This is error-prone and leaves a window of vulnerability.

## Additional Suggestions

- The onboarding wizard should **warn** when `allowFrom: ["*"]` is set
- Consider defaulting `dmPolicy` to `allowlist` instead of `open` for new setups
- Add a `clawdbot doctor` check that flags open Telegram bots

## Environment

- Clawdbot version: 2026.1.25
- Channel: Telegram
- Setup: Docker multi-instance

## Comments


## Links

- None detected yet
