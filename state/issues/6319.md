---
number: 6319
title: "Windows: clawdbot health --json --timeout can hang / not exit (timeout ignored)"
author: Toul1982
created: 2026-02-01T14:45:45Z
updated: 2026-02-01T21:04:14Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6319
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# Clawdbot: `clawdbot health --json --timeout` kan hänga utan output på Windows

## Sammanfattning
Ibland ger `clawdbot health --json --timeout <ms>` ingen output alls och verkar inte respektera timeout-flaggan (processen fortsätter tills man manuellt avbryter).

## Miljö
- OS: Windows_NT 10.0.22631 (x64)
- Node: v22.19.0
- Clawdbot gateway lokalt (127.0.0.1:18789)
- Kanal: WhatsApp linked

## Repro (observerat)
1) Kör:
   - `clawdbot health --json --timeout 5000`
   - eller `clawdbot health --json --timeout 10000`
2) I vissa körningar händer ett av två:
   - (A) Ingen stdout/stderr kommer alls, och processen fortsätter > timeout-värdet.
   - (B) **Full JSON skrivs ut** (ser "ok" ut), men **processen exit:ar aldrig** och fortsätter > timeout-värdet.
   - Kräver Ctrl+C / kill.

### Exempel-output (case B)
I loggar från wrapper-scriptet (`memory/repro-logs/`) skrivs full JSON ut med t.ex. `"durationMs": 6` men processen slutar ändå aldrig.
Exempel: `memory/repro-logs/health-20260201-130016-run1.stdout.txt`.

Mer deterministisk repro-wrapper (som enforce:ar timeout genom att döda processen):
- `scripts/repro-health-loop-timeout.ps1` (sparar stdout/stderr i `memory/repro-logs/`).

## Förväntat
Kommandot ska alltid:
- returnera en JSON payload snabbt och **exit:a**, eller
- avbryta och exit:a med felkod när timeout uppnås.

## Noteringar
- Andra gånger fungerar `clawdbot health --json` direkt, vilket tyder på intermittent blockering (t.ex. channel probe, IPC, deadlock, eller DNS/network).
- `clawdbot status --json` kan också ta länge, men där finns en tydlig anledning (security audit) och den brukar till slut returnera.

## Workaround
- När `health` hänger: använd `clawdbot gateway status` + egen TCP LISTEN-check som snabb liveness-signal.
- Kör `clawdbot status --json --timeout 30000` vid behov, men förvänta 20–30s latency.

## Comments


## Links

- None detected yet
