---
number: 4041
title: "Feature Request: File upload support in WebChat"
author: edh72
created: 2026-01-29T15:35:29Z
updated: 2026-01-29T19:16:51Z
labels: []
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4041
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Feature Request

**Summary:** Add file/document upload support to the WebChat interface (Control UI chat tab).

**Current behavior:** WebChat shows `capabilities=none` and has no UI for attaching files. Users cannot drag-and-drop or upload documents to send to the agent.

**Desired behavior:** Allow users to drag files into the chat input or click an attachment button to upload files (images, documents, etc.) that get passed to the agent, similar to how WhatsApp/Telegram/Discord channels handle attachments.

**Workarounds:** 
- Send files via WhatsApp or other configured channels
- Drop files in the workspace folder and reference by path

**Use case:** Quick file sharing when working from the browser-based Control UI, especially for users who primarily interact via WebChat.

## Comments

### @vasujain00 (2026-01-29)

# Technical Approach: File Upload Support (Proposed)

## 1. Backend Strategy: Relaxing Validation
The primary blocker is the strict validation in `src/gateway/chat-attachments.ts` that currently rejects any non-image MIME types.

**Proposed Implementation:**
- **Relax Constraints**: We will modify `parseMessageWithAttachments` to process *all* file types.
- **Logic Branching**:
    - **Images**: Will continue to be validated as images (sniffing for png/jpeg headers).
    - **Files**: Will be accepted as generic attachments. We will attempt to detect the MIME type but fallback to preserving the original data if detection fails.
- **Type Generalization**: We will rename `ChatImageContent` to `ChatContentBlock`. This new type will include a `type` discriminator (`"image" | "file"`) and an optional `fileName` field to support documents without breaking existing image handling.

## 2. Frontend Strategy: Expanded Input & Metadata
The UI needs to support both the *action* of uploading files and the *display* of non-visual attachments.

**Proposed Implementation:**
- **Input Methods**:
    - Add a standard HTML `<input type="file">` (hidden) triggered by a new "Paperclip" button.
    - Update `handlePaste` and drag-and-drop listeners to stop filtering out non-image files.
- **Data Flow**: The frontend will capture the `fileName` from the File object and pass it through the `ChatAttachment` type to the `ChatController`.
- **Visualization**: We will update the attachment preview component. If the attachment is a file, we will render a file icon and the filename instead of trying to render a broken image preview.

## 3. API Compatibility
To avoid a massive refactor of the upstream `@mariozechner/pi-ai` types (which we don't control), we plan to:
- Maintain the existing `images` field in the API payload from the frontend.
- Cast strict types in `server-methods/chat.ts` to allow our generalized `ChatContentBlock` to pass through where `ImageContent` was expected. This allows the backend to process the file data without requiring changes to the core agent definition library immediately.



## Links

- None detected yet
