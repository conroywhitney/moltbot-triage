---
number: 3741
title: "Bug: Telegram channel fails to start - auto-enable writes to plugins.entries instead of channels"
author: JulienMartel
created: 2026-01-29T03:45:37Z
updated: 2026-01-29T07:03:56Z
labels: []
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3741
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

The Telegram channel fails to start because the gateway's auto-enable logic incorrectly attempts to persist channel state to `plugins.entries.telegram`, which fails config validation since `telegram` is a built-in channel, not a plugin.

## Environment

- **Moltbot version**: 2026.1.8-2 (also reproduced on 2026.1.29-dev / commit 699784db)
- **Installation method**: Nix (nix-moltbot home-manager module)
- **OS**: macOS 15.3 (darwin 24.6.0)
- **Node**: 22.22.0

## Steps to Reproduce

1. Configure telegram channel in `moltbot.json`:

```json
{
  "channels": {
    "telegram": {
      "enabled": true,
      "tokenFile": "/path/to/telegram-bot-token",
      "allowFrom": [123456789]
    }
  }
}
```

2. Start the gateway (in Nix mode or standard mode)
3. Run `moltbot status`

## Expected Behavior

- Telegram channel should start and appear in the Channels table
- Bot should begin polling for messages

## Actual Behavior

- Gateway logs warning: `gateway: failed to persist plugin auto-enable changes: Error: Config validation failed: plugins.entries.telegram: plugin not found: telegram`
- `moltbot status` shows "Telegram configured, not enabled yet."
- Channels table is empty
- No grammY/polling logs appear
- `moltbot doctor --fix` fails with the same validation error

## Logs

```
2026-01-29T03:40:47.114Z [gateway] failed to persist plugin auto-enable changes: Error: Config validation failed: plugins.entries.telegram: plugin not found: telegram
```

Full gateway startup shows no telegram/grammY initialization after this error.

## Root Cause Analysis

The gateway's auto-enable logic appears to:
1. Detect that telegram is configured with a token
2. Attempt to "persist" the enabled state by writing to `plugins.entries.telegram`
3. Fail config validation because `telegram` is a channel, not a plugin
4. Skip starting the telegram channel entirely

The bug affects all configuration methods:
- `channels.telegram` with `enabled: true`
- `channels.telegram` with `tokenFile` or `botToken`
- `TELEGRAM_BOT_TOKEN` environment variable
- Both Nix mode and standard mode

## Workarounds Attempted (None Worked)

- Setting `enabled: true` explicitly ‚ùå
- Using `botToken` instead of `tokenFile` ‚ùå
- Using `TELEGRAM_BOT_TOKEN` env var without config ‚ùå
- Removing `enabled` flag entirely ‚ùå
- Running `moltbot doctor --fix` ‚ùå
- Updating to latest commit (699784db) ‚ùå

## Suggested Fix

The auto-enable persistence logic should write channel state to the appropriate location (likely `channels.telegram.enabled` or a separate runtime state file), not to `plugins.entries`.

## Additional Context

This completely blocks Telegram channel usage. The channel config is correct and visible in `moltbot config get channels.telegram`, but the channel never actually starts.

## Comments

### @Glucksberg (2026-01-29)

üîó **Related:** PR #3764 addresses the auto-enable config persistence issue - it ensures channel auto-enabled state is written to `channels` config instead of `plugins.entries`, which should fix this bug.


## Links

- None detected yet
