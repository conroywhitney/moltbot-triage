---
number: 2354
title: "[Bug]: Local gateway launchd job not stopped when switching to remote mode"
author: kennyklee
created: 2026-01-26T19:46:17Z
updated: 2026-01-30T21:13:58Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2354
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description
When switching connection mode from "Local" to "Remote over SSH", the local gateway launchd job (`com.clawdbot.gateway`) is not properly stopped/unloaded. It continues trying to start, fails because the SSH tunnel has already bound to port 18789, and enters a crash-loop.

## Steps to reproduce
1. Open Clawdbot macOS app
2. Set connection mode to "Local (this Mac)" - local gateway starts
3. Switch connection mode to "Remote over SSH"
4. Configure SSH target and start the connection

## Expected behavior
- Local gateway launchd job should be stopped/unloaded when switching to remote mode
- Only the SSH tunnel should be running
- No crash-loop in system logs

## Actual behavior
- SSH tunnel starts and binds to port 18789 âœ“
- Local gateway launchd job keeps trying to start
- Gateway fails with `exit(1)` because port 18789 is already in use
- launchd throttles and retries every 9 seconds, creating a crash-loop

## Evidence from logs

```
launchd: [gui/501/com.clawdbot.gateway [8792]:] exited due to exit(1), ran for 1527ms
launchd: [gui/501/com.clawdbot.gateway:] Service only ran for 1 seconds. Pushing respawn out by 9 seconds.
```

```
# From ~/.clawdbot/ssh-tunnel.err.log
bind [127.0.0.1]:18789: Address already in use
channel_setup_fwd_listener_tcpip: cannot listen to port: 18789
Could not request local forwarding.
```

## Root cause
The `gatewayManager.stop()` call in `MenuBar.swift` may not be fully unloading the launchd job, or there's a race condition where the job is re-spawned before the mode switch completes.

## Environment
- macOS app
- Switching from local to remote mode

## Comments

### @josiahsrc (2026-01-30)

I had to run `openclaw configure` and walk through the gateway setup again. That seems to have fixed it for me


## Links

- None detected yet
