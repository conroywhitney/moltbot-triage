---
number: 7095
title: "Feature Request: Support multimodal content blocks (images) in gateway agent method"
author: CaseReed
created: 2026-02-02T11:33:48Z
updated: 2026-02-02T11:33:48Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7095
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

The gateway's `agent` method currently only accepts `message` as a string (`NonEmptyString`), which prevents sending images/multimodal content to the AI.

## Current Behavior

In `gateway/protocol/schema/agent.js`, the `AgentParamsSchema` validates:

```javascript
export const AgentParamsSchema = Type.Object({
    message: NonEmptyString,  // Only accepts string
    // ...
})
```

When a client sends content blocks (array format for images + text), the gateway rejects the request because `message` must be a string.

## Expected Behavior

The gateway should accept both formats:
1. **String** (text-only): `message: "Hello"`
2. **Content blocks** (multimodal): 
```json
message: [
  { "type": "image", "source": { "type": "base64", "media_type": "image/png", "data": "..." } },
  { "type": "text", "text": "Describe this image" }
]
```

## Proposed Solution

Update `AgentParamsSchema` to accept a union type:

```javascript
const ContentBlockSchema = Type.Union([
  Type.Object({
    type: Type.Literal("text"),
    text: NonEmptyString
  }),
  Type.Object({
    type: Type.Literal("image"),
    source: Type.Object({
      type: Type.Literal("base64"),
      media_type: Type.Union([
        Type.Literal("image/png"),
        Type.Literal("image/jpeg"),
        Type.Literal("image/webp"),
        Type.Literal("image/gif")
      ]),
      data: NonEmptyString
    })
  })
])

export const AgentParamsSchema = Type.Object({
    message: Type.Union([NonEmptyString, Type.Array(ContentBlockSchema)]),
    // ... rest unchanged
})
```

## Use Case

Building a web viewer/client that allows users to send images to Claude for analysis. The viewer correctly formats content blocks, but the gateway rejects them.

## Environment

- OpenClaw version: 2026.1.29
- Platform: macOS (darwin)

## Comments


## Links

- None detected yet
