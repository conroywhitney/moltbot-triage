---
number: 2153
title: "[Bug]: Feature Request: Support for HTTP/SOCKS5 Proxy for WhatsApp (Baileys) Connection"
author: shujun1992
created: 2026-01-26T09:23:59Z
updated: 2026-02-01T15:12:50Z
labels: ["bug"]
assignees: []
comments_count: 4
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2153
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

Hello,

I am running Clawdbot in a network environment that requires a proxy to connect to WhatsApp's servers.

When trying to connect, the QR code generation fails with the following timeout error:

<text> Waiting for WhatsApp connection... WhatsApp Web connection ended before fully opening. status=408 Request Time-out WebSocket Error (Opening handshake has timed out) WhatsApp login failed: Error: status=408 Request Time-out WebSocket Error (Opening handshake has timed out) I have tried setting the standard HTTP_PROXY and HTTPS_PROXY environment variables, but they do not seem to be used by the WhatsApp (Baileys) connection.
Since the Baileys library supports proxy configuration via a custom agent in the makeWASocket config, could you please expose an option in clawdbot.json to specify a proxy URL (e.g., http://user:pass @host:port)?

This would allow users in restricted network environments to use the WhatsApp integration.

Thank you!

## Comments

### @d0uub (2026-01-28)

for web/session.js file:
```
import { HttpsProxyAgent } from "https-proxy-agent";
```
in createWaSocket function, add:
```
    const proxyUrl = process.env.HTTPS_PROXY || process.env.https_proxy || process.env.HTTP_PROXY || process.env.http_proxy;
    const agent = proxyUrl ? new HttpsProxyAgent(proxyUrl) : undefined;
```

in makeWASocket function add agent variable in it

<img width="1106" height="326" alt="Image" src="https://github.com/user-attachments/assets/5c51dbe4-e1a3-4626-a6aa-bad3ba0f3491" />

lazy for pull request, you can do it yourself for quick fix

### @d0uub (2026-01-29)

[session.js](https://github.com/user-attachments/files/24925032/session.js)

### @jsRuner (2026-01-30)

me too

### @SfcFromSx (2026-02-01)

> for web/session.js file:
> 
> ```
> import { HttpsProxyAgent } from "https-proxy-agent";
> ```
> 
> in createWaSocket function, add:
> 
> ```
>     const proxyUrl = process.env.HTTPS_PROXY || process.env.https_proxy || process.env.HTTP_PROXY || process.env.http_proxy;
>     const agent = proxyUrl ? new HttpsProxyAgent(proxyUrl) : undefined;
> ```
> 
> in makeWASocket function add agent variable in it
> 
> <img alt="Image" width="1106" height="326" src="https://private-user-images.githubusercontent.com/12244281/541389912-5c51dbe4-e1a3-4626-a6aa-bad3ba0f3491.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk5NTkwNDIsIm5iZiI6MTc2OTk1ODc0MiwicGF0aCI6Ii8xMjI0NDI4MS81NDEzODk5MTItNWM1MWRiZTQtZTFhMy00NjI2LWE2YWEtYmFkM2JhMGYzNDkxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAyMDElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMjAxVDE1MTIyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTE3YmY4MDI0ZWE3ZmJhYzllZDllYzgzM2RkNzVjMDhlMzMzOTlmOTU3NDZhMGIzYzQzZTdjMTBiMTI3MTM3NTgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.PaATehX6QKGax3lMvKibo1ftLhwvHDNRCUj54DFd85g">
> lazy for pull request, you can do it yourself for quick fix

it works


## Links

- None detected yet
