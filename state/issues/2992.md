---
number: 2992
title: "[Security] Unsafe eval() Usage in Browser Context"
author: engrahsaninam
created: 2026-01-27T22:10:25Z
updated: 2026-01-28T05:56:57Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2992
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Severity: Critical

## Description
`eval()` is used to evaluate JavaScript functions in browser context, which could lead to XSS or code injection if the input is user-controlled.

## Location
- `src/browser/pw-tools-core.interactions.ts` (lines 233, 250)

```typescript
var candidate = eval("(" + fnBody + ")");
```

## Risk
If `fnBody` is user-controlled, this can lead to arbitrary JavaScript execution.

## Recommendation
- Validate `fnBody` strictly before evaluation
- Use a safer evaluation method (e.g., `new Function()` with validation)
- Restrict to a controlled subset of JavaScript
- Consider using a sandboxed environment for evaluation

## Comments


## Links

- None detected yet
