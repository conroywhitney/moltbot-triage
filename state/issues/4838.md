---
number: 4838
title: "QR code generation fails with ENAMETOOLONG - data URI used as filename"
author: a-mamuth
created: 2026-01-30T18:46:19Z
updated: 2026-01-30T18:46:19Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4838
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

**Version:** 2026.1.29

**Description:**
When requesting QR code generation, the system attempts to save the image using the entire data URI as the filename, causing an ENAMETOOLONG error.

**Error message:**
```
[tools] message failed: ENAMETOOLONG: name too long, open 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYYAAAGGCAYAAAB/gCblAAAjUUlEQVR4nO2awQ7lyLJC5/9/+r5Fa6TnhauVNRwDLpC8SwFJRGRs/M//hmEYhuH/4R+3gWEYhiELWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBfhi...'
```

**Expected behavior:**
QR code should be saved with a proper filename (e.g., `qr-code-{timestamp}.png`) or returned directly without file system operations.

**Actual behavior:**
The full base64 data URI is being used as the filename, which exceeds filesystem limits (typically 255 bytes).

**Impact:**
- Request times out after ~10 minutes
- Causes the auth profile to enter cooldown state
- Blocks all subsequent requests until cooldown is manually cleared

**Steps to reproduce:**
1. Ask the agent to generate a QR code
2. Observe timeout and error in gateway logs

**Workaround:**
Manually clear `usageStats` in `~/.openclaw/agents/main/agent/auth-profiles.json` and restart gateway.

## Comments


## Links

- None detected yet
