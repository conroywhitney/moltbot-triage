---
number: 5130
title: "Setup silently syncs OAuth credentials from other CLI tools without user consent"
author: Kaust-a-laut
created: 2026-01-31T03:13:28Z
updated: 2026-02-02T00:20:24Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5130
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

During `openclaw` installation/setup, the onboarding process silently reads and copies OAuth credentials (access tokens and refresh tokens) from other CLI tools — specifically Qwen CLI, Claude CLI, and OpenAI Codex CLI — without prompting the user for consent.

The only indication this happened is a log line buried in the install output:

```
[agents/auth-profiles] synced qwen credentials from qwen cli
```

## What happens

1. `syncExternalCliCredentials()` in `dist/agents/auth-profiles/external-cli-sync.js` runs during setup
2. It calls `readQwenCliCredentialsCached()` (and equivalent for Claude/Codex) from `dist/agents/cli-credentials.js`
3. This reads `~/.qwen/oauth_creds.json` directly from disk, extracting `access_token`, `refresh_token`, and `expiry_date`
4. The credentials are stored verbatim into `~/.openclaw/agents/main/agent/auth-profiles.json`

No consent dialog. No confirmation prompt. No opt-in.

## Affected credential sources

- **Qwen CLI**: `~/.qwen/oauth_creds.json`
- **Claude CLI**: `~/.claude/.credentials.json` (or macOS Keychain)
- **OpenAI Codex CLI**: `~/.codex/auth.json` (or macOS Keychain)

## Why this is a problem

- **Refresh tokens are long-lived** and can generate new access tokens. Silently copying them is a meaningful trust violation.
- The security notice shown during onboarding warns about runtime prompt injection risks and says to "keep secrets out of the agent's reachable filesystem" — but does not disclose that the installer itself reaches into other tools' config directories to harvest tokens.
- Users reasonably expect that installing a new tool won't silently read credentials belonging to unrelated tools.

## Suggested fix

Make credential syncing **opt-in** with an explicit prompt during onboarding, e.g.:

```
Found existing Qwen CLI credentials. Import them into OpenClaw? [y/N]
```

Or at minimum, make it clearly opt-out with documentation in the security notice.

## Environment

- OpenClaw version: 2026.1.29
- Platform: Linux (Ubuntu)
- Installed via: npm

## Comments


## Links

- None detected yet
