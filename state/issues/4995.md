---
number: 4995
title: "Security: iMessage dmPolicy 'pairing' auto-responds to unknown contacts with pairing codes"
author: cooneycw
created: 2026-01-30T22:54:13Z
updated: 2026-01-31T02:24:52Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4995
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

The iMessage channel's `dmPolicy: "pairing"` mode automatically sends pairing codes to **any unknown contact** who messages the OpenClaw instance, creating an information disclosure vulnerability and social engineering attack vector.

## Steps to Reproduce

1. Configure OpenClaw with iMessage enabled:
```json
"channels": {
  "imessage": {
    "enabled": true,
    "dmPolicy": "pairing",
    "groupPolicy": "allowlist"
  }
}
```

2. Have an unknown/unapproved contact send an iMessage to your phone number
3. OpenClaw automatically responds with a pairing code (e.g., an 8-character alphanumeric code)
4. The stranger now knows you're running an AI assistant with pairing capability

## Security Impact

### 1. Information Disclosure
- Any stranger with your phone number learns you're running an AI assistant
- They learn it's accessible via a pairing mechanism
- Exposes you as a target for social engineering attacks

### 2. Social Engineering Vector
Attackers can:
- Impersonate tech support ("We need that code to fix your account")
- Use urgency tactics to trick users into approving codes
- Pretend to be legitimate contacts

### 3. No Rate Limiting
- Anyone can repeatedly trigger pairing code generation
- No apparent rate limiting on auto-responses
- Potential for spam/harassment

### 4. Violates Principle of Least Privilege
- Auto-responses to **completely unknown contacts** violates secure-by-default principles
- Users may not understand the security implications of approving codes

## Real-World Evidence

This issue aligns with industry security concerns raised by:
- [Cisco Security Blog](https://blogs.cisco.com/ai/personal-ai-agents-like-openclaw-are-a-security-nightmare) - "Personal AI Agents like OpenClaw Are a Security Nightmare"
- [Dark Reading](https://www.darkreading.com/application-security/openclaw-ai-runs-wild-business-environments) - "OpenClaw AI Runs Wild in Business Environments"

## Suggested Mitigations

### Option 1: Reverse the Flow (Recommended)
- Don't auto-respond to unknown contacts
- Require users to initiate pairing from the OpenClaw CLI/UI
- Generate codes only when explicitly requested: `openclaw pairing generate imessage`

### Option 2: Pre-approved Contacts Only
- Change default `dmPolicy` from `"pairing"` to `"allowlist"`
- Only send pairing codes to contacts you've pre-approved
- Require manual allowlist addition before auto-responses

### Option 3: Explicit Opt-in Warning
- During setup wizard, clearly warn users about auto-response behavior
- Show example: "Any stranger who messages you will receive a pairing code"
- Require explicit confirmation with security implications spelled out

### Option 4: Rate Limiting
- Limit pairing code generation to 1 per contact per 24 hours
- Add exponential backoff for repeated attempts
- Log suspicious activity

## Expected Behavior

Unknown contacts should **not** receive any auto-response unless:
1. User has explicitly pre-approved that contact, OR
2. User has explicitly enabled "respond to all" mode with clear security warnings

## Current Workaround

Users can protect themselves by:
1. Setting `"dmPolicy": "allowlist"` instead of `"pairing"`
2. Disabling iMessage channel entirely: `"enabled": false`
3. Pre-approving only known contacts

## Environment

- OpenClaw version: 2026.1.29
- Platform: macOS
- Channel: iMessage

---

**Severity:** Medium to High (information disclosure + social engineering vector)
**Suggested Labels:** security, enhancement, imessage, channels

## Comments


## Links

- None detected yet
