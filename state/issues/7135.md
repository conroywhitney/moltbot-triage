---
number: 7135
title: "openclaw update (global npm) runs with cwd inside install dir; mise panics when dir replaced (path-dedot unsafe_cwd)"
author: conyekwelu
created: 2026-02-02T12:48:02Z
updated: 2026-02-02T12:52:11Z
labels: []
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/7135
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

### Summary
Running `openclaw update` for a global npm install sets `cwd` to the OpenClaw install directory. During `npm i -g openclaw@latest`, that directory gets replaced, so `mise` (invoked by npm) tries to reshim while its CWD no longer exists and panics in `path-dedot` (`unsafe_cwd.rs`).

Result: the update *actually completes* (packages changed, version updated), but `openclaw update` exits with ERROR due to the panic.

### Repro
1. Install OpenClaw globally via npm (example path: `/home/<user>/.npm-global/lib/node_modules/openclaw`).
2. Run:
   ```bash
   openclaw update --yes --json
   ```

### Expected
`openclaw update` completes successfully (exit 0) when the global update succeeds.

### Actual
Update completes (`changed 696 packages ...`), then:
- `Reshimming mise ...`
- `mise WARN Current directory does not exist or is not accessible: <openclaw install dir>`
- mise panics:
  ```
  The application panicked (crashed).
  Message: called `Option::unwrap()` on a `None` value
  Location: /cargo/registry/.../path-dedot-3.1.1/src/unsafe_cwd.rs:38
  ```
OpenClaw reports Update Result: ERROR.

### Evidence (from `openclaw update --yes --json`)
```json
{
  "status": "error",
  "mode": "npm",
  "root": "/home/<user>/.npm-global/lib/node_modules/openclaw",
  "reason": "global update",
  "before": {"version": "2026.2.1"},
  "after": {"version": "2026.2.1"},
  "steps": [
    {
      "name": "global update",
      "command": "npm i -g openclaw@latest",
      "cwd": "/home/<user>/.npm-global/lib/node_modules/openclaw",
      "exitCode": 101,
      "stdoutTail": "\\nchanged 696 packages in 19s",
      "stderrTail": "...\\nReshimming mise 24.11.1...\\nmise WARN  Current directory does not exist or is not accessible: /home/<user>/.npm-global/lib/node_modules/openclaw\\n...\\nThe application panicked (crashed).\\nMessage:  called `Option::unwrap()` on a `None` value\\nLocation: /cargo/registry/.../path-dedot-3.1.1/src/unsafe_cwd.rs:38"
    }
  ]
}
```

### Environment
- OpenClaw: 2026.2.1 (global npm install)
- Node: v24.11.1
- npm: 11.6.2
- mise: 2026.1.11
- OS: Ubuntu 24.04 (Linux 6.14.0-37-generic x86_64)

### Suggested fix
When doing a global npm update, do **not** set `cwd` to the package install directory being replaced. Use a stable directory (e.g., `$HOME` or a temp dir).

(Workaround: `cd ~ && npm i -g openclaw@latest` works reliably.)

## Comments


## Links

- None detected yet
