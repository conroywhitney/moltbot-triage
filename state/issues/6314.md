---
number: 6314
title: "Session memory indexing bypasses chunker, fails on large deltas"
author: boldprojekte
created: 2026-02-01T14:38:32Z
updated: 2026-02-01T20:58:44Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6314
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

Session transcript indexing (`memorySearch.experimental.sessionMemory: true`) fails when session deltas exceed the embedding model's token limit.

## Error

```
memory sync failed (session-delta): Error: openai embeddings failed: 400 
{ "error": { "message": "This model's maximum context length is 8192 tokens, 
however you requested 8203 tokens (8203 in your prompt; 0 for the completion)..." } }
```

## Expected Behavior

Session deltas should be chunked (using `memorySearch.chunking.tokens` / `overlap`) before being sent to the embedding API, just like file content is.

## Actual Behavior

The session-delta sync path sends the entire accumulated delta as a single embedding request, bypassing the chunker. When the delta exceeds ~8K tokens, embedding fails.

## Evidence

- File indexing (MEMORY.md, memory/*.md, extraPaths) works correctly → chunker is applied
- Session indexing fails on large deltas → chunker is not applied
- Error shows 8203 tokens requested → far above the ~400 token chunk target

## Config

```json
{
  "memorySearch": {
    "sources": ["memory", "sessions"],
    "experimental": { "sessionMemory": true },
    "chunking": { "tokens": 400, "overlap": 80 }
  }
}
```

## Workaround

Disable session memory until fixed:
```json
{
  "memorySearch": {
    "sources": ["memory"],
    "experimental": { "sessionMemory": false }
  }
}
```

## Environment

- OpenClaw version: 2026.1.29
- Embedding provider: OpenAI (text-embedding-ada-002, 8192 token limit)
- OS: Linux

## Suggested Fix

Apply the same chunking logic used for file content to session transcript deltas before calling the embedding API.

## Comments


## Links

- None detected yet
