---
number: 7659
title: "Feature Request: Auto-recovery for corrupted session transcripts (orphan tool_result)"
author: rojasjuniore
created: 2026-02-03T03:00:05Z
updated: 2026-02-03T03:00:05Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7659
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When a session transcript becomes corrupted with an orphan `tool_result` block (missing corresponding `tool_use`), the session becomes permanently broken until manually cleared.

**Error message:**
```
400 {"type":"error","error":{"type":"invalid_request_error","message":"messages.24.content.1: unexpected \`tool_use_id\` found in \`tool_result\` blocks: toolu_XXXXX. Each \`tool_result\` block must have a corresponding \`tool_use\` block in the previous message."}}
```

This can happen when:
- Context truncation removes a `tool_use` but keeps its `tool_result`
- Network errors during tool execution
- Other edge cases that corrupt the message history

## Current Workaround

Manually delete the session transcript file:
```bash
rm /data/.clawdbot/agents/main/sessions/<session-id>.jsonl
```

## Proposed Solution

Add an error handler that:
1. **Detects** this specific error type when it occurs
2. **Auto-clears** the corrupted transcript
3. **Notifies** via configured channel (e.g., Slack #alerts)
4. **Retries** the original message with a fresh session

This would make OpenClaw self-healing for this class of errors.

## Alternative

At minimum, a CLI command to reset a specific session would help:
```bash
openclaw session reset <session-key>
```

## Environment

- OpenClaw version: 2026.2.1
- Running on Railway
- Multiple Slack channels as sessions

## Comments


## Links

- None detected yet
