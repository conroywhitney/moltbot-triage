---
number: 3245
title: "Session stuck in processing state after gateway restart mid-run"
author: hyyu189
created: 2026-01-28T09:15:57Z
updated: 2026-01-28T15:08:09Z
labels: ["bug", "gateway"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3245
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When the gateway restarts (SIGUSR1) while an agent run is in progress, the session can get stuck in a "processing" state. New messages queue but are never processed, leaving the user with no responses for extended periods.

## Timeline from Logs

```
08:23:20 - embedded run start: runId=12cbe357...
08:23:33 - gateway tool executed (config.patch)
08:23:33 - SIGUSR1 received, gateway restarting
08:23:34 - AbortError: This operation was aborted
08:23:36 - Gateway back up, webchat reconnected
... 47 MINUTES OF SILENCE ...
09:10:15 - Next run finally started (after page refresh)
```

## Key Observation

There is **no "embedded run end"** logged for the aborted run. The session was left thinking a run was still active.

## Steps to Reproduce

1. Start a conversation with the agent
2. Trigger a gateway restart mid-run (e.g., via `config.patch` or `clawdbot gateway restart`)
3. The in-flight API call gets aborted
4. Try sending new messages â€” they queue but never process
5. Session appears stuck until page refresh or gateway restart

## Expected Behavior

When the gateway restarts:
1. Any in-flight runs should be aborted cleanly
2. Session state should be reset to `idle`
3. Queued messages should be processed after restart

## Environment

- Clawdbot version: 2026.1.24-3
- Channel: webchat
- Provider: Anthropic

## Workaround

- `clawdbot gateway restart` via CLI fully resets everything
- Page refresh sometimes triggers session cleanup
- Sending a message via a different channel (e.g., Telegram) may work

## Suggested Fix

On gateway restart, enumerate active sessions and reset their state to idle, ensuring any orphaned runs are properly cleaned up.

## Comments


## Links

- None detected yet
