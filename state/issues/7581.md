---
number: 7581
title: "zsh completion script contains ANSI color codes causing 'bad pattern' errors"
author: nihalnihalani
created: 2026-02-03T00:36:17Z
updated: 2026-02-03T00:36:17Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7581
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When sourcing the zsh completion script via process substitution, ANSI color codes are included in the output, causing zsh to fail with "bad pattern" errors.

## Steps to Reproduce

1. Add the following line to `~/.zshrc`:
   ```bash
   source <(openclaw completion --shell zsh)
   ```
2. Open a new terminal

## Error Output

```
/dev/fd/14:3566: bad pattern: ^[[35m[plugins]^[[39m
/dev/fd/13:3566: bad pattern: ^[[35m[plugins]^[[39m
```

## Expected Behavior

The completion script should not contain ANSI escape sequences (`^[[35m` and `^[[39m` are color codes for magenta and reset). Shell completion scripts should output plain text only.

## Workaround

Strip ANSI codes before sourcing:
```bash
source <(openclaw completion --shell zsh 2>&1 | sed 's/\x1b\[[0-9;]*m//g')
```

Or if supported:
```bash
source <(openclaw completion --shell zsh --no-color)
```

## Environment

- OS: macOS (Darwin 25.2.0)
- Shell: zsh
- OpenClaw: Latest version

## Suggested Fix

The `completion` command should either:
1. Automatically disable color output when stdout is not a TTY
2. Ensure no colored output is mixed into the completion script generation

## Comments


## Links

- None detected yet
