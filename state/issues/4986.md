---
number: 4986
title: "Multiline paste in TUI sends each line as separate message (Windows + Git Bash)"
author: adamkane
created: 2026-01-30T22:37:03Z
updated: 2026-02-02T18:01:55Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4986
duplicate_of: null
related_issues: [767,2137,3005,3343,5017,12385,18094,38079]
blocks: []
blocked_by: []
---

## Description

## Description

When using `openclaw tui` on Windows with Git Bash (mintty/MINGW64), pasting multiline text causes each line to be sent as a separate individual message. This is session-breaking because:

1. Each line is interpreted as its own independent command/task
2. None of the lines have context from the others
3. The session is flooded with nonsensical messages processed individually
4. The session is effectively ruined

The damage happens instantly — lines fire as messages in rapid burst.

**Also affects voice dictation:** WisprFlow (and similar) inserts paragraph breaks between thoughts. The TUI treats each paragraph as a separate submitted message, making voice input unreliable for anything beyond single-paragraph responses.

### Minimal Failing Example

Pasting this two-line question:

```
Capital of
France is?
```

**Expected:** One message sent: `"Capital of \nFrance is?"`
**Actual:** Two separate messages sent:
1. `"Capital of"` — interpreted as a standalone (nonsensical) command
2. `"France is?"` — interpreted as a separate (nonsensical) command

Neither message has the context of the other. The intent — a single question — is destroyed.

## Expected Behavior

Pasting a multiline text block should be treated as a single message, matching the behavior of Claude Code's terminal and standard Git Bash input handling.

## Environment

- **OS:** Windows 11
- **Terminal:** Windows Terminal → Git Bash (mintty/MINGW64)
- **Command:** `openclaw tui`
- **pi-tui version:** `@mariozechner/pi-tui` v0.49.3

## Root Cause

**Git Bash for Windows does not emit bracketed paste escape sequences** (`\x1b[200~` / `\x1b[201~`), even though pi-tui correctly enables bracketed paste mode via `\x1b[?2004h`.

This was proven by hex dump analysis in [badlogic/pi-mono#767](https://github.com/badlogic/pi-mono/issues/767): Git Bash sends raw bytes with only `0d` (CR) separating lines. pi-tui's `StdinBuffer` sees CR as Enter and fires `onSubmit` for each line.

This is a Git Bash / mintty limitation on Windows, not a bug in pi-tui. The same issue affects every Node.js TUI running in Git Bash on Windows — Codex CLI, Gemini CLI, Claude Code, and OpenCode all have identical reports.

## Affected Tools (Same Bug)

| Tool | Issue | Upvotes |
|------|-------|---------|
| pi-tui | [pi-mono#767](https://github.com/badlogic/pi-mono/issues/767) | - |
| Codex CLI | [openai/codex#2137](https://github.com/openai/codex/issues/2137) | 38 |
| Gemini CLI | [gemini-cli#3005](https://github.com/google-gemini/gemini-cli/issues/3005) | 6 |
| Claude Code | [claude-code#5017](https://github.com/anthropics/claude-code/issues/5017) | 11 |
| OpenCode | [sst/opencode#3343](https://github.com/sst/opencode/issues/3343) | 3 |

## Proposed Solution

Since bracketed paste sequences are unavailable in Git Bash, a **timing heuristic fallback** would address this:

- If multiple lines arrive within a short window (e.g., <50ms between data events), treat them as a single paste operation
- Buffer until a quiet period (e.g., 50ms of no input), then emit the buffered content as one message
- This is the same approach used by other tools to work around the missing bracketed paste support

## Workarounds Available Today

- **Alt+Enter** to insert newlines manually, then Enter to submit
- **Ctrl+Enter** for newlines (Windows Terminal)
- **Backslash+Enter** for newlines (pi-tui compatibility feature)
- Pipe from file: `cat prompt.txt | openclaw tui`
- Use **WSL** instead of Git Bash (WSL sends bracketed paste correctly)
- Use **WezTerm** or **Ghostty** instead of Windows Terminal

## Framework Root Causes

- [nodejs/node#38079](https://github.com/nodejs/node/issues/38079) — No API to set `ENABLE_VIRTUAL_TERMINAL_INPUT` on Windows
- [microsoft/terminal#12385](https://github.com/microsoft/terminal/issues/12385) — Bracketed paste sequences not sent without VT input flag
- [microsoft/terminal#18094](https://github.com/microsoft/terminal/issues/18094) — Console filters bracketed paste when VT input disabled (Closed: Not Planned)

## Comments

### @gabriel1ll7 (2026-02-02)

+1 - I preffer using TUI instead of other channels, more verbose, outputs execs 


## Links

- None detected yet
