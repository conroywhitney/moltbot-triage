---
number: 3606
title: "Feature Request: Anthropic Prompt Caching Support"
author: Kendiehl
created: 2026-01-28T22:18:34Z
updated: 2026-01-28T22:18:34Z
labels: []
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/moltbot/moltbot/issues/3606
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# Feature Request: Anthropic Prompt Caching Support

## Summary
Add support for Anthropic's prompt caching feature to dramatically reduce API costs for Clawdbot users, potentially saving 80-90% on routine operations.

## Background
Anthropic recently introduced prompt caching, which allows frequently-used content (system prompts, tool definitions, workspace context) to be cached and reused at 90% reduced cost. This is perfect for Clawdbot's architecture where the same large system prompt and tool definitions are sent with every message.

## Current Cost Impact
- System prompt + tool definitions + workspace context: ~20k+ tokens per message
- Heartbeats run every few minutes, each sending the full context
- Example: User spent $170+ in one day during heavy usage
- Most of this cost is repeatedly sending identical content

## How Prompt Caching Works
1. **Cache write**: 1.25× base price (5-min TTL) or 2× base price (1-hour TTL)
2. **Cache read**: 0.1× base price (90% savings!)
3. **Requirements**: Minimum 1,024 tokens, exact content match
4. **Break-even**: Just 2 API calls with the same content

## Implementation Suggestions
1. **Identify cacheable content**:
   - System prompt (agent instructions)
   - Tool definitions
   - Workspace context files (AGENTS.md, SOUL.md, etc.)
   - Skill documentation
   
2. **Structure requests**:
   - Place static content at the beginning of prompts
   - Keep dynamic content (user messages, conversation history) separate
   - Use cache headers in API requests

3. **Configuration options**:
   ```json
   "agents": {
     "defaults": {
       "caching": {
         "enabled": true,
         "ttl": "1h"  // or "5m" for shorter-lived caches
       }
     }
   }
   ```

## Expected Benefits
- **Cost reduction**: 80-90% for routine operations
- **Heartbeat costs**: Drop from ~$0.10 to ~$0.01 per check
- **Daily costs**: From $10-20 to $1-2 for typical usage
- **Spike days**: From $150+ to $20-30

## Additional Considerations
- Cache invalidation when system prompts or tool definitions change
- Monitoring cache hit rates for optimization
- Documentation on how to structure workspace files for optimal caching

## References
- [Anthropic Prompt Caching Documentation](https://docs.anthropic.com/en/docs/build-with-claude/prompt-caching)
- [Pricing Details](https://www.anthropic.com/pricing#claude-api)

---

This feature would be a game-changer for power users who run frequent heartbeats and monitoring tasks. The implementation effort would quickly pay for itself in reduced API costs for the Clawdbot community.

## Comments


## Links

- None detected yet
