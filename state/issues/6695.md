---
number: 6695
title: "Nextcloud Talk: Signature computed on wrong payload"
author: IIUOpenClaw
created: 2026-02-01T23:36:03Z
updated: 2026-02-02T00:15:49Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6695
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

The Nextcloud Talk bot integration fails to send messages due to incorrect signature computation. Messages return 401 Unauthorized even with valid credentials.

## Root Cause

In `extensions/nextcloud-talk/src/send.ts`, the signature is computed on the JSON-stringified body instead of just the message text.

The Nextcloud Talk API expects the signature to be computed on the **message text only**, not the full JSON request body.

## Current Code (line ~92)

The code was:
```typescript
const bodyStr = JSON.stringify(body);

const { random, signature } = generateNextcloudTalkSignature({
  body: bodyStr,  // ❌ Wrong: signing the JSON string
  secret,
});
```

## Fix

```typescript
const { random, signature } = generateNextcloudTalkSignature({
  body: message,  // ✅ Correct: sign just the message text
  secret,
});
```

## Environment
- OpenClaw version: 2026.1.30
- Nextcloud version: Latest AIO
- Talk version: Latest bundled with AIO

## Steps to Reproduce
1. Configure Nextcloud Talk integration with valid bot credentials
2. Attempt to send any message
3. Observe 401 Unauthorized response

## Notes
I patched this locally and it works correctly. The fix is a one-line change.

## Comments


## Links

- None detected yet
