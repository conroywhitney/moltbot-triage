---
number: 4173
title: "Sub-agents hang after receiving tool results - no assistant response generated"
author: mkoslacz
created: 2026-01-29T20:19:37Z
updated: 2026-01-31T02:33:14Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/4173
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

Sub-agents spawned via `sessions_spawn` stop responding after receiving tool results. The agent receives the tool result successfully but never generates the next assistant message.

## Reproduction

1. Spawn a sub-agent with a complex task (e.g., processing a long transcript)
2. Agent makes multiple tool calls (read files, exec commands)
3. Agent receives all tool results successfully
4. **Agent never generates the next assistant message** - session hangs silently

## Evidence from logs

```
v2-ota-supply session log:
  19:28:56 → toolResult exec (touch) ✓ isError: false
  [NO ASSISTANT RESPONSE]
  20:02:35 → manual ping from main agent

v2-ota-business session log:
  19:29:20 → toolResult exec (touch) ✓ isError: false  
  [NO ASSISTANT RESPONSE]

v2-raport-kasowy session log:
  19:29:11 → assistant thinking: "Mam cały transkrypt, teraz muszę..."
  19:29:11 → toolResult exec (touch) ✓ isError: false
  [NO ASSISTANT RESPONSE]
```

All 3 agents stopped at the same point - after receiving tool results, before generating the next assistant turn.

## Expected behavior

After receiving tool results, the agent should continue generating the next assistant message.

## Actual behavior

Agent receives tool results but the session goes silent. No error logged, no timeout reported. The session appears "stuck".

## Workaround attempted

Sending a follow-up message via `sessions_send` returns:
```
[clawdbot] missing tool result in session history; inserted synthetic error result for transcript repair.
```

This suggests the session state is corrupted.

## Environment

- Clawdbot version: latest (npm)
- Model: claude-opus-4-5
- Thinking level: low
- Multiple parallel tool calls before hang

## Possible causes

1. API timeout not being handled/retried
2. Context limit silently exceeded
3. Race condition with parallel tool results
4. Missing retry logic after Claude API failure

## Comments

### @miguelmanlyx (2026-01-30)

Hi. that looks like a Streaming issue. Have you tried running `npx ai-patch doctor` to sanity-check stalls/partial output and common SSE buffering pitfalls?



## Links

- None detected yet
