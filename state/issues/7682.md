---
number: 7682
title: "Feature request: Auto-compress or reject oversized images in session history"
author: kdsz001
created: 2026-02-03T03:32:41Z
updated: 2026-02-03T03:32:41Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7682
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When a user sends a large image (>5MB) via Telegram, it gets stored as base64 in the session history. Every subsequent API request carries this image, and Anthropic's API rejects requests with images exceeding 5MB:

```
LLM request rejected: messages.74.content.1.image.source.base64: 
image exceeds 5 MB maximum: 5798628 bytes > 5242880 bytes
```

This breaks the entire session until you manually edit the session file or start a new session.

## Proposed Solution

1. **On ingest**: Check image size before storing in session. If >4.5MB, either:
   - Auto-compress (resize/quality reduction)
   - Store as file reference instead of base64
   - Reject with user-friendly error

2. **On send**: Before sending to LLM API, validate total image payload size

## Current Workaround

Manually find and edit the session JSONL file to remove the large base64 data:
```bash
# Find the large line
awk '{print NR, length}' session.jsonl | sort -k2 -nr | head -5

# Then manually edit to replace the base64 with a placeholder
```

## Environment
- OpenClaw 2026.1.30
- Channel: Telegram
- Provider: Anthropic (Claude)

## Comments


## Links

- None detected yet
