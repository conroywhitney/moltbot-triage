---
number: 3789
title: "Feature: Per-agent compaction settings"
author: rdylina
created: 2026-01-29T05:41:01Z
updated: 2026-01-29T05:41:01Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/3789
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When using different models with varying context windows across agents, the global compaction settings in `agents.defaults.compaction` become a limitation.

**Example scenario:**
- Agent A uses Claude Opus 4.5 (200k context)
- Agent B uses GPT-5.2 Codex (391k context)

With global settings like:
```json
"compaction": {
  "reserveTokensFloor": 50000,
  "memoryFlush": {
    "softThresholdTokens": 120000
  }
}
```

Agent B can't take advantage of its larger context window without breaking Agent A.

## Proposed Solution

Allow `compaction` settings to be specified per-agent in `agents.list[]`, similar to how `model` can be set per-agent:

```json
{
  "id": "marvin",
  "model": "openai/gpt-5.2-codex",
  "compaction": {
    "reserveTokensFloor": 100000,
    "memoryFlush": {
      "softThresholdTokens": 280000
    }
  }
}
```

Per-agent settings would override defaults, falling back to `agents.defaults.compaction` when not specified.

## Use Case

Multi-model setups where coding agents benefit from larger context models while orchestration/chat agents use standard context models.

## Comments


## Links

- None detected yet
