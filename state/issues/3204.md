---
number: 3204
title: "[Bug] MS Teams channel returns 405 Method Not Allowed on POST /api/messages"
author: PeRoland
created: 2026-01-28T07:42:17Z
updated: 2026-01-28T07:42:17Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/3204
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description
The MS Teams channel plugin does not accept POST requests to `/api/messages`, returning "405 Method Not Allowed". This prevents the bot from receiving messages from Azure Bot Service / Bot Framework.

## Environment
- **Moltbot Version:** 2026.1.26 (cf334d3)
- **OS:** Ubuntu 24.04
- **Installation:** Built from source (pnpm)
- **Node Version:** v22.22.0

## Steps to Reproduce
1. Install Moltbot from source:
```bash
git clone https://github.com/clawdbot/clawdbot
cd clawdbot
pnpm install && pnpm build
pnpm link --global
```

2. Configure MS Teams channel:
```bash
moltbot plugins enable msteams
moltbot channels add --channel msteams
```

3. Configure `~/.clawdbot/moltbot.json`:
```json
{
  "channels": {
    "msteams": {
      "enabled": true,
      "appId": "your-app-id",
      "appPassword": "your-app-password"
    }
  }
}
```

4. Start gateway:
```bash
moltbot gateway --port 18789 --verbose
```

5. Test POST request:
```bash
curl -X POST http://127.0.0.1:18789/api/messages \
  -H "Content-Type: application/json" \
  -d '{"test": "data"}'
```

## Expected Behavior
The MS Teams channel should:
- Accept POST requests on `/api/messages` (Bot Framework messaging endpoint)
- Process Bot Framework Activity payloads
- Return appropriate responses (200 OK or authentication errors)

## Actual Behavior
```
Method Not Allowed
```

The gateway returns 405 for all POST requests to `/api/messages`.

## Additional Context
- Azure Bot Service is configured correctly with:
  - App ID and Client Secret
  - Messaging endpoint: `https://[ngrok-url]/api/messages`
  - Teams channel enabled
- OPTIONS requests work correctly (204 No Content) when proxied through nginx
- POST requests from Bot Framework fail with 405
- Telegram channel works perfectly with the same gateway instance

## Gateway Logs
No error messages appear in gateway logs when POST request arrives. The 405 response appears to come from Moltbot itself, not from missing routing.

## Expected Endpoint Behavior
According to Bot Framework documentation, the messaging endpoint should:
1. Accept POST with `application/json` content type
2. Receive Activity objects (messages, typing indicators, etc.)
3. Validate JWT tokens in Authorization header
4. Return 200/201 for successful processing
5. Return 401 for authentication failures

## Workaround
None found. MS Teams integration is currently non-functional.

## Related
- Telegram channel works: ✅
- WhatsApp channel works: ✅  
- MS Teams channel: ❌

Is the MS Teams plugin fully implemented or is this a known WIP feature?
```

---

## Wo posten:

**GitHub Issues:**
```
https://github.com/clawdbot/clawdbot/issues/new

## Comments


## Links

- None detected yet
