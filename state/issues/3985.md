---
number: 3985
title: "Feature: Auto-map agentId to accountId for cron job deliveries"
author: dwfinkelstein
created: 2026-01-29T13:21:51Z
updated: 2026-01-29T13:27:08Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3985
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

When a cron job with `agentId: "agent-b"` uses `deliver: true` to send output to Discord, the message is sent from the `default` Discord account instead of the matching `agent-b` account.

## Current Behavior

- Cron job configured with `agentId: "agent-b"`
- Delivery payload: `{"deliver": true, "channel": "discord", "to": "channel:..."}`
- Message appears in correct channel but with wrong identity (default account instead of agent-b)

## Expected Behavior

When `agentId` is set on a cron job and a matching Discord `accountId` exists in config, the delivery should automatically use that account.

Mapping logic:
```
agentId: "agent-b" → accountId: "agent-b" (if exists)
agentId: "agent-c" → accountId: "agent-c" (if exists)
```

## Config Context

```json
{
  "agents": {"list": [{"id": "agent-b", ...}]},
  "bindings": [{"agentId": "agent-b", "match": {"channel": "discord", "accountId": "agent-b"}}],
  "channels": {
    "discord": {
      "accounts": {
        "agent-b": {"token": "..."},
        "default": {"token": "...(agent-a's token)..."}
      }
    }
  }
}
```

## Workaround

Changed cron jobs from `isolated` + `deliver: true` to `main` + `systemEvent` with instructions to use the `message` tool with explicit `accountId`.

## Suggestion

Either:
1. Auto-map `agentId` → `accountId` for deliveries when a matching account exists
2. Allow `accountId` in the cron job delivery payload schema

## Comments


## Links

- None detected yet
