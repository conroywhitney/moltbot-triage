---
number: 3375
title: "WhatsApp: Media from other group members not downloaded when using groupPolicy: allowlist"
author: decomontenegro
created: 2026-01-28T14:33:37Z
updated: 2026-01-30T05:39:36Z
labels: ["bug", "channel: whatsapp-web"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3375
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

When configuring a WhatsApp group in the allowlist with `requireMention: false`, media (images, PDFs, documents) sent by **other group members** is silently ignored, while text messages work correctly.

## Expected Behavior

Adding a group to the `groups` configuration with `requireMention: false` should allow the bot to receive and process media from **all participants** in that group.

## Actual Behavior

- ✅ Text messages from any group member work
- ✅ Media from numbers in `allowFrom` works
- ❌ Media from other group members is **silently ignored** (no error in logs)

## Root Cause

The `groups` configuration only controls **mention gating** (when to respond), not **access control** for media downloads.

The `groupPolicy: "allowlist"` checks the **sender's phone number** against `groupAllowFrom` (or `allowFrom` as fallback), not the group ID.

This means:
- `groups: { "group-id": { requireMention: false } }` → Controls if bot needs @mention
- `groupAllowFrom` → Controls whose media gets downloaded

Without `groupAllowFrom`, the system uses `allowFrom` as fallback, so only the owner's numbers have media processed.

## Minimal Reproduction

```json
{
  "channels": {
    "whatsapp": {
      "dmPolicy": "allowlist",
      "allowFrom": ["+1234567890"],
      "groupPolicy": "allowlist",
      "groups": {
        "123456789@g.us": {
          "requireMention": false
        }
      }
    }
  }
}
```

1. Add a group to the allowlist with `requireMention: false`
2. Have another person (not in `allowFrom`) send an image or PDF
3. Observe that the media is not downloaded (no `mediaPath` in logs)

## Workaround

Add `groupAllowFrom: ["*"]` to allow media from all senders in groups:

```json
{
  "channels": {
    "whatsapp": {
      "groupAllowFrom": ["*"],
      // ... rest of config
    }
  }
}
```

## Suggestions

1. **Documentation**: Clarify that `groups` only controls mention gating, not media access
2. **Default behavior**: Consider using `groupAllowFrom: ["*"]` as default when a group is explicitly added to the allowlist
3. **Logging**: Add a warning when media is discarded due to sender permission (currently silent)

## Environment

- Clawdbot version: 2026.1.24-3
- Node.js: v22.22.0
- OS: Ubuntu 24.04

## Comments

### @Sarang19114 (2026-01-30)

I've submitted a fix for this issue: #4390 

The fix modifies [checkInboundAccessControl](moltbot/src/web/inbound/access-control.ts) to check if a group is in the `groups` allowlist before falling back to `groupAllowFrom` checks. When a group is explicitly allowlisted, messages from all participants are now allowed.


## Links

- None detected yet
