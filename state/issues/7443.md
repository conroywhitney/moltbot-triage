---
number: 7443
title: "Bug: TypeError 'Cannot read properties of undefined (reading trim)' in subagent spawn"
author: innovaflow
created: 2026-02-02T20:53:47Z
updated: 2026-02-02T20:53:47Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7443
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When spawning a subagent via `sessions_spawn`, the subagent crashes immediately with:

```
TypeError: Cannot read properties of undefined (reading 'trim')
```

## Stack Trace

```
at file:///app/dist/agents/system-prompt.js:437:46
at Array.some (<anonymous>)
at buildAgentSystemPrompt (file:///app/dist/agents/system-prompt.js:436:42)
at buildEmbeddedSystemPrompt (file:///app/dist/agents/pi-embedded-runner/system-prompt.js:4:12)
at runEmbeddedAttempt (file:///app/dist/agents/pi-embedded-runner/run/attempt.js:280:30)
```

## Root Cause

Two locations have `.trim()` calls without null checks:

### 1. `/app/dist/agents/pi-embedded-runner/lanes.js` line 2

**Before:**
```javascript
const cleaned = key.trim() || "main";
```

**Fix:**
```javascript
const cleaned = (key ?? "").trim() || "main";
```

### 2. `/app/dist/agents/system-prompt.js` line 437

**Before:**
```javascript
const normalizedPath = file.path.trim().replace(/\\\\/g, "/");
```

**Fix:**
```javascript
const normalizedPath = (file.path ?? "").trim().replace(/\\\\/g, "/");
```

## Reproduction

1. Call `sessions_spawn` with a simple task
2. Subagent immediately fails with the TypeError

## Environment

- OpenClaw version: 2026.2.1
- Node: v22.22.0
- Running in Docker container

## Workaround

Apply the fixes above directly to the `dist/` files and restart the gateway.

## Comments


## Links

- None detected yet
