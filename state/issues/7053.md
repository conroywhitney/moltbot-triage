---
number: 7053
title: "Feature Request: Gateway Auto-Recovery and Process Supervision"
author: SchemaNZ
created: 2026-02-02T10:21:52Z
updated: 2026-02-02T10:21:52Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7053
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

The gateway process crashes intermittently with no automatic recovery, causing:
- Orphaned `openclaw-message` processes (30+ at ~330MB each = ~10GB waste)
- Channel outages until manual intervention  
- No alerting or monitoring

## üîç Diagnostic Evidence

Recent crash sequence captured in logs:
```
2026-02-02T10:16:44.335Z [discord] Slow listener detected: DiscordMessageListener took 90.5 seconds for event MESSAGE_CREATE
2026-02-02T10:16:53.496Z [gateway] signal SIGTERM received
2026-02-02T10:16:53.497Z [gateway] received SIGTERM; shutting down
```

**Root cause hypothesis**: Discord MESSAGE_CREATE handler occasionally blocks for 60-90 seconds, possibly due to:
- Resource exhaustion (memory pressure, CPU starvation)  
- Deadlock in message handler chain
- Blocking I/O operation (database write, API call, file operation)
- LLM API timeout cascading back to Discord handler

## Requested Feature

Built-in gateway supervision and auto-recovery.

### Requirements

**1. Health Monitoring**
- Periodic health checks (30-60s intervals)
- WebSocket endpoint probing (`ws://127.0.0.1:<port>`)
- Orphaned process detection

**2. Auto-Recovery**  
- Clean shutdown of orphaned processes
- Automatic gateway restart
- Exponential backoff to prevent crash loops

**3. Observability**
- Recovery event logging
- Optional webhook notifications  
- Health status API endpoint

### Implementation Options

**Option A: Supervised Mode** (Preferred)
```bash
openclaw gateway run --supervised
```

**Option B: Systemd Integration**
```bash
openclaw gateway install --systemd  # generates service file
```

**Option C: Standalone Monitor**
```bash
openclaw gateway monitor --port <port> --restart-on-failure
```

### Acceptance Criteria

- [ ] Gateway restarts within 60s of crash
- [ ] Orphaned processes cleaned before restart
- [ ] Recovery events logged with timestamps
- [ ] Works with user-space npm installs (no root required)
- [ ] Configurable via `openclaw.json`
- [ ] Zero-config default behavior

### Environment Context

- **Install**: User-space npm (not system-space)
- **Platform**: Linux VPS
- **Channels**: Discord + WhatsApp
- **Config**: `~/.openclaw/openclaw.json`

### Workaround Implemented

Created a cron-based watchdog script that:
- Monitors gateway health every 60s via WebSocket probe
- Kills orphaned `openclaw-message` processes before restart
- Logs recovery events with timestamps  
- Successfully recovered from test crash in <2 minutes

## Impact

**Production reliability issue** affecting multi-channel deployments. Built-in supervision would make OpenClaw much more production-ready for 24/7 deployments.

**Urgency**: Medium (workaround exists but requires user implementation)  
**Complexity**: Medium (process supervision + cleanup logic)

## Related Issues

The Discord listener performance bottleneck may be a separate issue worth investigating - 90-second MESSAGE_CREATE handlers suggest an underlying performance problem that could be causing the crashes.

## Comments


## Links

- None detected yet
