---
number: 3033
title: "[Bug] Gateway crashes if hooks.enabled is true but hooks.token is missing"
author: RoboRaju
created: 2026-01-27T23:41:43Z
updated: 2026-01-31T17:03:47Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3033
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

### Context
The clawdbot gateway fails to start when `hooks.enabled` is set to `true` in the configuration file (`clawdbot.json`) but no `hooks.token` is provided. This causes a hard crash during the bootstrap process, preventing the service (and other channels like WhatsApp/Telegram) from initializing.

### The Error
The application throws the following exception during startup:
`Gateway failed to start: Error: hooks.enabled requires hooks.token`

### Current Configuration State (Triggering the bug)
```json
{
  "hooks": {
    "enabled": true,
    "internal": {
      "enabled": true
    }
  }
}
```

### Desired Behavior
Instead of a hard crash, the application should implement one of the following:
1. **Auto-Generation:** If `hooks.enabled` is true but no token exists, generate a secure random hex token, save it back to the config file, and continue booting.
2. **Graceful Degradation:** Log a clear warning and automatically disable the hooks feature while allowing the rest of the gateway (WhatsApp, Telegram, etc.) to start normally.
3. **Improved Validation:** Provide a more descriptive error message that explains exactly how the user can generate or add the missing token.

## Comments

### @ahmedelsaadanyy (2026-01-31)

Same here! I faced this issue and just sent this link of the bug to my bot XD, and it was fixed. 

This is his response: 
I have analyzed the issue and applied a patch to your local OpenClaw installation.

**The Fix:**
The issue was that enabling `hooks` without explicitly setting a `hooks.token` would cause the Gateway to crash on startup. I have modified the `gateway/hooks.js` logic to:
1.  **Check** if the token is missing when hooks are enabled.
2.  **Auto-generate** a secure random token if one is missing.
3.  **Save** the new token to your configuration file automatically.

This prevents the crash and ensures a smooth startup even if you enable hooks later.

**Note:**
Since `hooks.enabled` is currently `false` in your configuration, you weren't experiencing the crash yet, but this fix protects you if you decide to enable it in the future.

If you want to apply this change immediately (e.g. to test enabling hooks), you can restart the gateway:
`openclaw gateway restart`

Otherwise, no action is needed; the fix is in place.

I just enabled the hooks and restarted my gateway, and it works with no crash, and now the hooks have a token generated automatically XD.


## Links

- None detected yet
