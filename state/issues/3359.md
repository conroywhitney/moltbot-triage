---
number: 3359
title: "Security: npm audit reports vulnerabilities in tar (via cmake-js/node-llama-cpp) and hono"
author: jelwoodwealthaccess
created: 2026-01-28T14:00:31Z
updated: 2026-01-31T02:38:12Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/3359
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary
Running an audit against the published package contents for `clawdbot@2026.1.24-3` surfaces several transitive vulnerabilities. I understand some may be in optional/build-time deps, but wanted to report so the dependency tree can be updated.

## Environment
- macOS (arm64), Node v25.4.0, npm v11.7.0
- Installed: `npm i -g clawdbot@latest` (latest reported as 2026.1.24-3)

## How I reproduced
Because `npm audit` does not support globals (`EAUDITGLOBAL`), I copied the global install to a temp dir and generated a lockfile:

```bash
tmp="$(mktemp -d)"
cp -R /opt/homebrew/lib/node_modules/clawdbot "$tmp/clawdbot"
cd "$tmp/clawdbot"
npm i --package-lock-only
npm audit
```

## Audit output (abridged)

### hono <= 4.11.6 (moderate)
- GHSA-6wqw-2p9w-4vw4 — cache middleware ignores "Cache-Control: private" leading to Web Cache Deception
- GHSA-r354-f388-2fhh — IPv4 address validation bypass in IP Restriction Middleware allows IP spoofing
- GHSA-w332-q679-j88p — Arbitrary Key Read in Serve static Middleware (Cloudflare Workers Adapter)

Suggested by npm: update to `hono@4.11.7` (would be outside declared range in my audit run).

### tar <= 7.5.3 (high)
- GHSA-8qq5-rm4j-mr97 — Arbitrary File Overwrite / Symlink Poisoning via insufficient path sanitization
- GHSA-r6q2-hw4h-h46w — Race condition in tar path reservations via Unicode ligature collisions on macOS APFS

Dependency chain reported by npm:
- `cmake-js <= 7.4.0` depends on vulnerable `tar`
- `node-llama-cpp >= 2.4.0` depends on vulnerable `cmake-js`

Npm suggested fix was `npm audit fix --force` which would install `node-llama-cpp@2.3.2` (breaking change), so I did not apply it.

## Request
Could you please update dependencies / ranges so `tar` and `hono` resolve to non-vulnerable versions (or gate optional deps so they are not shipped/installed unless needed)?

Happy to re-test on a prerelease/branch if helpful.

## Comments

### @jelwoodwealthaccess (2026-01-28)

Extra detail from local install:

- `node-llama-cpp` is present as an *optionalDependency* in `clawdbot@2026.1.24-3`:
  - `package.json optionalDependencies['node-llama-cpp']` => `3.15.0`
  - installed version at `node_modules/node-llama-cpp` => `3.15.0`
  - not listed in dependencies/devDependencies.

This likely explains the tar/cmake-js chain being present even if LLaMA features aren't used at runtime.

Commands used:
```bash
node -p "require('/opt/homebrew/lib/node_modules/clawdbot/package.json').optionalDependencies?.['node-llama-cpp']"
node -p "require('/opt/homebrew/lib/node_modules/clawdbot/node_modules/node-llama-cpp/package.json').version"
```



## Links

- None detected yet
