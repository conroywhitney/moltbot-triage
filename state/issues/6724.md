---
number: 6724
title: "[Bug]: /clear command does not truncate session transcript, context keeps growing"
author: limelightcreatornetwork-svg
created: 2026-02-02T00:30:15Z
updated: 2026-02-02T12:42:47Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6724
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Description

The `/clear` command does not properly reset the session context. After running `/clear`, the context token count remains at the same level (e.g., 139k/100k tokens), and the session transcript file (`.jsonl`) continues to grow unbounded.

## Steps to Reproduce

1. Start OpenClaw and have a conversation that accumulates context
2. Observe context usage (e.g., `tokens 139k/100k (139%)`)
3. Run `/clear`
4. Observe that context usage remains unchanged
5. Check the session transcript file in `~/.openclaw/agents/main/sessions/` - it's still the same size

## Expected Behavior

`/clear` should:
- Truncate or reset the session transcript file (`.jsonl`)
- Reset the context token count to near zero
- Start fresh with only system prompts

## Actual Behavior

- `/clear` displays "Context cleared. Fresh start." but the token count remains unchanged
- The `.jsonl` transcript file keeps all historical data
- On the next turn, the full bloated history is reloaded and sent to the model
- Context shows over 100% of limit (e.g., 139k/100k)

## Environment

- **OpenClaw version**: 2026.1.30 (76b5208)
- **OS**: macOS (Darwin 25.1.0)
- **Model**: anthropic/claude-opus-4-5

## Evidence

Session files before manual cleanup:
```
9.2M  8b9f6d28-752a-4fb6-b5b8-ab120866b1c3.jsonl  (active session)
176K  sessions.json
```

The 9.2MB transcript file was being fully loaded into context despite running `/clear`.

## Workaround

Manually delete the session files:
```bash
rm ~/.openclaw/agents/main/sessions/*.jsonl
rm ~/.openclaw/agents/main/sessions/sessions.json
# Then restart OpenClaw
```

## Related

This may also affect `/compact` - compaction was failing with "No API key found for provider" errors, possibly because the context was already over the limit before compaction could run.

## Suggested Fix

`/clear` should either:
1. Truncate the active `.jsonl` transcript file
2. Create a new session file and update `sessions.json`
3. Or at minimum, mark a "clear point" in the transcript so only post-clear messages are loaded into context

## Comments

### @MarvinFS (2026-02-02)

Can confirm this on our end too (OpenClaw 2026.1.30, Ubuntu, claude-opus-4-5).

Our observation is slightly different but related: after `/clear`, the messages array appears empty (`messages: 0` in display), but the `totalTokens` counter in `sessions.json` wasn't reset. The UI showed stale context percentage until we manually edited `sessions.json` to reset the counters.

So it seems like `/clear` removes the message references but doesn't:
1. Truncate the actual `.jsonl` transcript (as you noted)
2. Reset the token accounting in `sessions.json`

Both need to happen for a true fresh start.


## Links

- None detected yet
