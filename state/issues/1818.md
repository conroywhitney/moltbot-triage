---
number: 1818
title: "[Bug]: Onboarding wizard does not install Systemd service on Ubuntu 22.04"
author: chepurko
created: 2026-01-25T13:59:10Z
updated: 2026-01-30T16:40:38Z
labels: ["bug"]
assignees: []
comments_count: 9
reactions_total: 8
url: https://github.com/openclaw/openclaw/issues/1818
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary
The onboarding wizard does not install a Systemd service in Ubuntu. During the Systemd step, it prints: Systemd user services are unavailable. Skipping lingering checks and service install.

This is because the **isSystemdUserServiceAvailable** function is throwing this error:

`Failed to connect to bus: $DBUS_SESSION_BUS_ADDRESS and $XDG_RUNTIME_DIR not defined (consider using --machine=<user>@.host --user to connect to bus of other user)`

## Steps to reproduce
Just run the onboarding wizard on Ubuntu 22.04.

## Expected behavior
Systemd is obviously installed on my OS.

## Actual behavior
`Gateway service check failed: Error: systemctl --user unavailable: Failed to connect to bus: $DBUS_SESSION_BUS_ADDRESS and $XDG_RUNTIME_DIR not defined (consider using --machine=<user>@.host --user to connect to bus of other user)`

## Environment
- Clawdbot version: 2026.1.23-1
- OS: Ubuntu 22.04
- Install method (pnpm/npx/docker/etc): npm

## Logs or screenshots
`Gateway service check failed: Error: systemctl --user unavailable: Failed to connect to bus: $DBUS_SESSION_BUS_ADDRESS and $XDG_RUNTIME_DIR not defined (consider using --machine=<user>@.host --user to connect to bus of other user)`

## Comments

### @davetroy (2026-01-25)

Experiencing the same issue on Ubuntu 24.04 and clawdbot 2026.1.24-3.

### @UVvirus (2026-01-26)

### âœ… Solution

This resolved the issue for me.

1. SSH into your **EC2 instance**
2. Start the Clawdbot gateway manually:
   ```bash
   clawdbot gateway run
3. (Optional) To keep the bot running after disconnecting, run it inside a screen session:
    ```bash
    screen -R clawdbot
    clawdbot gateway run


### @davetroy (2026-01-26)

Thanks, yes, that's a functional workaround, but it doesn't fix the underlying issue of not being manageable with `systemd`. Would like to see that resolved as well.

### @chepurko (2026-01-26)

I've also made a workaround by creating my own Systemd unit file:

```
[Unit]
Description=Clawdbot Gateway (name: chep, v1)
After=network-online.target
Wants=network-online.target

[Service]
User=user
WorkingDirectory=/home/userclawd
ExecStart=/home/usernpm-global/bin/clawdbot gateway --port 18789
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

So my gateway is running, but this doesn't fix the issue with the install script, and also the various `clawdbot gateway` commands don't work because they don't see any systemd service. (don't know how to make it see my systemd unit).

### @avatsaev (2026-01-26)

Experiencing the same issue on Ubuntu 24 server LXC container 

### @schniggie (2026-01-26)

Same issue on Debian 13

### @live9369 (2026-01-27)

I've also resolved this problem with installing user session support:
```bash
sudo apt install -y dbus-user-session
```
Enable lingering for the user:
```bash
sudo loginctl enable-linger ubuntu
```
Finally, verify that the user systemd instance is running:
```bash
systemctl --user status
```


### @growthringsadvisory (2026-01-28)

I've submitted a fix for this in PR #3527.

The issue is that the CLI only checks for systemd user services (`systemctl --user`), but on VPS/server installs, the gateway often runs as a system service (`/etc/systemd/system/`).

The fix adds detection and management for system services:
- Status commands now check both user and system service locations
- Service management (stop/restart) tries user first, falls back to system with sudo
- Should resolve the "systemd not installed" false negative

Would love feedback on the approach!

### @GabrielDrapor (2026-01-30)

For others who just want to restart the gateway, simply find the process and kill it. It will restart automatically.


## Links

- None detected yet
