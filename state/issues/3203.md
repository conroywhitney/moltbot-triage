---
number: 3203
title: "[Bug]: Matrix extension fails to fetch media"
author: CoffeeCodex
created: 2026-01-28T07:39:39Z
updated: 2026-01-28T07:39:39Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3203
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description
The Matrix extension currently fails when fetching media because params.client.downloadContent returns an object containing { data, contentType }, but the code expects a buffer directly.

## File: extensions/matrix/src/matrix/monitor/media.ts

## Proposed Fix
Update fetchMatrixMediaBuffer to correctly handle the result object and return the content type as headerType.

```
// Around line 30-35
const result = await params.client.downloadContent(params.mxcUrl);
if (result.data.byteLength > params.maxBytes) {
  throw new Error("Matrix media exceeds configured size limit");
}
return { buffer: result.data, headerType: result.contentType };
```

## Comments


## Links

- None detected yet
