---
number: 4836
title: "memoryFlush enabled but not executing during compaction"
author: wgomez23
created: 2026-01-30T18:43:08Z
updated: 2026-01-31T19:12:35Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4836
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Issue Summary

`compaction.memoryFlush.enabled: true` is set in config but the feature is not executing during compaction events. This causes complete loss of conversation context across sessions.

## Evidence

### Config (✅ Enabled)
```json
"compaction": {
  "mode": "safeguard",
  "memoryFlush": {
    "enabled": true
  }
}
```

### Gateway Logs (❌ Not Executing)
Compaction events show NO memoryFlush execution:
- `embedded run compaction start` - fires
- **No memoryFlush logs**
- `embedded run agent end` - fires

### File System (❌ No Output)
```bash
find ~/.clawdbot -name "*flush*"
# Result: Empty (zero flush files created)
```

## Impact

**Critical** - Lost conversation context today:
- User: "lets join. Use my @williamgomezjr twitter account."
- Context about WHAT we're joining was in previous session
- Compaction at 9 AM lost all context
- Feature enabled since 2026-01-29 14:19 CST (1 day ago)

## Expected Behavior

According to https://x.com/AlexFinn/status/2016550475718664522:
- Should auto-save important context to files before compaction
- Should provide "10000x better memory continuity"

## Actual Behavior

- Config reads `enabled: true`
- Compaction happens
- No flush files created
- No memoryFlush activity in logs
- Complete context loss

## Environment

- **Version:** 2026.1.24-3
- **Platform:** macOS (Darwin 25.2.0 arm64)
- **Node:** v22.22.0
- **Gateway Mode:** local
- **Agent:** main

## Reproduction

1. Enable `compaction.memoryFlush.enabled: true`
2. Restart gateway
3. Have conversation exceeding cache-ttl (1h)
4. Wait for compaction
5. Check for flush files: `find ~/.clawdbot -name "*flush*"`
6. Result: Empty

## Logs

```
/tmp/clawdbot/clawdbot-2026-01-30.log
```

Compaction events at 18:21:43 and 18:27:11 with zero memoryFlush activity.

## Workarounds

Currently using:
1. Manual memory checkpoints to `memory/YYYY-MM-DD.md`
2. TASKS.md-based recovery for active work

## Request

- Is this a known issue?
- Does memoryFlush require additional config?
- Are there missing dependencies?
- Is the feature actually implemented or still experimental?

Thank you!

## Comments

### @ManuelHettich (2026-01-31)

Proposed fix for this issue since I have struggled with this issue too: #5343 


## Links

- None detected yet
