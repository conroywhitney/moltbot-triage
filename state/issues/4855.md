---
number: 4855
title: "[Bug]: Control UI assets not found on npm global install (resolveControlUiDistIndexPath fails)"
author: anapivirtua
created: 2026-01-30T19:20:42Z
updated: 2026-02-03T01:40:40Z
labels: []
assignees: []
comments_count: 7
reactions_total: 6
url: https://github.com/openclaw/openclaw/issues/4855
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

Control UI fails to load with "Missing Control UI assets. Build them with `pnpm ui:build`" when OpenClaw is installed via `npm install -g openclaw`, even though the assets are correctly included in the package.

## Steps to reproduce

1. Install OpenClaw globally: `npm install -g openclaw@2026.1.29`
2. Start the gateway: `openclaw gateway`
3. Access `http://127.0.0.1:18789/`
4. Error message appears: "Missing Control UI assets. Build them with `pnpm ui:build` (auto-installs UI deps)."

## Expected behavior

The Control UI should load normally since `dist/control-ui/index.html` and all assets are present in the npm package.

## Actual behavior

The UI asset detection fails and suggests running `pnpm ui:build`, which is impossible because the build scripts aren't included in the npm package.

## Root Cause

`resolveControlUiDistIndexPath()` in `src/infra/control-ui-assets.ts` assumes `process.argv[1]` points to a file inside `dist/`:

```javascript
const distDir = path.dirname(normalized);
if (path.basename(distDir) !== "dist") return null;
```

When installed via npm global, `process.argv[1]` is `/path/to/node_modules/openclaw/openclaw.mjs` (package root), not inside `dist/`. This causes the function to return `null`.

The fallback `resolveControlUiRepoRoot()` also fails because it looks for `ui/vite.config.ts` which isn't in the npm package.

**Verification:**
```
$ node -e "console.log(process.argv[1])"
/opt/homebrew/lib/node_modules/openclaw/openclaw.mjs

$ ls /opt/homebrew/lib/node_modules/openclaw/dist/control-ui/
assets/  apple-touch-icon.png  favicon-32.png  favicon.ico  favicon.svg  index.html
```

The assets exist but the detection logic can't find them.

## Suggested Fix

Add a fallback in `resolveControlUiDistIndexPath` to check for `dist/control-ui/index.html` relative to the package root when the entrypoint isn't inside `dist/`:

```javascript
// Fallback: check relative to package.json location
const pkgDir = findPackageRoot(normalized); // find nearest package.json
if (pkgDir) {
  const fallbackIndex = path.join(pkgDir, "dist", "control-ui", "index.html");
  if (fs.existsSync(fallbackIndex)) return fallbackIndex;
}
```

## Environment

- OpenClaw version: 2026.1.29
- OS: macOS 26.0 (arm64)
- Node: v25.5.0
- Install method: `npm install -g openclaw`

## Logs or screenshots

```
$ openclaw status
...
Dashboard       │ http://127.0.0.1:18789/
...
```

Dashboard URL shown but accessing it shows the "Missing Control UI assets" error.

## Comments

### @goforu (2026-02-01)

still happening

### @lei-sss (2026-02-01)

still happening in 2026.1.30

### @gumadeiras (2026-02-01)

I can’t reproduce this locally, so I need a bit more info to debug. Could you share the following?

1. OS + architecture
2. Output of:
   - node -v
   - npm -v
   - npm root -g
   - npm prefix -g
3. The output of `which openclaw`
4. A directory listing of the installed package:
   `ls -R $(npm root -g)/openclaw`
5. Startup args `node -e "console.log(process.argv)" $(which openclaw)`

This will help determine why the asset resolution logic behaves differently on your setup.


### @lei-sss (2026-02-01)

@gumadeiras 

1. macOS Tahoe 26.2 + Arm
2. Output
  - `node -v` -> `v24.13.0`
  - `npm -v` -> `11.6.2`
  - `npm root -g` -> `/Users/l.z/.asdf/installs/nodejs/24.13.0/lib/node_modules`
  - `npm prefix -g` -> `/Users/l.z/.asdf/installs/nodejs/24.13.0`
3. `which openclaw` -> `/Users/l.z/.asdf/shims/openclaw`

4. 
[step 4.txt](https://github.com/user-attachments/files/24996907/step.4.txt)

5. 

[step 5.txt](https://github.com/user-attachments/files/24996911/step.5.txt)

 

### @Tang121337 (2026-02-02)

still happening in 2026.2.3

### @LeenixP (2026-02-03)

still happening in 2026.2.3

### @LeenixP (2026-02-03)

## system
### cat /etc/os-release
```bash
root@TaishanPi-3M:~# cat /etc/os-release
PRETTY_NAME="Debian GNU/Linux 12 (bookworm)"
NAME="Debian GNU/Linux"
VERSION_ID="12"
VERSION="12 (bookworm)"
VERSION_CODENAME=bookworm
ID=debian
HOME_URL="https://www.debian.org/"
SUPPORT_URL="https://www.debian.org/support"
BUG_REPORT_URL="https://bugs.debian.org/"
BUILD_INFO="root@host Mon Feb  2 14:53:04 CST 2026"
ID_LIKE="debian"
RK_BUILD_INFO="root@host Mon Feb  2 14:53:28 CST 2026"
```
### lscpu
```bash
root@TaishanPi-3M:~# lscpu
Architecture:             aarch64
  CPU op-mode(s):         32-bit, 64-bit
  Byte Order:             Little Endian
CPU(s):                   8
  On-line CPU(s) list:    0-7
Vendor ID:                ARM
  Model name:             Cortex-A53
    Model:                4
    Thread(s) per core:   1
    Core(s) per socket:   4
    Socket(s):            1
    Stepping:             r0p4
    CPU(s) scaling MHz:   60%
    CPU max MHz:          2016.0000
    CPU min MHz:          408.0000
    BogoMIPS:             2000.00
    Flags:                fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
  Model name:             Cortex-A72
    Model:                0
    Thread(s) per core:   1
    Core(s) per socket:   4
    Socket(s):            1
    Stepping:             r1p0
    CPU(s) scaling MHz:   18%
    CPU max MHz:          2208.0000
    CPU min MHz:          408.0000
    BogoMIPS:             2000.00
    Flags:                fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
Vulnerabilities:
  Gather data sampling:   Not affected
  Itlb multihit:          Not affected
  L1tf:                   Not affected
  Mds:                    Not affected
  Meltdown:               Not affected
  Mmio stale data:        Not affected
  Reg file data sampling: Not affected
  Retbleed:               Not affected
  Spec rstack overflow:   Not affected
  Spec store bypass:      Not affected
  Spectre v1:             Mitigation; __user pointer sanitization
  Spectre v2:             Mitigation; CSV2, BHB
  Srbds:                  Not affected
  Tsx async abort:        Not affected
```

### cat /proc/cpuinfo
```bash
root@TaishanPi-3M:~# cat /proc/cpuinfo
processor       : 0
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4

processor       : 1
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4

processor       : 2
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4

processor       : 3
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4

processor       : 4
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x1
CPU part        : 0xd08
CPU revision    : 0

processor       : 5
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x1
CPU part        : 0xd08
CPU revision    : 0

processor       : 6
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x1
CPU part        : 0xd08
CPU revision    : 0

processor       : 7
BogoMIPS        : 2000.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x1
CPU part        : 0xd08
CPU revision    : 0

Serial          : 4c89cdd6a5b6a1f5
```

### arch
```bash
root@TaishanPi-3M:~# arch
aarch64
```

## environment
```bash
root@TaishanPi-3M:~# node -v
v22.22.0
root@TaishanPi-3M:~# npm -v
10.9.4
root@TaishanPi-3M:~# npm root -g
/usr/lib/node_modules
root@TaishanPi-3M:~# npm prefix -g
/usr
```

## The output of which openclaw
```bash
root@TaishanPi-3M:~# which openclaw
/usr/bin/openclaw
root@TaishanPi-3M:~#
```
## A directory listing of the installed package
```bash
ls -R $(npm root -g)/openclaw > openclaw_ls.txt
```

file: [openclaw_ls.txt](https://github.com/user-attachments/files/25028307/openclaw_ls.txt)

## Startup args node -e "console.log(process.argv)" $(which openclaw)
```bash
node -e "console.log(process.argv)" $(which openclaw) > openclaw_args.txt
```

file: [openclaw_args.txt](https://github.com/user-attachments/files/25028308/openclaw_args.txt)



## Links

- None detected yet
