---
number: 4771
title: "[Feature]: Password-protected exec approvals for Discord"
author: nkreadly07
created: 2026-01-30T17:00:32Z
updated: 2026-01-30T17:00:32Z
labels: ["enhancement"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4771
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary
Discord exec approvals currently rely solely on DM access. If an attacker compromises a Discord account (session hijack, shared device, phishing), they can approve arbitrary exec commands without any additional verification. This creates a single point of failure for users who rely on exec approvals as a security guardrail.

## Proposed solution
Add an optional requirePassword setting to Discord exec approvals. When enabled, clicking "Allow once" or "Always allow" opens a Discord modal prompting for a master password. Password is verified against a stored scrypt hash — if valid, approval proceeds; if invalid, ephemeral error and approval blocked.

```
yaml

channels:
  discord:
    execApprovals:
      enabled: true
      approvers: ["123456789"]
      requirePassword: true
```

CLI to set password: clawdbot approvals set-password

Why modal? Password is not stored in chat history, interaction is ephemeral, creates true second factor (Discord access + password knowledge).

## Alternatives considered
OTP (Google Authenticator) — More secure but adds setup complexity. Could be future enhancement.
Rate limiting on approvals — Doesn't prevent a single malicious approval.
Separate approval channel (email, SMS) — Adds latency, worse UX for time-sensitive approvals.

## Additional context
TOTP (Google Authenticator) — More secure but adds setup complexity. Could be future enhancement.
Rate limiting on approvals — Doesn't prevent a single malicious approval.
Separate approval channel (email, SMS) — Adds latency, worse UX for time-sensitive approvals.

---

Additional context

Built a working prototype with scrypt hashing, modal builders, and verification logic
No new dependencies — uses Node.js built-in crypto.scrypt
Backward compatible: requirePassword defaults to false
Happy to submit a PR if this direction is accepted

## Comments


## Links

- None detected yet
