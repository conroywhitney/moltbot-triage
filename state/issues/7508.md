---
number: 7508
title: "Discord autoThread: multi-agent race condition causes fallback to parent channel"
author: rohanpatriot
created: 2026-02-02T22:21:53Z
updated: 2026-02-02T22:21:53Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7508
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

When multiple agents have `autoThread: true` on the same Discord channel, a race condition causes all but the first agent to silently fall back to replying in the parent channel instead of the auto-created thread.

## Steps to Reproduce

1. Configure two or more agents (e.g., Theseus + Hermes) with `autoThread: true` on the same guild channel (e.g., `#work`)
2. @mention both agents in a single message in the parent channel
3. Both agents process the message concurrently

## Expected Behavior

All agents should reply inside the same auto-created thread.

## Actual Behavior

- The first agent to process the message creates a thread and replies inside it ✅
- The second agent attempts to create a thread on the same message, which fails (Discord only allows one thread per message)
- The failure is silently caught in `maybeCreateDiscordAutoThread()` and returns `undefined`
- The second agent falls back to replying in the parent channel ❌

## Root Cause

In `dist/discord/monitor/threading.js`, `maybeCreateDiscordAutoThread`:

```js
catch (err) {
    logVerbose(`discord: autoThread failed for ${params.message.channelId}/${params.message.id}: ${String(err)}`);
    return undefined; // Falls back to parent channel delivery
}
```

When thread creation fails, there is no check for whether a thread already exists on that message. The function simply returns `undefined`, which causes the reply to go to the parent channel.

## Suggested Fix

When `autoThread` thread creation fails, check if a thread was already created on the message (e.g., by another agent) and deliver the reply there instead of falling back to the parent channel:

```js
catch (err) {
    // Check if a thread already exists on this message
    try {
        const existingThreads = await client.rest.get(
            Routes.threads(params.message.channelId, params.message.id)
        );
        if (existingThreads?.id) {
            return String(existingThreads.id);
        }
    } catch {}
    logVerbose(`discord: autoThread failed...`);
    return undefined;
}
```

(Pseudocode — actual API call may differ.)

## Environment

- OpenClaw version: 2026.1.30
- Discord channel config: `autoThread: true` on multiple per-account guild channel entries
- Multiple agents bound to the same channel via `channels.discord.accounts`

## Workarounds

- Only enable `autoThread` on one agent per channel
- Tag agents sequentially rather than in the same message
- Start threads manually and @mention agents inside the thread (`autoThread` correctly skips if already in a thread)

## Comments


## Links

- None detected yet
