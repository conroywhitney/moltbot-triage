---
number: 1660
title: "[Bug]: TUI Crash when rendered line exceeds terminal width (233 > 213)"
author: slimewell
created: 2026-01-25T00:05:03Z
updated: 2026-01-28T06:44:35Z
labels: ["bug"]
assignees: []
comments_count: 2
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/1660
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary
When using the TUI (clawdbot tui), the renderer crashed when it encountered a line that would exceed the terminal width (233 chars visible in a 213-char-wide terminal). Instead of truncating the line using truncateToWidth() or visibleWidth(), it threw an uncaught exception:

Uncaught exception: Error: Rendered line 595 exceeds terminal width (233 > 213)

The crash occurred at TUI.doRender in tui.js:740:23.


## Steps to reproduce
1. Open TUI: clawdbot tui
2. use until a point in chat history where a rendered line would exceed terminal width
3. Crash
(I don't have exact reproduction steps because the crash log is the full TUI stdout and contains sensitive conversation content. The crash appears to be triggered by a long line in the assistant response.)

## Expected behavior
When a rendered line exceeds terminal width, TUI should either:

• Use visibleWidth() to measure available space, OR
• Use truncateToWidth() to truncate the line to fit
This should prevent the crash and display a truncated, usable line instead.

## Actual behavior
TUI crashes with an uncaught exception instead of truncating the line.

• Clawdbot version: 2026.1.23-1
• OS: Darwin 25.2.0 (arm64)
• Install method: brew install clawdbot
• Terminal: Ghostty

## Logs or screenshots
(I'm not attaching the pi-crash log because it contains the entire TUI session including personal conversation content. The key error details are included above.) 

```
[clawdbot] Uncaught exception: Error: Rendered line 595 exceeds terminal width (233 > 213).

This is likely caused by a custom TUI component not truncating its output.
Use visibleWidth() to measure and truncateToWidth() to truncate lines.

Debug log written to: /Users/max/.pi/agent/pi-crash.log
    at TUI.doRender (file:///opt/homebrew/lib/node_modules/clawdbot/node_modules/@mariozechner/pi-tui/dist/tui.js:740:23)
    at file:///opt/homebrew/lib/node_modules/clawdbot/node_modules/@mariozechner/pi-tui/dist/tui.js:250:18
    at process.processTicksAndRejections (node:internal/process/task_queues:84:11)```

## Comments

### @mossein (2026-01-25)

I've opened a PR with the fix: #1686.

### @ariel-frischer (2026-01-28)

Im seeing this on tui: type /models then type '3' or 'gemini 3 flash':
[moltbot] Uncaught exception: Error: Rendered line 13 exceeds terminal width (83 > 80)
Then tui crashes.
Perhaps happens more often to me because I'm using vertical split windows on my terminal? (kitty)


## Links

- None detected yet
