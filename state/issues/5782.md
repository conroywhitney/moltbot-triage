---
number: 5782
title: "TUI: Stale model display after config.patch + missing reply text for Telegram-routed messages"
author: LagWizard
created: 2026-01-31T23:48:52Z
updated: 2026-02-02T00:17:47Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5782
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Report

### Environment
- OpenClaw 2026.1.30 (76b5208)
- TUI connected to gateway via WebSocket
- Telegram channel active

### Issue 1: Stale model in TUI footer after config.patch

**Steps to reproduce:**
1. Start TUI, connect to gateway (shows e.g. `anthropic/claude-opus-4-5`)
2. Run `gateway config.patch` to change model to `openai/gpt-5.2`
3. Gateway restarts via SIGUSR1
4. TUI reconnects

**Expected:** Footer updates to show new model (`openai/gpt-5.2`)
**Actual:** Footer still shows old model (`anthropic/claude-opus-4-5`)

**Root cause:** In `tui.js`, the `onConnected` handler calls `refreshAgents()`, `loadHistory()`, and `updateFooter()` — but does NOT call `refreshSessionInfo()`. The footer reads from `sessionInfo.model` which remains stale.

**Fix:** Add `await refreshSessionInfo();` in the `onConnected` handler before `updateFooter()`.

### Issue 2: '(no output)' for Telegram-routed replies

**Steps to reproduce:**
1. Have TUI open watching the main session
2. Send a message via Telegram
3. Agent replies (visible in Telegram)
4. TUI shows the user message but displays `(no output)` for the assistant reply

**Expected:** TUI should show the assistant's reply text
**Actual:** Shows `(no output)` — the `resolveFinalAssistantText` function finds both `finalText` and `streamedText` empty

**Likely cause:** When the reply routes to Telegram, the TUI stream assembler may not receive the content chunks or the finalize message may arrive without the full text content.

### Suggested Fix for Issue 1

In `dist/tui/tui.js`, `onConnected` handler (~line 532):

```js
client.onConnected = () => {
    // ...
    void (async () => {
        await refreshAgents();
+       await refreshSessionInfo();  // <-- Add this
        updateHeader();
        await loadHistory();
        // ...
        updateFooter();
    })();
};
```

## Comments


## Links

- None detected yet
