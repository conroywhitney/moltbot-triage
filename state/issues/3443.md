---
number: 3443
title: "[Bug]: Message ordering conflict error when using custom Moonshot/Kimi provider"
author: justinfinnn
created: 2026-01-28T16:24:50Z
updated: 2026-01-28T16:24:50Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3443
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When switching to Moonshot models (Kimi K2.5), I consistently get "Message ordering conflict - please try again. If this persists, use /new to start a fresh session." The error persists even after:
- Gateway restart
- Session file cleanup
- `/new` command

The issue only occurs with Moonshot models; Anthropic models work fine.

## Config (sanitized)

```json
"models": {
  "providers": {
    "moonshot": {
      "baseUrl": "https://api.moonshot.ai/v1",
      "apiKey": "sk-***REDACTED***",
      "api": "openai-completions",
      "models": [
        {
          "id": "kimi-k2.5",
          "name": "Kimi K2.5",
          "reasoning": true,
          "input": ["text", "image"],
          "contextWindow": 262144,
          "maxTokens": 8192
        }
      ]
    }
  }
}
```

## Environment

- Clawdbot version: 2026.1.24-3
- OS: macOS (Darwin 25.2.0 arm64)
- Node: v22.22.0
- Channel: Discord

## Steps to Reproduce

1. Configure Moonshot provider as shown above
2. Add `moonshot/kimi-k2.5` to `agents.defaults.models` with an alias
3. Switch to the model using `/model kimi`
4. Send any message
5. Receive "Message ordering conflict" error

## Expected Behavior

Model should respond normally like Anthropic models do.

## Additional Context

The gateway log shows the embedded run starting and completing successfully (793ms), but the error message is delivered to the user anyway. The error seems to occur in session state handling rather than the API call itself.

## Comments


## Links

- None detected yet
