---
number: 7185
title: "[Bug]: Agentic loop silently dies on network errors and long-running exec - unhandled failures kill runs mid-task"
author: piddlyminx
created: 2026-02-02T14:25:14Z
updated: 2026-02-02T14:42:21Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7185
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When an error occurs during the agentic loop (network failure on API call, timeout on long exec, etc.), the run silently stops without any error logged to the session, retry attempt, or user notification. The session just goes quiet mid-task.

This affects two main scenarios:
1. **Network errors** during Anthropic/OpenAI API calls after tool results
2. **Long-running exec commands** (e.g., `sleep 60`, container startup waits, long builds)

## Evidence: Network Error Failure

**Gateway log at failure time:**
```
2026-02-02T10:37:41.949Z - toolResult logged successfully (mv test_audio.wav)
2026-02-02T10:37:42.729Z - [clawdbot] Unhandled promise rejection: TypeError: fetch failed
    at node:internal/deps/undici/undici:13510:13
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
```

**Session transcript shows:**
- Last entry: `toolResult` at `10:37:41.949Z`
- Next entry: user message 3+ hours later asking why it stopped
- No error, no notification, no "run done" log for that run

**Session state at failure:**
- ~108k tokens (54% of 200k context)
- `stopReason: toolUse` on last assistant message
- Model: claude-opus-4-5

## Evidence: Long-running Exec Failure

**Pattern:**
1. Agent issues `exec` with a blocking command (sleep, long build, container wait)
2. Something times out or fails during the wait
3. Run silently dies - no error logged, no notification
4. User discovers hours later that nothing happened

**Current workaround** (documented in user AGENTS.md):
> Never use blocking `sleep` in exec calls to wait for slow operations (container startup, builds, etc.). This pattern is fragile â€” sessions can stall mid-wait.

But this is a workaround for a bug, not expected behavior.

## Expected Behavior

1. Errors during API calls should be caught and retried with exponential backoff
2. Long-running exec should have configurable timeouts with proper error handling
3. If retries/timeouts exhausted, log error to session transcript
4. Notify user that the run failed (message to channel)
5. Set `abortedLastRun: true` or similar flag

## Actual Behavior

- Unhandled promise rejection / silent timeout
- Run disappears silently
- No session transcript entry
- No user notification
- User discovers hours later that nothing happened

## Impact

This makes "always-on" autonomous agents unreliable. Any task that:
- Runs during minor network instability
- Involves waiting for slow operations
- Has multiple tool calls over extended periods

...can silently fail, leaving the user unaware until they manually check.

## Additional Context

The same `fetch failed` error appeared multiple times in the logs on the same day:
- 10:12:20
- 10:37:42 (the failure that killed this session)
- 11:06:27
- 11:30:15

This suggests periodic network instability is common, and the gateway should handle these gracefully rather than silently dropping runs.

## Environment

- Clawdbot version: 2026.1.24-3
- OS: Linux (WSL2)
- Node: v22.17.1
- Model: anthropic/claude-opus-4-5
- Auth: oauth (claude-cli)

## Comments


## Links

- None detected yet
