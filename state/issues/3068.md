---
number: 3068
title: "AbortError during hot-reload when changing memory search provider"
author: jswagbo
created: 2026-01-28T01:49:38Z
updated: 2026-01-28T05:55:14Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/3068
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

Gateway restart via `config.patch` causes `AbortError` and multi-minute service interruption when switching memory search embedding providers.

## Steps to Reproduce

1. Start gateway with memory search configured (e.g., OpenAI provider)
2. Use `gateway.config.patch` to change `agents.defaults.memorySearch.provider` from `openai` to `local`
3. Config patch triggers SIGUSR1 hot-reload

## Expected Behavior

- Clean hot-reload
- Memory search re-initializes with new provider
- Minimal service interruption (<2 seconds)

## Actual Behavior

- `AbortError: This operation was aborted` in gateway.err.log
- ~4-5 minute service interruption
- Messages queued instead of processed
- Eventually recovers but leaves lingering unhandled rejection

## Error Logs

```
2026-01-28T01:36:41.014Z [clawdbot] Unhandled promise rejection: AbortError: This operation was aborted
```

Timestamp correlates with config.patch restart (17:36:39 PST).

## Environment

- **Version:** 2026.1.24-3
- **OS:** macOS 26.2 (arm64)
- **Node:** v25.4.0
- **Gateway mode:** local
- **Change:** `memorySearch.provider` openai â†’ local (nomic-embed-text-v1.5)

## Workaround

Use full restart instead of hot-reload for provider changes:
```bash
clawdbot gateway restart
```

## Root Cause Hypothesis

Memory search initialization during hot-reload may not handle abort signals gracefully when:
- Switching embedding providers
- Downloading/initializing new local models
- Tearing down old provider connections

## Suggested Fix

- Catch AbortError during memory search init
- Implement graceful degradation if initialization is interrupted
- Consider treating provider changes as requiring full restart vs hot-reload
- Add restart strategy hint to config.patch response when high-risk changes detected

## Impact

- Low frequency (only during config changes)
- High severity when it occurs (multi-minute outage)
- Workaround available (full restart)
- Could affect users experimenting with memory search providers

## Comments


## Links

- None detected yet
