---
number: 6584
title: "[Bug]: Windows: session-memory fails with ESM loader error \"Received protocol 'c:'\""
author: ElScelt
created: 2026-02-01T20:47:36Z
updated: 2026-02-01T20:47:36Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/6584
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

What went wrong?
Windows PowerShell: /new command fails with ESM loader error - session-memory can't save because Windows paths aren't converted to file:// URLs

## Steps to reproduce

Install OpenClaw on Windows via npm install -g openclaw@latest
Run openclaw gateway in native PowerShell (not WSL)
Open dashboard with openclaw dashboard 
Send the /new command in chat to create a new session
Check gateway terminal logs - ESM loader error appears


## Expected behavior

What did you expect to happen?
The /new command should create a new session and save session memory without errors. Session state should persist correctly.

## Actual behavior
Session memory fails to save with error:
[session-memory] Failed to save session memory: Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'
The command partially executes but doesn't complete properly. Session functionality is impaired.

## Environment

Clawdbot version: 2026.1.30 (76b5208)
OS: Windows 11 (native PowerShell, not WSL)
Install method: npm global install (npm install -g openclaw@latest)
Node.js version: 24.11.1

## Logs or screenshots
[session-memory] Hook triggered for /new command
[session-memory] Current sessionId: a7fd9b18-6b63-49b6-89c5-9650f0cc7d40
[session-memory] Current sessionFile: C:\Users\edgar\.openclaw\agents\main\sessions\a7fd9b18-6b63-49b6-89c5-9650f0cc7d40.jsonl
[session-memory] cfg present: true
[session-memory] sessionContent length: 1938
[session-memory] Calling generateSlugViaLLM...
[session-memory] Failed to save session memory: Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'

Root cause: Windows paths like C:\Users\... need to be converted to file:///C:/Users/... for Node.js ESM loader.
Suggested fix: Use pathToFileURL() from node:url module before passing paths to import().
Workaround: Use WSL instead of native Windows PowerShell - works perfectly there.

## Comments


## Links

- None detected yet
