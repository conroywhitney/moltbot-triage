---
number: 3547
title: "[Bug]: iMessage attachments not included in agent message context"
author: Noah-Ribaudo
created: 2026-01-28T19:56:54Z
updated: 2026-01-31T02:37:32Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/3547
duplicate_of: null
related_issues: [1504,3009]
blocks: []
blocked_by: []
---

## Description

## Summary
When an iMessage with an attachment arrives, the agent only sees the placeholder character (￼) in the message text. The attachment metadata (file path, MIME type, size) is not passed to the agent context.

## Current Behavior
1. User sends iMessage with attachment (e.g., audio file)
2. Agent receives message text with ￼ placeholder
3. Agent has no way to know an attachment exists without manually querying `imsg history --json`
4. Workaround: Query `imsg history --chat-id <id> --limit 5 --json` to find attachments array

## Expected Behavior
The agent should receive attachment metadata as part of the message context, similar to how other channels handle media. For example:
```json
{
  "text": "Can you cut this and send back the first half?",
  "attachments": [
    {
      "path": "/Users/.../Library/Messages/Attachments/.../file.mp3",
      "mime_type": "audio/mpeg",
      "filename": "file.mp3",
      "size": 79639
    }
  ]
}
```

## Evidence
From `imsg history --json`, the attachment data IS available:
```json
{
  "attachments": [{
    "filename": "~/Library/Messages/Attachments/.../noob-tube.mp3",
    "total_bytes": 79639,
    "mime_type": "audio/mpeg",
    "missing": false
  }],
  "text": "￼Can you cut this..."
}
```

The imsg CLI captures it correctly, but the Clawdbot iMessage channel plugin doesn't pass it through to the agent.

## Environment
- Clawdbot version: 2026.1.24-3
- imsg version: 0.4.0
- macOS

## Related Issues
- #1504 (Auto-transcribe voice memos) - this would also benefit from attachment metadata being available
- #3009 (Media attachments not downloaded) - similar issue for Matrix/Discord

## Comments


## Links

- None detected yet
