---
number: 2996
title: "[Security] Insecure Deserialization - JSON.parse Without Validation"
author: engrahsaninam
created: 2026-01-27T22:10:47Z
updated: 2026-01-28T05:56:16Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/2996
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Severity: High

## Description
JSON.parse is used on file contents without schema validation, which could cause issues if files are tampered with.

## Location
- `src/tts/tts.ts` (line 359)

```typescript
return JSON.parse(readFileSync(prefsPath, "utf8")) as TtsUserPrefs;
```

## Risk
Malicious or malformed JSON could cause unexpected behavior or exploitation.

## Recommendation
- Validate parsed JSON structure against a schema before use
- Use a validation library like Zod or Joi
- Handle parsing errors gracefully

## Comments


## Links

- None detected yet
