---
number: 7039
title: "Node.js DEP0040 punycode deprecation warning on shell startup"
author: mwfj
created: 2026-02-02T09:57:20Z
updated: 2026-02-02T09:57:20Z
labels: []
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/7039
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When using `openclaw completion --shell zsh` (or bash) in shell startup files, a deprecation warning is printed:

```
(node:252648) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
```

This appears every time a new terminal is opened, which is noisy for users.

## Root Cause

The warning originates from the dependency chain:

```
openclaw
└── grammy@1.39.3
    └── node-fetch@2.7.0
        └── whatwg-url@5.0.0
            └── tr46@0.0.3
                └── require("punycode")  ← deprecated built-in
```

`whatwg-url@5` and `tr46@0.0.3` use `require("punycode")` which imports Node's deprecated built-in module instead of the userland `punycode` package.

## Suggested Fixes

1. **Use native fetch** — Node 18+ includes native `fetch()`. If `grammy` or openclaw can use native fetch instead of `node-fetch@2`, this removes the problematic dependency entirely.

2. **Override with npm `overrides`** — Force newer versions of `whatwg-url` (v7+) which use the userland punycode package:
   ```json
   "overrides": {
     "whatwg-url": "^14.0.0",
     "tr46": "^5.0.0"
   }
   ```
   (This may require testing for compatibility)

3. **Wait for grammy/node-fetch update** — `node-fetch@3` dropped `whatwg-url` dependency, but it's ESM-only which may complicate things.

## Environment

- Node.js: v22.22.0
- OpenClaw: 2026.1.30
- OS: Ubuntu Linux

## Workaround

Users can suppress stderr in their shell config:

```bash
# .zshrc / .bashrc
source <(openclaw completion --shell zsh 2>/dev/null)
```

This hides the warning but doesn't fix the underlying issue.

## Comments


## Links

- None detected yet
