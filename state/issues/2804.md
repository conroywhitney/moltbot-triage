---
number: 2804
title: "System events (connection, message edits) trigger rapid heartbeat re-runs"
author: McNabsys
created: 2026-01-27T14:54:10Z
updated: 2026-01-28T15:41:32Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 1
url: https://github.com/moltbot/moltbot/issues/2804
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

System events like WhatsApp connection notifications and Slack message edits appear to trigger rapid heartbeat runs, even when the configured heartbeat interval is `1h`.

## Environment
- Clawdbot version: 2026.1.24-3
- OS: Linux (GCP VM)
- Channels: Slack, WhatsApp, Telegram

## Expected Behavior
Heartbeats should fire only on their configured timer interval (e.g., every 1 hour).

## Actual Behavior
System events get bundled into the heartbeat prompt and appear to trigger additional agent turns. Looking at session logs, I see patterns like:

```
13:26:58 → 14:26:58  ✅ Exactly 1 hour (correct)
14:26:58 → 14:41:07  ❌ 14 minutes later  
14:41:07 → 14:41:21  ❌ 14 seconds later
14:41:21 → 14:41:53  ❌ 32 seconds later
```

The bundled messages look like:
```
System: [2026-01-27 09:41:55 EST] Slack message edited in #D0AARLFF5LM.

Read HEARTBEAT.md if it exists (workspace context)...
```

## Impact
- Burned through Gemini API quota (1M tokens/min rate limit hit)
- Unexpected token costs
- Session context grows rapidly

## Questions
1. Is this expected behavior? Should system events trigger agent turns with heartbeat prompts attached?
2. Should there be config options to suppress specific system events (connection notifications, edit events)?
3. Should system events queue separately from heartbeats?

## Workaround
Switched heartbeat model from Gemini to Sonnet to avoid rate limits, but the underlying rapid triggering continues.

## Config (relevant)
```json
{
  "agents": {
    "defaults": {
      "heartbeat": { "every": "1h", "model": "anthropic/claude-sonnet-4-5" }
    }
  }
}
```

Thanks for looking into this!

## Comments

### @matt-bedda (2026-01-28)

+1 — experiencing the same issue.

**Environment:**
- Clawdbot 2026.1.24-3
- Linux (Ubuntu 24.04)
- WhatsApp channel

**Our trigger:** System messages like `Exec completed (session-id, code 0)` and WhatsApp gateway connection notifications are triggering heartbeat re-runs despite `heartbeat.every: 60m`.

**Example from today:**
- Active conversation with user
- Background exec completes, system message injected
- Heartbeat prompt immediately fires (should have been ~45 min away)
- Agent responds to heartbeat mid-conversation

**Config:**
```json
{
  "heartbeat": {
    "every": "60m",
    "activeHours": { "start": "08:00", "end": "23:00" },
    "model": "anthropic/claude-sonnet-4-5"
  }
}
```

Already using Sonnet for heartbeats so cost impact is manageable, but the UX of heartbeats interrupting active conversations is disruptive.

Would love to see system events handled separately from the heartbeat timer.


## Links

- None detected yet
