---
number: 5222
title: "Bug: `openclaw configure --section web` doesn't properly configure Perplexity provider"
author: JovianY
created: 2026-01-31T06:50:25Z
updated: 2026-02-02T00:19:56Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5222
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

When using `openclaw configure --section web` with a Perplexity API key (`pplx-...`), the wizard only sets the `apiKey` field but doesn't configure the required `provider` and `perplexity.model` settings, causing web_search to fail.

## Steps to Reproduce

1. Run `openclaw configure --section web`
2. Select "Yes" for Enable web_search
3. Enter a Perplexity API key (format: `pplx-xxxxx`)
4. Complete the wizard
5. Restart gateway
6. Try to use `web_search`

## Expected Behavior

When a `pplx-` prefixed API key is detected, the wizard should automatically:
1. Set `provider: "perplexity"`
2. Set `perplexity.baseUrl: "https://api.perplexity.ai"`
3. Set `perplexity.model: "sonar-pro"` (or prompt user to choose)

## Actual Behavior

The wizard only sets:
```json
{
  "tools": {
    "web": {
      "search": {
        "enabled": true,
        "apiKey": "pplx-xxxxx"
      }
    }
  }
}
```

This causes two errors:
1. First, the system still tries to use Brave Search (missing `provider` setting)
2. After manually adding `provider: "perplexity"`, it fails with "Invalid model 'perplexity/sonar-pro'"

## Workaround

Manually patch the config with:
```json
{
  "tools": {
    "web": {
      "search": {
        "enabled": true,
        "provider": "perplexity",
        "perplexity": {
          "apiKey": "pplx-xxxxx",
          "baseUrl": "https://api.perplexity.ai",
          "model": "sonar-pro"
        }
      }
    }
  }
}
```

## Additional Notes

- The documentation at `/docs/tools/web.md` shows the model as `perplexity/sonar-pro`, but Perplexity API actually expects just `sonar-pro`
- Consider auto-detecting the API key prefix (`pplx-` vs `BSA...` for Brave) to set appropriate defaults

## Environment

- OpenClaw Version: 2026.1.29
- OS: Linux
- Node: v24.13.0

## Comments


## Links

- None detected yet
