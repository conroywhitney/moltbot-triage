---
number: 3086
title: "Windows ACL permissions falsely flagged as mode=666 in security audit"
author: shihhao71
created: 2026-01-28T02:18:24Z
updated: 2026-01-29T10:05:31Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/3086
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

**Summary**
On Windows, `clawdbot security audit` reports critical permissions (mode=666) for state/config/credentials/auth-profiles even when ACLs are correctly locked down to SYSTEM/Administrators/user only. This appears to be a false positive from Unix-style mode checks.

**Observed**
`clawdbot security audit --deep`:
- State dir is world-writable (mode=666)
- Config file writable by others (mode=666)
- Credentials dir writable by others (mode=666)
- auth-profiles.json writable by others (mode=666)

**Expected**
On Windows, audit should use ACLs (or a Windows-appropriate check) and not report world-writable when only SYSTEM/Administrators/current user have Full Control.

**Repro**
1. On Windows, lock down ACLs to SYSTEM/Administrators/current user only (no Users/Everyone).
2. Run `clawdbot security audit --deep`.
3. Still reports mode=666.

**Evidence (icacls)**
icacls C:\Users\dpc01.clawdbot
C:\Users\dpc01.clawdbot NT AUTHORITY\SYSTEM:(I)(OI)(CI)(F)
BUILTIN\Administrators:(I)(OI)(CI)(F)
DESKTOP-OE383I3\dpc01:(I)(OI)(CI)(F)

icacls C:\Users\dpc01.clawdbot\clawdbot.json
C:\Users\dpc01.clawdbot\clawdbot.json NT AUTHORITY\SYSTEM:(I)(F)
BUILTIN\Administrators:(I)(F)
DESKTOP-OE383I3\dpc01:(I)(F)
**Environment**
- Clawdbot 2026.1.24-3 (npm install)
- Windows 10.0.26100 x64
- Node 24.11.0

## Comments

### @f0ksiak (2026-01-29)

Same issue here on Windows 10.0.26100 (x64), Node v22.16.0.

Confirmed that NTFS ACLs are correctly set (verified with \icacls\), but the audit still reports \mode=666\. 

The root cause is that Node.js \s.stat()\ returns synthetic Unix-style mode bits on Windows that don't reflect actual NTFS ACL permissions.

**Workaround for now:** Ignore these CRITICAL warnings on Windows after manually verifying ACLs with \icacls\.

+1 for implementing proper Windows ACL checks (perhaps using PowerShell \Get-Acl\ or parsing \icacls\ output).


## Links

- None detected yet
