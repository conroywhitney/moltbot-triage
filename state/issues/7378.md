---
number: 7378
title: "[Bug]: model selection in TUI does not allow search for models starting with k"
author: green-slowmoe
created: 2026-02-02T19:21:18Z
updated: 2026-02-02T19:36:48Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7378
duplicate_of: null
related_issues: [4818]
blocks: []
blocked_by: []
---

## Description

## Summary

The TUI has vim-style navigation (j/k keys for up/down) hardcoded in several components. This interferes with natural typing in search boxes, as typing 'k' or 'j' as the first character triggers navigation instead of being entered as filter text.

## Steps to reproduce

1. Run `openclaw chat` to start the TUI
2. Type `/models` to open the model picker (or `/sessions` for session picker)
3. Type `k` as the first character in the search box
4. Observe that the selection moves up instead of 'k' appearing in the search field
5. Clear the search and type `j` as first character
6. Observe that the selection moves down instead of 'j' appearing in the search field

## Expected behavior

Users should be able to type naturally in search boxes. When a search/filter input is focused, all typed characters (including 'j' and 'k') should be entered as filter text. Navigation should use arrow keys, Ctrl+P/Ctrl+N, or other dedicated navigation shortcuts.

## Actual behavior

When the filter text is empty, typing 'k' moves the selection up and typing 'j' moves the selection down. These characters are intercepted as vim navigation commands and never appear in the search box. This prevents users from searching for models, sessions, or other items that start with 'j' or 'k'.

The vim navigation is hardcoded in:
- `FilterableSelectList` (used by session selector) at lines 82-97
- `SearchableSelectList` (used by model selector) at lines 246-267

## Environment

- Clawdbot version: 2026.2.1
- OS: Linux
- Install method: pnpm

## Logs or screenshots

N/A - UI behavior issue

## Additional context

The vim navigation logic uses `allowVimNav = !this.filterText.trim()` which means j/k work as navigation only when the search box is empty. This creates an inconsistent user experience where the same keys behave differently depending on whether text has been entered.

also, pressing 'm' crashes the TUI out with the bug in #4818 

## Comments

### @green-slowmoe (2026-02-02)

kimi was very upset I could not find it, so it came up with this fix for me:

```diff
diff --git a/src/tui/components/searchable-select-list.ts b/src/tui/components/searchable-select-list.ts
index 1234567..abcdefg 100644
--- a/src/tui/components/searchable-select-list.ts
+++ b/src/tui/components/searchable-select-list.ts
@@ -211,21 +211,25 @@ export class SearchableSelectList implements Component {
   private renderItemLine(
     item: SelectItem,
     isSelected: boolean,
     width: number,
     query: string,
   ): string {
     const prefix = isSelected ? "â†’ " : "  ";
     const prefixWidth = prefix.length;
     const displayValue = this.getItemLabel(item);
 
     if (item.description && width > 40) {
-      const maxValueWidth = Math.min(30, width - prefixWidth - 4);
+      // Leave extra room for ANSI codes from highlighting and selection styling
+      const ansiSafetyMargin = isSelected ? 40 : 20;
+      const maxValueWidth = Math.min(30, width - prefixWidth - 4 - ansiSafetyMargin);
       const truncatedValue = truncateToWidth(displayValue, maxValueWidth, "");
       const valueText = this.highlightMatch(truncatedValue, query);
-      const spacingWidth = Math.max(1, 32 - visibleWidth(valueText));
+      const spacingWidth = Math.max(
+        1,
+        Math.min(32, width - prefixWidth - visibleWidth(valueText) - 4),
+      );
       const spacing = " ".repeat(spacingWidth);
       const descriptionStart = prefixWidth + visibleWidth(valueText) + spacing.length;
-      const remainingWidth = width - descriptionStart - 2;
+      const remainingWidth = Math.max(0, width - descriptionStart - 2 - ansiSafetyMargin);
       if (remainingWidth > 10) {
         const truncatedDesc = truncateToWidth(item.description, remainingWidth, "");
         // Highlight plain text first, then apply theme styling to avoid corrupting ANSI codes
         const highlightedDesc = this.highlightMatch(truncatedDesc, query);
         const descText = isSelected ? highlightedDesc : this.theme.description(highlightedDesc);
         const line = `${prefix}${valueText}${spacing}${descText}`;
         return isSelected ? this.theme.selectedText(line) : line;
       }
     }
 
-    const maxWidth = width - prefixWidth - 2;
+    // Leave extra room for ANSI codes from highlighting and selection styling
+    const ansiSafetyMargin = isSelected ? 40 : 20;
+    const maxWidth = Math.max(1, width - prefixWidth - 2 - ansiSafetyMargin);
     const truncatedValue = truncateToWidth(displayValue, maxWidth, "");
     const valueText = this.highlightMatch(truncatedValue, query);
     const line = `${prefix}${valueText}`;
     return isSelected ? this.theme.selectedText(line) : line;
   }
 
   handleInput(keyData: string): void {
     if (isKeyRelease(keyData)) {
       return;
     }
 
-    const allowVimNav = !this.searchInput.getValue().trim();
-
-    // Navigation keys
-    if (
-      matchesKey(keyData, "up") ||
-      matchesKey(keyData, "ctrl+p") ||
-      (allowVimNav && keyData === "k")
-    ) {
+    // Navigation keys - note: vim nav (j/k) is disabled in searchable lists
+    // because they conflict with typing those letters in the search box
+    if (matchesKey(keyData, "up") || matchesKey(keyData, "ctrl+p")) {
       this.selectedIndex = Math.max(0, this.selectedIndex - 1);
       this.notifySelectionChange();
       return;
     }
 
-    if (
-      matchesKey(keyData, "down") ||
-      matchesKey(keyData, "ctrl+n") ||
-      (allowVimNav && keyData === "j")
-    ) {
+    if (matchesKey(keyData, "down") || matchesKey(keyData, "ctrl+n")) {
       this.selectedIndex = Math.min(this.filteredItems.length - 1, this.selectedIndex + 1);
       this.notifySelectionChange();
       return;
     }
 
     if (matchesKey(keyData, "enter")) {
```



## Links

- None detected yet
