---
number: 5963
title: "Bug Report: Agent exec environment loses PATH after host reboot on Windows 11"
author: FURUYAN1234
created: 2026-02-01T04:35:16Z
updated: 2026-02-02T00:17:08Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5963
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug Report: Agent `exec` environment loses PATH after host reboot on Windows 11

**Describe the bug**
The agent's `exec` tool environment fails to inherit the system or user `PATH` environment variables after the host machine (Windows 11) is rebooted. This renders the agent unable to execute any external commands by name (e.g., `cmd.exe`, `npm`, `clawbot`), resulting in a `CommandNotFoundException`. The Clawdbot Gateway itself runs correctly, and the agent can send/receive messages, but the command execution sandbox is broken.

**To Reproduce**
The issue appears to be specific to the environment and started after a full system reboot. Clawdbot is launched at startup via the Windows Task Scheduler.

**Expected behavior**
The agent's `exec` environment should inherit the `PATH` variable, allowing it to find and execute basic system commands and other installed executables.

**Screenshots**
Here is a screenshot of the gateway log, showing the `exec` tool failing to find `cmd.exe`. This is the core evidence of the bug.
![Gateway Log](https://i.imgur.com/your-image-link.jpg)  *(FURU-sama, I will need to upload the image you sent me to get a link here)*

**Troubleshooting Steps Performed (All Unsuccessful)**
We have undertaken extensive troubleshooting, confirming that this is not a simple configuration error:
1.  **Verified User and System `Path`:** The user confirmed via screenshots that `C:\Windows\System32`, `C:\Program Files\nodejs\`, and the npm global path are all correctly set in the Windows Environment Variables settings.
2.  **Task Scheduler Privileges:** The user confirmed the `Clawdbot Gateway` scheduled task is set to "Run with highest privileges". This did not resolve the issue for the agent's environment.
3.  **PowerShell Execution Policy:** Confirmed to be `RemoteSigned`, which is not restrictive.
4.  **AppLocker Policy:** Confirmed to be disabled.
5.  **Full Path Execution:** Attempts to execute commands using their full, absolute paths also failed intermittently, suggesting a deeper issue with execution permissions or how the process is spawned, not just a missing `PATH`.
6.  **32/64-bit Hypothesis:** We tested using the `sysnative` path to rule out a 32-bit process trying to access the 64-bit `System32` directory. This also failed, confirming the agent process is running as 64-bit, but still without access.

**Conclusion**
The Clawdbot Gateway, when started by the Windows Task Scheduler on this system, fails to pass the necessary environment variables (specifically `PATH`) and/or execution permissions to its child agent processes. This appears to be a bug in how Clawdbot initializes its sandboxed execution environment on certain Windows configurations.

**System Information:**
- **OS:** Windows 11 (Version inferred from UI)
- **Clawdbot Version:** 2026.1.24-3 (885167d) - from user screenshot
- **Node.js Version:** 22.17.1 - from user screenshot

## Comments


## Links

- None detected yet
