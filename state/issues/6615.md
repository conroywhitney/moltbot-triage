---
number: 6615
title: "Feature: Add denylist support for exec-approvals"
author: aaroneden
created: 2026-02-01T21:42:36Z
updated: 2026-02-02T00:16:30Z
labels: ["enhancement"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6615
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary

Add **denylist** support to exec-approvals, complementing the existing allowlist. This enables "allow everything except X" policies.

## Use Case

I want to:
- Allow all commands to run without prompts
- **Except** block/prompt for specific dangerous commands like:
  - `gog gmail send` (sending emails)
  - `gog gmail delete` (deleting emails)  
  - `beeper-send.sh` (sending messages)

Currently, exec-approvals only supports:
- `security: "deny"` - block all
- `security: "allowlist"` - allow only listed commands
- `security: "full"` - allow everything

There's no way to say "allow everything except these specific patterns."

## Proposed Solution

Add a `denylist` array to exec-approvals config:

```json
{
  "defaults": {
    "security": "denylist",
    "ask": "on-match",
    "denylist": [
      {
        "id": "DENY-EMAIL-SEND",
        "pattern": "/opt/homebrew/bin/gog",
        "argsMatch": "gmail send",
        "reason": "Sending emails requires approval"
      },
      {
        "id": "DENY-EMAIL-DELETE",
        "pattern": "/opt/homebrew/bin/gog", 
        "argsMatch": "gmail delete",
        "reason": "Use 'gmail archive' instead"
      },
      {
        "id": "DENY-BEEPER-SEND",
        "pattern": "*/beeper-send.sh",
        "reason": "Sending messages requires approval"
      }
    ]
  }
}
```

### Key additions:
- `security: "denylist"` mode - allow everything except matches
- `argsMatch` field - match against command arguments, not just binary path
- `ask: "on-match"` - prompt when denylist matches (vs blocking outright)

## Current Workarounds

1. Use `security: "full"` and hope agent guardrails work (unreliable)
2. Use `security: "allowlist"` with a massive list of safe commands (tedious)
3. Create wrapper scripts (fragile)

## Environment

- OpenClaw 2026.1.30
- macOS

## Comments


## Links

- None detected yet
