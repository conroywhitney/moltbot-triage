---
number: 3862
title: "Pre/post-compaction hooks for sessions"
author: mkoslacz
created: 2026-01-29T08:09:44Z
updated: 2026-01-29T08:09:44Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/3862
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem
When context compaction happens, the agent loses conversation context and may respond without awareness of recent messages.

## Current workaround
Agent has instructions to run `check-new-messages.sh` after detecting compaction, but:
1. No automatic trigger - relies on agent recognizing it's post-compaction
2. No pre-compaction notification to user

## Proposed solution
1. **Pre-compaction hook**: Send a configurable message before compaction (e.g. 'ðŸ”„ Context compaction - back shortly')
2. **Post-compaction hook**: Inject a system message or trigger that helps agent realize it needs to recover context

## Use case
User @mateusz-koslacz has this in AGENTS.md but agent doesn't always follow it reliably.

## Comments


## Links

- None detected yet
