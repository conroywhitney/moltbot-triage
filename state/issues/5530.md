---
number: 5530
title: "iMessage: leading blank lines in streamed messages"
author: micahbrich
created: 2026-01-31T16:08:26Z
updated: 2026-02-02T00:18:52Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5530
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug

Messages sent via iMessage sometimes arrive with leading blank lines at the top.

## Root Cause

In the block streaming path, `emitBlockChunk` (pi-embedded-subscribe.js) strips thinking tags and calls `.trimEnd()` but not `.trim()`. When Claude's response starts after a stripped thinking block, leading `\n\n` survives through the entire pipeline:

- `sanitizeUserFacingText` doesn't trim
- `normalizeStreamingText` checks `.trim()` for skip logic but returns untrimmed text
- `deliverReplies` (iMessage monitor) never trims
- `sendMessageIMessage` passes text straight through

## Suggested Fix

Simplest targeted fix â€” in `sendMessageIMessage` (imessage/send.js), add `.trim()` after markdown table conversion:

```js
message = convertMarkdownTables(message, tableMode);
message = message.trim(); // <-- add this
```

Alternatively, changing `.trimEnd()` to `.trim()` in `emitBlockChunk` would fix it for all channels.

## Environment

- Clawdbot npm latest 2026.1.24-3
- iMessage channel via imsg-plus
- macOS 15.6 (arm64)

## Comments


## Links

- None detected yet
