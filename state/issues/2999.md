---
number: 2999
title: "[Security] Environment Variable Injection Risk"
author: engrahsaninam
created: 2026-01-27T22:11:05Z
updated: 2026-01-28T05:56:08Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/moltbot/moltbot/issues/2999
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Severity: Medium

## Description
Environment variables are sanitized via `sanitizeEnv()`, but the implementation should be reviewed to ensure it prevents injection of dangerous environment variables.

## Location
- `src/node-host/runner.ts` (line 825)

```typescript
const env = sanitizeEnv(params.env ?? undefined);
```

## Risk
Malicious environment variables could modify behavior of child processes (e.g., `LD_PRELOAD`, `PATH` manipulation).

## Recommendation
- Review `sanitizeEnv()` implementation for completeness
- Maintain a denylist of dangerous environment variables
- Consider an allowlist approach for sensitive operations

## Comments


## Links

- None detected yet
