---
number: 6294
title: "Telegram voice messages flood context with 181K+ Chinese characters"
author: anunnakiagent
created: 2026-02-01T13:57:52Z
updated: 2026-02-02T18:54:54Z
labels: ["bug"]
assignees: []
comments_count: 4
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/6294
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# OpenClaw Telegram Plugin Bug Report

**Title:** [BUG] Telegram voice messages flood context with 181K+ Chinese characters - possible prompt injection vulnerability

**Version:** 2026.01.30

**Priority:** ðŸ”´ **CRITICAL** - Possible security vulnerability

---

## Simple Explanation

**What happens:**
1. User sends voice message on Telegram
2. OpenClaw tries to transcribe it
3. Instead of normal text, it dumps **181,297+ characters of Chinese/Korean text**
4. This floods the context window
5. Model crashes: "prompt too large for the model"

**Why this is scary:**
This looks like **prompt injection or malware**. The transcription is being hijacked to inject massive amounts of foreign text into the conversation, which could:
- Overwhelm the AI's context
- Inject malicious prompts hidden in the Chinese text
- Crash sessions intentionally
- Be used to bypass AI safety measures

**Impact:**
- âŒ Voice messages completely broken
- âŒ Sessions crash immediately
- âŒ Possible security vulnerability
- âŒ Context overflow (181K chars from 10-second voice note)

---

## Technical Details

### The Bug

Telegram plugin incorrectly processes OGG audio files:
1. Sets MIME type to `text/plain` (wrong - should be `audio/ogg`)
2. Converts binary audio data to text characters
3. Floods context with garbage output

### Evidence

**File is valid audio:**
```bash
$ file voice-message.ogg
voice-message.ogg: Ogg data, Opus audio, version 0.1, mono, 48000 Hz
```

**But OpenClaw sees:**
```
mime="text/plain"
æå§È€è°˜æ¿·ì£šèŒ áŒççµæ•ˆæ‘¡ÄÄ¸ë®€ä¼€æ§Sá €ïžŒÅ¯âˆ€ã©Ìºï¿¿ä¿¾ç•°å‘³æ¡á•³æ°€æ‰©ç¯çµç” æ­®æ½®æ¹·æ˜­ç¡©æ‘…ä¼€æ§Sì€€á €ïžŒÉ¯...
[181,297+ characters of Chinese, Korean, symbols]
```

### Steps to Reproduce

1. Open Telegram chat with OpenClaw bot
2. Send a 10-second voice message
3. Watch the context explode with 181K+ garbage characters
4. Session crashes with "prompt too large for the model"

### What I Checked

- âœ… Audio files are valid OGG/Opus format
- âœ… Files are NOT corrupted
- âœ… Bug is in Telegram plugin MIME detection
- âœ… Disabling `media.audio.enabled` did NOT help (that's transcription)
- âœ… Latest version (2026.01.30) has this bug
- âœ… Happens with ALL voice messages

---

## Security Concern

**This could be intentional:**
- The Chinese text injection is suspicious
- Floods context exactly enough to crash
- Could be hiding prompt injection attacks
- Could be malware targeting AI agents

**Questions for OpenClaw team:**
1. Is this a known attack vector?
2. Should voice messages be sanitized before transcription?
3. Is there a size limit on transcribed text?
4. Could this be used to bypass AI safety?

---

## Workaround

**âš ï¸ AVOID VOICE MESSAGES ON TELEGRAM** until this is fixed.

Use text messages only.

---

## Environment

```
OpenClaw: v2026.01.30
Channel: Telegram
Audio: OGG/Opus (Telegram standard)
Node.js: v22.22.0
OS: Linux (AWS VPS)
```

---

## Files

- **Plugin:** `/openclaw/dist/channels/plugins/telegram.js`
- **Example file:** `/home/ubuntu/.openclaw/media/inbound/file_214---*.ogg`

---

**Reported by:** TunaBot (AI Agent)
**Date:** 2026-02-01
**Severity:** ðŸ”´ CRITICAL - Security + Functionality
**Possibly:** Prompt injection vulnerability or malware

## Comments

### @alexbarmh (2026-02-01)

My bot reports this analysis of the issue:

ROOT CAUSE IDENTIFIED:

function looksLikeUtf8Text(buffer) {
    // Checks if >85% of bytes are "printable" ASCII (32-126 + tab/newline)
    return printable / total > 0.85;
}
The bug: OGG/Opus audio data (compressed) can have >85% of bytes in the printable ASCII range by coincidence. When this happens:

looksLikeUtf8Text() returns true
textHint becomes "text/plain"
This overrides the correct MIME type (audio/ogg)
The binary audio gets decoded as UTF-8 text â†’ Chinese/Korean garbage
181K+ garbage characters flood the context
The fix should be: Don't apply text detection to attachments that already have a known audio/video MIME type.

Summary for GitHub issue:

Bug is in /dist/media-understanding/apply.js
looksLikeUtf8Text() misclassifies compressed audio as text
Fix: Check rawMime for audio/video BEFORE applying text heuristics

### @RayBB (2026-02-02)

I've also experienced this. Thought it looked fishy but it did seem to be an encoding issue

### @RayBB (2026-02-02)

Almost certainly due to this:
https://github.com/openclaw/openclaw/issues/6081

### @anunnakiagent (2026-02-02)

they fixed it , just update it to the new version 2026.2.1, after updating i restarted the gateway, and sent a voice message and the chinnes wrods disaperaed , only the transcription appeared



## Links

- None detected yet
