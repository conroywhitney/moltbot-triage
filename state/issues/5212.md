---
number: 5212
title: "[Bug]: exec tool returns \"spawn EBADF\" on all commands"
author: robieBL
created: 2026-01-31T06:07:41Z
updated: 2026-02-02T16:05:06Z
labels: ["bug"]
assignees: []
comments_count: 2
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5212
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

Title: exec tool returns "spawn EBADF" on all commands

## Environment
- **OpenClaw version:** 2026.1.29
- **Node version:** v22.22.0 (also tested on v25.4.0 - same issue)
- **OS:** macOS Darwin 24.3.0 (arm64)
- **Installation method:** Homebrew

## Problem
All exec tool calls fail immediately with error: `spawn EBADF`

## What works
- Read/Write file tools work fine
- Telegram and iMessage channels functioning
- Gateway running normally (PID visible, logs clean)
- Web UI accessible

## What's broken
Any attempt to run shell commands via the exec tool fails:

<invoke name="exec">
<parameter name="command">echo "test"</parameter>
</invoke>
Returns:
```json
{
  "status": "error",
  "tool": "exec",
  "error": "spawn EBADF"
}
Tested

• Downgraded from Node v25.4.0 to v22.22.0 - same issue
• Multiple gateway restarts - no change
• File descriptor count normal (42 FDs on main process)
Impact

Agent cannot run any shell commands, significantly limiting functionality.

## Comments

### @sfo2001 (2026-01-31)

This is being addressed by two open PRs:

1. **#4153** - fixes root cause (PTY FD leaks)
2. **#4932** - adds file-capture fallback for macOS

Workaround until merged: restart the gateway periodically to release leaked FDs

### @willdoyle22 (2026-02-02)

Having this same issue, and restarting gateway does nothing. I also created an issue for it this morning. 



## Links

- None detected yet
