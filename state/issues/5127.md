---
number: 5127
title: "[Bug]:"
author: ryanmccabe69
created: 2026-01-31T03:10:14Z
updated: 2026-01-31T03:10:14Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/5127
duplicate_of: null
related_issues: [1254,10955]
blocks: []
blocked_by: []
---

## Description

Summary
Microsoft Graph credentials configured in mcporter.json and environment variables are not being passed to the @softeria/ms-365-mcp-server MCP server. Clawdbot repeatedly reports it cannot find MS365_MCP_CLIENT_ID and MS365_MCP_TENANT_ID despite these being configured in multiple locations.
Steps to reproduce

Install @softeria/ms-365-mcp-server: npm install -g @softeria/ms-365-mcp-server
Configure Azure AD app with required Microsoft Graph API permissions (Mail.ReadWrite, Calendar.ReadWrite, etc.) and redirect URI http://localhost:3365/callback
Create ~/.clawdbot/mcporter.json with Microsoft Graph credentials:

json{
  "mcpServers": {
    "ms365": {
      "command": "npx",
      "args": ["-y", "@softeria/ms-365-mcp-server"],
      "env": {
        "MS365_MCP_CLIENT_ID": "${MS365_MCP_CLIENT_ID}",
        "MS365_MCP_CLIENT_SECRET": "${MS365_MCP_CLIENT_SECRET}",
        "MS365_MCP_TENANT_ID": "${MS365_MCP_TENANT_ID}"
      }
    }
  }
}
```
4. Set environment variables in `~/.clawdbot/.env`:
```
MS365_MCP_CLIENT_ID=<client-id>
MS365_MCP_CLIENT_SECRET=<client-secret>
MS365_MCP_TENANT_ID=<tenant-id>
```
5. Also added variables to `~/.bashrc` and systemd service file `~/.config/systemd/user/clawdbot-gateway.service`
6. Restart gateway: `clawdbot gateway restart`
7. Test: `clawdbot agent --message "Check my emails" --to <phone> --channel telegram --deliver`

## Expected behavior
Clawdbot should pass the configured environment variables to the ms365 MCP server, allowing it to authenticate with Microsoft Graph API and access email/calendar data.

## Actual behavior
Clawdbot responds: "I cannot access your email without the Tenant ID and Client ID" despite these credentials being configured in mcporter.json, .env file, bashrc, and systemd service environment variables.

The MCP server appears to not receive the environment variables from any of these configuration sources.

## Environment
- Clawdbot version: 2026.1.24-3
- OS: Ubuntu 24.04 (Hostinger VPS)
- Install method: npm global install

## Logs or screenshots
Gateway status shows running correctly:
```
Runtime: running (pid 15306, state active, sub running)
RPC probe: ok
mcporter.json validation passes:
bashcat ~/.clawdbot/mcporter.json | python3 -m json.tool
# Returns valid JSON with credentials configured
Environment variables confirmed set:
bashecho $MS365_MCP_CLIENT_ID
# Returns correct client ID
Additional context
This appears similar to issues reported in Claude Code repository:

Issue #1254: Environment variables from env section not passed to MCP servers
Issue #10955: MCP Server Environment Variables Not Loading

These issues suggest environment variables in the env block of MCP configuration may not be passed correctly to spawned MCP server processes.
Attempted workarounds:

Hardcoding credentials directly in args array (ms365 server doesn't accept --client-id flags)
Multiple configuration file locations
Systemd service environment variables
Global .env file

None resolved the issue. The ms365 MCP server requires environment variables but doesn't appear to receive them from Clawdbot's configuration.

## Comments


## Links

- None detected yet
