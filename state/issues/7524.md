---
number: 7524
title: "Feature: groupScope option to consolidate group sessions into main"
author: ThatGuySizemore
created: 2026-02-02T22:58:56Z
updated: 2026-02-02T22:58:56Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7524
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

Currently, all group chats are **always isolated** into their own sessions via the session key format: `agent:${agentId}:${channel}:${peerKind}:${peerId}` (session-key.js line 130). There is no equivalent of `dmScope: "main"` for groups.

This means users cannot have a group chat consolidated into their main session for unified context, even when they want to.

## Use Case

A user wants their family iMessage group chat to land in the same session as their DMs, so the agent has full conversational context across both. The agent can already differentiate DM vs group from the envelope metadata (`ChatType`, `From`, `GroupSubject`, etc.), so routing replies correctly is not an issue.

Meanwhile, other groups (e.g., a friend's group chat) should remain isolated.

## Proposed Solution

Add a `groupScope` option (similar to `dmScope`) that controls whether group sessions consolidate or isolate:

```jsonc
// Global default
"session": {
  "groupScope": "isolated"  // default, current behavior
}

// Per-group override in channel config
"channels": {
  "bluebubbles": {
    "groups": {
      "chat_guid:any;+;96b8c77b...": {
        "groupScope": "main"  // consolidate this group to main session
      }
    }
  }
}
```

Values:
- `"isolated"` (default): Current behavior, each group gets its own session
- `"main"`: Route to the agent's main session (like `dmScope: "main"` does for DMs)

## Context

Discovered while migrating from `imsg` (legacy iMessage) to BlueBubbles. The imsg channel had a quirk where unconfigured groups weren't detected as groups (`is_group: false`), so they accidentally consolidated. BlueBubbles correctly reports `isGroup: true` via chat GUID format (`;+;` = group), which exposed the missing feature.

## Affected Code

- `dist/routing/session-key.js` - `buildAgentPeerSessionKey()` line ~130
- `dist/routing/resolve-route.js` - `buildAgentSessionKey()`

## Comments


## Links

- None detected yet
