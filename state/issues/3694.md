---
number: 3694
title: "[Feature]: WeChat channel setup for Moltbot"
author: NickNYU
created: 2026-01-29T02:27:50Z
updated: 2026-01-29T02:27:50Z
labels: ["enhancement"]
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/moltbot/moltbot/issues/3694
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# Proposal: Public WebChat (WeChat-friendly H5) for “C-end users open link and chat”

## Context / Problem
Today Moltbot’s Web UI is primarily an operator/control surface. 

For end users (e.g., friends/customers) the easiest experience is: **open a link inside WeChat → chat immediately**.  
However, the current browser WS client (`ui/src/ui/gateway.ts`) connects as `role=operator` with admin/pairing scopes, which is not safe to expose publicly.

## Goal
Add a **Public WebChat** entry point optimized for mobile/WeChat in-app browser:
- C-end user: open link/QR → chat immediately (anonymous by default)
- Deployer: self-host only; minimal config; can disable anonymous/share
- Security: public UI must never get operator/admin capabilities

Non-goals (Phase 1):
- WeChat Official Account / Customer Service integration
- WeChat OAuth / JS-SDK (requires extra platform setup; not “out of the box”)

## Proposed Solution (High-level)
### 1) Add a “Public Chat” web surface (UI)
- New route (example): `/public/chat` (exact path bikesheddable)
- Minimal UI: chat + reconnect state + optional “copy link / QR code”
- WeChat-friendly UX: larger touch targets, stable input, mobile layout
- WebSocket transport stays the same; only the client identity/permissions change.

### 2) Split WS client roles: operator vs public-webchat
- Parameterize `GatewayBrowserClient` so it can be used for:
  - `operator` (existing control UI behavior)
  - `public webchat` (new minimal role/scopes/clientName)
- Use existing reserved client id: `client.id = "webchat-ui"` for public chat (instead of `"moltbot-control-ui"`).

### 3) Gateway-side authorization (required for safety)
- Introduce (or reuse) a non-operator role (e.g. `role="webchat"`).
- Enforce RPC allowlist for that role:
  - allow: `chat.send`, `chat.abort` (if exists), minimal `chat.history` (if needed)
  - deny: operator/admin/pairing/device/node/exec related methods
- Add basic rate limiting / session TTL defaults for anonymous access (configurable).

### 4) Optional: shareable links (Phase 2)
If maintainers agree, add a minimal backend feature for share links:
- `/s/:shareId` → opens a public chat session
- default TTL, optional read-only vs continue-chat
- default datastore: SQLite (single-node docker friendly)

## PR Plan (small, reviewable PRs)
1. **PR1 (UI only):** add `/public/chat`, WeChat UA tweaks, copy link + QR (no backend changes).
2. **PR2 (UI refactor):** parameterize `GatewayBrowserClient` for different roles/scopes; use `webchat-ui` id on public route.
3. **PR3 (Gateway security):** add role+RPC allowlist enforcement for public webchat connections.
4. **PR4 (optional):** anonymous session + share links (SQLite default) + docs + docker examples.

## Testing
- Manual tests: open in mobile Safari/Chrome, and WeChat in-app browser.
- WebSocket reconnect + message dedupe under flaky network.
- Ensure public route cannot call operator-only RPC methods.

## Questions for maintainers
1. Is a new route like `/public/chat` acceptable, or should it be integrated into existing `/chat` with a “mode”?
2. Preferred naming for the new role/scopes (e.g. `role=webchat` vs `role=user`)?
3. Are you open to share links in core, or should that live as an extension/plugin?

## Comments


## Links

- None detected yet
