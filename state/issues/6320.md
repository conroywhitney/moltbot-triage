---
number: 6320
title: "Windows: security audit false-positive shows mode=666 on NTFS ACL"
author: Toul1982
created: 2026-02-01T14:45:52Z
updated: 2026-02-01T21:04:13Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6320
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

# Clawdbot: Windows false-positive i security audit (mode=666)

## Sammanfattning
`clawdbot status --json` (security audit) flaggar **CRITICAL** permissions på Windows med "mode=666" för flera state-filer/mappar under `.clawdbot`, trots att `icacls` visar tight ACL (endast SYSTEM, Administrators och aktuell användare).

Det gör att status ser "röd" ut och kan skapa onödig oro/extra arbete.

## Miljö
- OS: Windows 10/11 (NT) (observerat på: Windows_NT 10.0.22631)
- Clawdbot gateway: kör lokalt på 127.0.0.1:18789

## Symptom
Security audit rapporterar (exempel):
- `.clawdbot`
- `.clawdbot\\clawdbot.json`
- `.clawdbot\\credentials`
- `.clawdbot\\agents\\main\\agent\\auth-profiles.json`
- (WARN) `.clawdbot\\agents\\main\\sessions\\sessions.json`

Som CRITICAL: "mode=666".

## Förväntat
På Windows bör security audit:
- Antingen använda ACL-baserad kontroll (icacls/Win32 APIs) istället för POSIX mode bits.
- Eller ignorera/avdramatisera POSIX-mode på NTFS när ACL inte är öppen.

## Verifiering (workaround för att avgöra om det är riktigt problem)
Kör `icacls` på pathen och kontrollera att det inte finns ACEs för t.ex. `Everyone` / `Users` med write.
Exempel på "bra" ACL:
- `NT AUTHORITY\\SYSTEM:(F)`
- `BUILTIN\\Administrators:(F)`
- `<CurrentUser>:(F)`

## Hypotes
Node/Windows rapporterar POSIX-liknande mode (ex 666) som default för vissa filesystem calls, vilket inte representerar verklig åtkomst på NTFS. Auditlogiken tolkar det som world-writable.

## Önskad fix
- Windows-specifik permissions-check.
- Alternativt: dokumenterad varningstext att mode på Windows inte är tillförlitligt och att man måste validera via ACL.

## Extra observation
`clawdbot status --json` kan ta ~20–30s utan output pga audit och kan se ut som "häng" om man väntar kort; `clawdbot health --json` är oftast snabbare.

## Comments


## Links

- None detected yet
