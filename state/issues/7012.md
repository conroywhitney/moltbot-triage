---
number: 7012
title: "Feature: Auto-approve Control UI devices when valid gateway token is presented"
author: neo-nobin
created: 2026-02-02T09:02:58Z
updated: 2026-02-02T09:02:58Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7012
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When running OpenClaw behind a reverse proxy (nginx/Caddy) with HTTPS, the Control UI requires device pairing even when the user has authenticated with a valid gateway token. This creates a UX dead-end for managed hosting deployments where there's no CLI access to run `openclaw devices approve`.

## Current workarounds (all have trade-offs)

| Config | Result |
|--------|--------|
| `allowInsecureAuth: true` | Works but flagged as CRITICAL by `openclaw security audit` |
| `dangerouslyDisableDeviceAuth: true` | Works but also flagged as CRITICAL |
| Neither set | Device pairing required — user is stuck on 'pairing required' screen |

## Use case

We're integrating OpenClaw as a one-click app on a managed hosting platform (xCloud). The setup:
- **Nginx** terminates SSL + basic auth (gate 1)
- **Gateway token** authenticates the Control UI (gate 2)  
- **Device pairing** is a third layer that's unreachable for users without SSH

Users access the Control UI via a 'Remote Login' button that passes `?token=<gateway_token>` in the URL. They have no CLI access to approve their own device.

## Proposed solution

Add a new config option like:

```json
{
  "gateway": {
    "controlUi": {
      "autoApproveWithToken": true
    }
  }
}
```

When enabled, if a Control UI WebSocket client presents a **valid gateway token** during the handshake, automatically approve the device pairing without requiring manual CLI approval.

This is security-sound because:
- Possession of the gateway token already proves authorization
- The device identity is still generated and tracked (unlike `dangerouslyDisableDeviceAuth`)
- `openclaw security audit` wouldn't need to flag it (token = valid auth)

## Alternatives considered

1. **Pre-pairing during provisioning** — not possible since device ID is generated by the browser
2. **API-triggered approval from the hosting platform** — timing issues (device request doesn't exist until user visits)
3. **Disabling device auth** — works but flagged by security audit

## Environment

- OpenClaw 2026.1.30
- Behind nginx reverse proxy with `trustedProxies: ["127.0.0.1"]`
- Gateway auth mode: token

## Comments


## Links

- None detected yet
