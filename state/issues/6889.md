---
number: 6889
title: "Telegram health probe always shows green even when webhook is failing"
author: liaosvcaf
created: 2026-02-02T05:08:20Z
updated: 2026-02-02T05:32:18Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6889
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Bug

The web UI health badge always shows "Health OK" (green) even when channels are completely broken (e.g., Telegram webhook failing with 500 errors, messages not being delivered).

### Root Causes (three independent bugs)

**1. Telegram probe ignores webhook delivery errors**
`probeTelegram()` in `src/telegram/probe.ts` calls `getMe` and `getWebhookInfo` but only reads `url` and `has_custom_certificate`. It ignores `pending_update_count`, `last_error_date`, and `last_error_message` from the webhook response.

**2. Health summary `ok` field is hardcoded to `true`**
In `src/commands/health.ts`, `getHealthSnapshot()` returns `{ ok: true, ... }` unconditionally. It never checks whether any channel probes failed.

**3. Web UI health badge only checks WebSocket connectivity**
In `ui/src/ui/app-render.ts`, the topbar health badge renders:
```ts
state.connected ? "OK" : "Offline"
```
It never fetches health probe results or reflects channel status.

### Impact

Users see a green "Health OK" badge while messages are silently failing. The only way to detect channel problems is to manually navigate to the Channels tab.

### Steps to Reproduce

1. Configure Telegram with a bot token
2. Set webhook to a broken URL (or stop the gateway webhook endpoint)
3. Send messages to the bot -- they are not delivered
4. Web UI top-right shows "Health OK" in green

### Environment

- openclaw 2026.1.30
- macOS (arm64)

## Comments


## Links

- None detected yet
