---
number: 3367
title: "Sessions navigation fix + DM thread display + DM thread delivery regression"
author: Lukavyi
created: 2026-01-28T14:14:54Z
updated: 2026-01-31T10:59:06Z
labels: ["bug", "app: web-ui"]
assignees: []
comments_count: 1
reactions_total: 3
url: https://github.com/openclaw/openclaw/issues/3367
duplicate_of: null
related_issues: [3368]
blocks: []
blocked_by: []
---

## Description

## Problem 1: Navigation

Clicking a session link in the Sessions tab navigates to the Main session instead of the clicked session.

**Steps to reproduce:**
1. Open Sessions tab in Control UI
2. Click on any non-main session (e.g., a Telegram DM topic)
3. Expected: opens that session's chat
4. Actual: opens Main session

**Root cause:** `syncTabWithLocation()` is called before `applySettingsFromUrl()`, overwriting the URL `?session=` param with the old localStorage value.

## Problem 2: Display

Telegram DM topic sessions all appear with the same display name — impossible to distinguish between them.

## Problem 3: DM Thread Delivery (regression)

After commit 9154971 (`fix(telegram): ignore message_thread_id for non-forum group sessions`), bot replies in DM threads go to General instead of the originating thread.

**Steps to reproduce:**
1. Enable Topics in a DM with the bot (requires Telegram Premium)
2. Send a message in a DM thread/topic
3. Bot replies in General instead of the thread

**Root cause:** `resolveTelegramForumThreadId()` returns `undefined` when `is_forum` is false. Telegram Bot API never sets `is_forum=true` for private chats (only supergroups). The returned `context.resolvedThreadId` is used by `bot-message-dispatch.ts` for draft streaming, typing indicators, and reply delivery — all become `undefined` for DM threads.

## Fix

PR #3368 addresses all three issues:
1. Call `applySettingsFromUrl()` before `syncTabWithLocation()`
2. Set `ThreadLabel` for DM topic sessions
3. Introduce `effectiveThreadId = isGroup ? resolvedThreadId : messageThreadId` for correct outbound delivery

## Comments

### @hitchhiker (2026-01-31)

## Additional Issue: Cron Job Targeting for DM Threads

Related to this regression — cron jobs cannot target specific DM threads/topics.

### Current behavior:
- Cron delivery format supports `<groupId>:topic:<threadId>` for forum supergroups
- DM thread targeting (e.g., `597731080:topic:241452`) doesn't work — no syntax for it
- Cron messages to DM topics go to General instead of the specified thread

### Desired behavior:
- Either extend cron `to` format to support DM thread targeting
- Or document the limitation clearly

### Workaround (current):
- None — proactive cron messages to DM threads must use the message tool with explicit `threadId` parameter

This is related to PR #3368's fix for `effectiveThreadId = isGroup ? resolvedThreadId : messageThreadId` — the same logic should apply to cron delivery.


## Links

- None detected yet
