---
number: 6817
title: "sessions_spawn ignores model parameter when agentId or other extra parameters are passed"
author: zire
created: 2026-02-02T02:54:17Z
updated: 2026-02-02T04:35:55Z
labels: ["bug"]
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/6817
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

When calling `sessions_spawn` with additional parameters beyond `model`, `label`, and `task`, the model assignment is silently ignored. The spawned session falls back to the default model instead of using the specified one.

## Steps to Reproduce

1. Call `sessions_spawn` with extra parameters:
```javascript
sessions_spawn({
  model: "openrouter/deepseek/deepseek-v3.2",
  label: "Test-Agent",
  task: "Do something",
  agentId: "some-agent-id"  // This breaks it
})
```

2. The spawned session runs on the default model, NOT `deepseek-v3.2`

## Expected Behavior

The session should spawn using the specified model (`deepseek-v3.2`), and either:
- Ignore unknown/unsupported parameters, OR
- Return an error indicating invalid parameters

## Actual Behavior

The model parameter is silently ignored. The session spawns with the default/fallback model instead of the specified one. No error or warning is shown.

## Workaround

Only pass the three core parameters:
```javascript
sessions_spawn({
  model: "openrouter/deepseek/deepseek-v3.2",
  label: "Test-Agent", 
  task: "Do something"
})
// Do NOT add agentId, runTimeoutSeconds, or other parameters
```

## Impact

This is particularly confusing when setting up multi-model agent architectures (e.g., Claude for orchestration, DeepSeek for sub-agents). Users may think their model routing is working when it's actually falling back to defaults.

## Environment

- clawdbot version: 2026.1.24-3
- macOS 26.2

## Comments

### @whoknowsmann (2026-02-02)

## Investigation Findings

We dug into this issue and wrote tests to narrow down where the bug lives.

### What we tested and confirmed works:

1. **`sessions_spawn` tool parameter handling** — Passing both `model` and `agentId` correctly extracts the model and calls `sessions.patch` with it. ([Test](https://github.com/openclaw/openclaw/pull/6875))

2. **`applySessionsPatchToStore` persistence** — The model is correctly stored as `providerOverride` + `modelOverride` in the session entry. 

3. **Session store cache invalidation** — Cache is invalidated when `updateSessionStore` writes, so subsequent reads should see the updated data.

### Where the bug is NOT:

- ❌ Not in `sessions_spawn` parameter parsing
- ❌ Not in `sessions.patch` persistence logic
- ❌ Not in session store cache handling

### Where the bug likely IS:

- The agent runner (`agentCommand`) when it reads and uses the `modelOverride`
- A possible silent rejection if the model isn't in an allowlist (`agents.defaults.models`)
- Something environment-specific

### Questions for the reporter:

1. Do you have `agents.defaults.models` configured (a model allowlist)?
2. What's the exact error or behavior you see? Does `/status` show the wrong model?
3. Can you share a minimal config that reproduces the issue?

PR with test coverage: #6875


## Links

- None detected yet
