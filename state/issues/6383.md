---
number: 6383
title: "TTS Media Delivery: MEDIA: prefix not stripped in path parser"
author: sean808080
created: 2026-02-01T16:05:43Z
updated: 2026-02-01T21:04:03Z
labels: ["bug"]
assignees: []
comments_count: 0
reactions_total: 1
url: https://github.com/openclaw/openclaw/issues/6383
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Summary
TTS tool successfully generates audio files but fails to send them via Telegram due to media path parsing error.

## Issue
The `message` tool fails when trying to send TTS-generated audio files with error:
```
ENOENT: no such file or directory, open 'MEDIA:/tmp/tts-xsMcDl/voice-1769961421124.mp3'
```

## Expected Behavior
The `MEDIA:` prefix should be stripped before attempting to open the file at `/tmp/tts-xsMcDl/voice-1769961421124.mp3`.

## Actual Behavior
OpenClaw attempts to open a file literally named `MEDIA:/tmp/tts-xsMcDl/voice-1769961421124.mp3` (with the prefix included), which doesn't exist.

## Environment
- **OpenClaw Version:** 2026.1.30 (76b5208)
- **Platform:** Linux 6.8.0-90-generic
- **Node Version:** v22.22.0
- **Channel:** Telegram
- **TTS Provider:** Google Cloud Text-to-Speech (service account)

## Stack Trace
```
Error: ENOENT: no such file or directory, open 'MEDIA:/tmp/tts-xsMcDl/voice-1769961421124.mp3'
    at open (node:internal/fs/promises:636:25)
    at Object.readFile (node:internal/fs/promises:1235:14)
    at loadWebMediaInternal (file:///home/sean/.nvm/versions/node/v22.22.0/lib/node_modules/openclaw/dist/web/media.js:148:18)
    at loadWebMedia (file:///home/sean/.nvm/versions/node/v22.22.0/lib/node_modules/openclaw/dist/web/media.js:166:12)
    at sendMessageTelegram (file:///home/sean/.nvm/versions/node/v22.22.0/lib/node_modules/openclaw/dist/telegram/send.js:230:23)
    at handleTelegramAction (file:///home/sean/.nvm/versions/node/v22.22.0/lib/node_modules/openclaw/dist/agents/tools/telegram-actions.js:128:24)
```

## Reproduction Steps
1. Configure Google Cloud TTS with service account credentials via `GOOGLE_APPLICATION_CREDENTIALS`
2. Use TTS tool to generate audio: `tts "Hello, this is a test"`
3. TTS tool generates file successfully (verified: 23KB file exists at correct path)
4. Agent attempts to send audio via Telegram using `message` tool with `MEDIA:` prefixed path
5. Error occurs in media loading step at `loadWebMediaInternal`

## Verification
```bash
# File exists at correct path (without prefix)
$ ls -lh /tmp/tts-xsMcDl/voice-1769961421124.mp3
-rw-rw-r-- 1 sean sean 23K Feb  1 15:57 /tmp/tts-xsMcDl/voice-1769961421124.mp3

# File does not exist with MEDIA: prefix
$ ls -lh "MEDIA:/tmp/tts-xsMcDl/voice-1769961421124.mp3"
ls: cannot access 'MEDIA:/tmp/tts-xsMcDl/voice-1769961421124.mp3': No such file or directory
```

## Configuration
```json
{
  "channels": {
    "telegram": {
      "enabled": true,
      "streamMode": "partial"
    }
  }
}
```

## Impact
- TTS functionality generates audio successfully but cannot deliver it to users
- Affects all media delivery using `MEDIA:` prefix in Telegram channel
- Breaks audio/voice message functionality

## Suggested Fix
The media path parser in `dist/web/media.js` (line 148) should detect and strip the `MEDIA:` prefix before passing the path to `fs.readFile()`.

The prefix appears to be a protocol indicator that should be parsed out before file system operations.

## Comments


## Links

- None detected yet
