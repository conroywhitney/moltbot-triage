---
number: 7013
title: "Node exec approvals not working - SYSTEM_RUN_DENIED despite wildcard allowlist"
author: Greg-Swiftomatic
created: 2026-02-02T09:03:22Z
updated: 2026-02-02T09:03:22Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7013
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Environment
- Gateway version: 2026.1.24-3
- Node version: 2026.1.24-3 (CLI node host on macOS)
- macOS app version: 2026.1.30
- Transport: SSH tunnel

## Problem
Node connects successfully to gateway, shows `system.run` in capabilities, but ALL commands are denied with `SYSTEM_RUN_DENIED: approval required`.

## What we tried
1. `clawdbot approvals allowlist add hostname` - still denied
2. `clawdbot approvals allowlist add "*"` (wildcard) - still denied
3. Manually editing `~/.clawdbot/exec-approvals.json` with:
   - `"agents": {"*": {"allowlist": [{"pattern": "*"}]}}`
   - `"defaults": {"allow": "*"}`
4. Restarting node after each change - still denied
5. Gateway also has wildcard allowlist configured - still denied

## exec-approvals.json on node (macOS)
```json
{
  "version": 1,
  "socket": {
    "path": "/Users/gregld/.clawdbot/exec-approvals.sock",
    "token": "RSO5qWjhGcLE52BaaCFJpQWzcCmvu5PQ"
  },
  "defaults": {},
  "agents": {
    "*": {
      "allowlist": [
        {"pattern": "hostname"},
        {"pattern": "*"}
      ]
    }
  }
}
```

## exec-approvals.json on gateway (Linux)
```json
{
  "version": 1,
  "socket": {},
  "defaults": {},
  "agents": {
    "*": {
      "allowlist": [{"pattern": "*"}]
    }
  }
}
```

## System event logs
```
Exec denied (node=6094b88a... id=..., approval-required): hostname
```

## Additional issue
OpenClaw macOS app (v2026.1.30) fails to connect to gateway (v2026.1.24-3) with:
```
Gateway error: invalid connect params: at /client/id: must be equal to constant; at /client/id: must match a schema in anyOf
```
This appears to be a protocol version mismatch.

## Expected behavior
Commands matching the wildcard allowlist should be allowed to execute on the node.

## Comments


## Links

- None detected yet
