---
number: 7107
title: "Model switch fails when tool call IDs from previous model are incompatible"
author: kiwi321
created: 2026-02-02T11:49:51Z
updated: 2026-02-02T11:49:51Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7107
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Problem

When switching models mid-session (e.g., from Kimi-K2 to Claude), the session becomes unresponsive because the conversation history contains tool call IDs generated by the previous model that don't match the new model's expected format.

**Example:** Claude requires tool call IDs to match `^[a-zA-Z0-9_-]+$`, but Kimi-K2 generates IDs in a different format. When you switch, Claude can't parse the old tool calls and the session hangs.

## Current Workaround

Users must start a new session (`/new` or button), losing conversation context.

## Suggested Fix

1. **Sanitize tool call IDs on model switch** — rewrite IDs to be compatible with the target model's regex requirements
2. **Or provide a `/model --fresh` option** — switch model but strip tool call metadata from history (keep text content only)
3. **Or auto-summarize** — when switching to an incompatible model, compress history to a text summary instead of raw messages

## Environment

- Clawdbot Gateway
- Observed with: Kimi-K2 → Claude switch
- Likely affects any cross-provider model switch where ID formats differ

## Comments


## Links

- None detected yet
