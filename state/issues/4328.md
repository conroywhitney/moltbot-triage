---
number: 4328
title: "Gateway crash loop: Unhandled promise rejection TypeError: fetch failed (v2026.1.24-3)"
author: wdi-dave-roberts
created: 2026-01-30T02:50:08Z
updated: 2026-01-30T03:16:24Z
labels: []
assignees: []
comments_count: 1
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/4328
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

## Description

Gateway crashes every 60-90 seconds with an unhandled promise rejection from Node's undici HTTP client. Systemd restarts the service, but all agent state is lost on each crash, making the bot unresponsive.

## Environment

- **Version:** 2026.1.24-3
- **Node:** 24.12.0
- **Platform:** WSL2 Ubuntu on Windows 11
- **Gateway config:** bind=loopback, port=18790, Tailscale serve enabled

## Error

```
[clawdbot] Unhandled promise rejection: TypeError: fetch failed
    at node:internal/deps/undici/undici:15845:13
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
```

No URL, subsystem, or additional context in the stack trace.

## Crash pattern

Consistent 60-90 second intervals:
```
02:39:30 TypeError: fetch failed
02:40:42 TypeError: fetch failed
02:41:56 TypeError: fetch failed
02:42:38 TypeError: fetch failed
02:44:22 TypeError: fetch failed
```

## Investigation

- **Network is fine:** `curl` to Anthropic API, Telegram API, npm registry all return 200/302.
- **Not port-related:** Crashes on both 18789 and 18790.
- **Fetch wrapper lacks error handling:** `infra/fetch.js` (`wrapFetchWithAbortSignal`) passes through without `.catch()`. Whatever calls `fetch()` internally does not handle rejection.
- **Possible rename ripple effect:** The binary contains 39 hardcoded `clawd.bot` URLs and fetches `registry.npmjs.org/clawdbot`. The recent clawdbot â†’ moltbot rename may have invalidated an endpoint that isn't the npm registry itself (which still responds).
- **Minimal stack trace:** The undici error at line 15845 provides no indication of which URL or subsystem triggered the failure. A global `process.on('unhandledRejection')` handler that logs the full error (including URL/request context) would help diagnose.

## Suggested fix

1. Add a global unhandled rejection handler that logs the full error context (URL, subsystem) instead of crashing.
2. Ensure all periodic `fetch()` calls (heartbeat, Telegram polling, plugin checks, update checks) have proper `.catch()` handlers.
3. Audit hardcoded `clawd.bot` / `clawdhub.com` URLs for any that may have been taken down or redirected as part of the rename.

## Related

- Port investigation: https://github.com/moltbot/moltbot/issues/4311

## Comments

### @C-o-d-e-C-o-w-b-o-y (2026-01-30)

https://github.com/moltbot/moltbot/issues/3815


## Links

- None detected yet
