---
number: 7062
title: "[Bug]: models status crashes when agents.defaults.model is undefined"
author: davefielding
created: 2026-02-02T10:33:35Z
updated: 2026-02-02T10:33:35Z
labels: []
assignees: []
comments_count: 0
reactions_total: 0
url: https://github.com/openclaw/openclaw/issues/7062
duplicate_of: null
related_issues: []
blocks: []
blocked_by: []
---

## Description

The `openclaw models status` command crashes with `TypeError: Cannot read properties of undefined (reading 'trim')` if `agents.defaults.model` is missing from the configuration.

### Steps to reproduce
1. Run `openclaw models status` with a configuration that lacks `agents.defaults.model`.

### Expected behavior
The command should handle the missing configuration gracefully or show a meaningful error.

### Technical Details
The crash occurs in `list.status-command.js` (transpiled) at:
```javascript
const rawDefaultsModel = typeof modelConfig === "string" ? modelConfig.trim() : (modelConfig?.primary?.trim() ?? "");
```
If `modelConfig` is undefined (due to missing `agents.defaults.model`), `modelConfig?.primary` is safe, but `modelConfig.trim()` is not if the first check failed to catch the undefined state correctly in some environments, or if `modelConfig` is not a string but `primary` is missing or null.

Actually, the logic is:
`typeof modelConfig === "string" ? modelConfig.trim() : (modelConfig?.primary?.trim() ?? "");`

If `modelConfig` is `undefined`, `typeof modelConfig` is `"undefined"`, which goes to the ternary false branch: `(undefined?.primary?.trim() ?? "")` which returns `""`. This should be safe.

However, if `cfg.agents.defaults.models` contains an entry with a null/undefined alias:
```javascript
const aliases = Object.entries(cfg.agents?.defaults?.models ?? {}).reduce((acc, [key, entry]) => {
    const alias = entry?.alias?.trim(); // Potential crash site if alias is not a string
    if (alias) {
        acc[alias] = key;
    }
    return acc;
}, {});
```

Verified: The error `TypeError: Cannot read properties of undefined (reading 'trim')` is likely coming from line 50:
`const alias = entry?.alias?.trim();`
if `entry.alias` exists but is not a string.

Or line 63:
`.map((p) => p.trim())`
if one of the provider keys in `cfg.models.providers` is somehow not a string.

I will be submitting a PR to harden these trim calls.

## Comments


## Links

- None detected yet
