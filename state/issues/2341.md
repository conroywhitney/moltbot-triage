---
number: 2341
title: "[Security] Support running gateway as isolated system user instead of personal user"
author: jeanlucthumm
created: 2026-01-26T19:15:57Z
updated: 2026-01-28T06:02:37Z
labels: ["bug"]
assignees: []
comments_count: 2
reactions_total: 1
url: https://github.com/moltbot/moltbot/issues/2341
duplicate_of: null
related_issues: [1608,1792]
blocks: []
blocked_by: []
---

## Description

## Summary

The gateway currently runs as the user's personal account (via systemd user service on Linux or launchd agent on macOS), giving the LLM full access to everything that user can access - SSH keys, GPG keys, credentials, personal files, etc.

This is a significant security risk given that:
- LLMs can be prompt-injected
- Plugins execute with full system privileges (issue #1792, finding 2)
- The optional Docker sandbox doesn't work reliably with systemd user services (#1608)

## Proposal

Support running the gateway as a dedicated, locked-down system user with minimal privileges:

### Linux
- Dedicated `clawdbot` user with restricted home directory
- System-level systemd service instead of user service
- Systemd hardening (`ProtectHome=true`, `PrivateTmp=true`, `NoNewPrivileges=true`, etc.)

### macOS
- Dedicated `_clawdbot` user (following macOS daemon user convention)
- LaunchDaemon (`/Library/LaunchDaemons/`) instead of LaunchAgent
- Sandbox profile or similar restrictions

### Both platforms
- No access to personal user files
- Proper credential isolation (Claude OAuth stored in dedicated user's home)

## Security Benefit

| Current | Proposed |
|---------|----------|
| Compromised LLM can access: SSH keys, personal files, all user credentials | Compromised LLM can only access: clawdbot config + Anthropic OAuth token |

The Anthropic credential risk is unavoidable (the service needs it), but isolating everything else significantly reduces blast radius.

## Implementation Notes

- Would require changes to daemon install logic to support system-level service on both platforms
- Credential management needs consideration (user authenticates as dedicated user)
- `clawdbot onboard --install-daemon` could offer `--system` flag or similar

## Comments

### @Sophist-UK (2026-01-26)

As a personal assistant the user may wish to give ClawdBot access to some or all of their data. However this should be something they explicitly give ACL access to and not by default.

### @jeanlucthumm (2026-01-26)

Yeah, either way it shouldn't be running under the user's username


## Links

- None detected yet
