---
number: 3607
title: "fix: Auto-expire auth profile cooldowns when timestamp expires"
author: bergcb322-clawd
created: 2026-01-28T22:18:41Z
updated: 2026-01-28T22:18:52Z
labels: ["agents"]
additions: 25
deletions: 6
changed_files: 1
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: passing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3607
fixes_issues: [3604]
related_prs: [3604]
duplicate_of: null
---

## Description

Fixes #3604

## Problem
Auth profiles were getting stuck in cooldown even after the `cooldownUntil` timestamp had expired, blocking the agent from making API calls indefinitely.

## Root Cause
The cooldown check only happened during profile selection (`isProfileInCooldown`), but expired cooldowns were never cleared from the store. Profiles remained marked as unavailable even when `Date.now() >= cooldownUntil`.

## Solution
Added auto-expiry logic in `resolveAuthProfileOrder` (both explicit and round-robin paths):
- When `now >= unusableUntil`, clear both `cooldownUntil` and `disabledUntil`
- Ensures profiles become available immediately after cooldown expires
- Minimal change, no new dependencies

## Testing
Manually tested by:
1. Setting expired cooldown timestamp in auth-profiles.json
2. Making API call
3. Verifying profile becomes available without manual intervention

## Evidence
Before fix:
- Cooldown set to: 1769633531559 (Jan 28 20:52:11 UTC)
- Current time: 1769634806000 (Jan 28 21:13:26 UTC)
- Diff: -1274 seconds (20+ minutes expired)
- Profile still marked unavailable

After fix:
- Profile auto-expires and becomes available

## Reviews


## Comments


## Stats

- **Size:** small (25+, 6-, 1 files)
- **Age:** 1 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #3604
