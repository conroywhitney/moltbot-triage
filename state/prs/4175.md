---
number: 4175
title: "feat(cron): add directMessage payload type for zero-cost reminders"
author: gustavbotichelli
created: 2026-01-29T20:21:15Z
updated: 2026-01-29T22:36:20Z
labels: ["app: web-ui", "gateway", "agents"]
additions: 105
deletions: 9
changed_files: 10
size: medium
review_decision: none
reviews: []
comments_count: 1
reactions_total: 0
ci_status: passing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4175
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

Adds a new `directMessage` cron payload type that sends text directly to a channel without spinning up an AI session. **Zero token cost** for simple text reminders.

## Problem

Every cron reminder — even a simple "pick up milk" or "Emma's birthday is tomorrow" — currently requires an `agentTurn` session, burning ~5-10K tokens just to relay a one-liner to Telegram/Discord/etc.

## Solution

New payload type `directMessage` with `sessionTarget: "none"`:

```json
{
  "name": "Birthday reminder",
  "schedule": { "kind": "cron", "expr": "0 9 15 3 *", "tz": "America/New_York" },
  "sessionTarget": "none",
  "payload": {
    "kind": "directMessage",
    "text": "Happy Birthday Emma!",
    "channel": "telegram",
    "to": "123456"
  }
}
```

## Changes

- **`src/cron/types.ts`** — Added `"none"` to `CronSessionTarget`, added `directMessage` to `CronPayload` and `CronPayloadPatch`
- **`src/gateway/protocol/schema/cron.ts`** — TypeBox schemas for `directMessage` payload and `"none"` sessionTarget
- **`src/cron/service/state.ts`** — Optional `sendDirectMessage` dependency
- **`src/cron/service/timer.ts`** — `sessionTarget === "none"` execution branch
- **`src/gateway/server-cron.ts`** — Wires `sendDirectMessage` via `runMessageAction`
- **`src/cron/service/jobs.ts`** — Patch merging for `directMessage` payloads
- **`src/cron/normalize.ts`** — Auto-infers `sessionTarget: "none"` from `directMessage` payload
- **`src/agents/tools/cron-tool.ts`** — Tool description and constraints updated
- **`src/agents/system-prompt.ts`** — System prompt mentions `directMessage` with zero token cost

## Constraints

- `sessionTarget="main"` requires `payload.kind="systemEvent"`
- `sessionTarget="isolated"` requires `payload.kind="agentTurn"`
- `sessionTarget="none"` requires `payload.kind="directMessage"` *(new)*

Existing jobs are completely unaffected — all changes are additive.

## Reviews


## Comments

### @gustavbotichelli (2026-01-29)

Related issue: #3850 — Cron systemEvent reminders render as user messages in webchat. This PR provides a cleaner alternative for simple text reminders via the new directMessage payload type, bypassing the session system entirely.


## Stats

- **Size:** medium (105+, 9-, 10 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
