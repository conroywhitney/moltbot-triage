---
number: 2071
title: "fix: accept JSON string for cron.add job parameter (#1940)"
author: andrescardonas7
created: 2026-01-26T04:30:31Z
updated: 2026-01-28T23:25:13Z
labels: []
additions: 42
deletions: 4
changed_files: 2
size: small
review_decision: none
reviews: [{"author":"copilot-pull-request-reviewer","state":"COMMENTED"}]
comments_count: 3
reactions_total: 0
ci_status: failing
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/2071
fixes_issues: [1940]
related_prs: [1940]
duplicate_of: null
---

## Description

gh pr create --title "fix: accept JSON string for cron.add job parameter (#1940)" --body "

## Summary
- Parse job parameter as JSON string when passed as string instead of object
- Fixes inconsistent 'must be object' error when AI tools pass job as JSON string

## Testing
- Added test: accepts cron.add job payloads as JSON strings
- All 16 cron-tool tests pass
- pnpm lint âœ…
- pnpm build âœ…

## AI/Vibe-Coded PR ðŸ¤–

- [x] Mark as AI-assisted in the PR title or description
- [x] Note the degree of testing: **fully tested locally**
- [x] Include prompts or session logs if possible: available on request
- [x] Confirm you understand what the code does

### AI Tools Used
- Claude Opus-4.5
- Cursor IDE
- Manual review performed

Fixes #1940"

## Reviews

### @copilot-pull-request-reviewer â€” COMMENTED (2026-01-26)

## Pull request overview

This PR fixes inconsistent parameter handling in the `cron.add` tool action where AI tools sometimes pass the `job` parameter as a JSON string instead of an object, causing intermittent "must be object" errors.

**Changes:**
- Added JSON string parsing for the `job` parameter in the `cron.add` action
- Added validation to ensure parsed JSON is an object (not an array or primitive)
- Added test coverage for JSON string job payloads
- Minor import statement reordering (formatting)

### Reviewed changes

Copilot reviewed 2 out of 2 changed files in this pull request and generated 2 comments.

| File | Description |
| ---- | ----------- |
| src/agents/tools/cron-tool.ts | Added JSON.parse logic to accept job parameter as either object or JSON string, with proper validation |
| src/agents/tools/cron-tool.test.ts | Added test case verifying JSON string job payloads are correctly parsed and normalized |





---

ðŸ’¡ <a href="/clawdbot/clawdbot/new/main/.github/instructions?filename=*.instructions.md" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Add Copilot custom instructions</a> for smarter, more guided reviews. <a href="https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Learn how to get started</a>.


## Comments

### @cursor (2026-01-26)

<h3>ðŸš¨ Bugbot couldn't run</h3>

Bugbot is not enabled for your user on this team.

Ask your team administrator to increase your team's hard limit for Bugbot seats or add you to the allowlist in the [Cursor dashboard](https://cursor.com/dashboard?tab=bugbot).



### @andrescardonas7 (2026-01-26)

   BugBot run


### @cursor (2026-01-26)

<h3>ðŸš¨ Bugbot couldn't run</h3>

Bugbot is not enabled for your user on this team.

Ask your team administrator to increase your team's hard limit for Bugbot seats or add you to the allowlist in the [Cursor dashboard](https://cursor.com/dashboard?tab=bugbot).




## Stats

- **Size:** small (42+, 4-, 2 files)
- **Age:** 3 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #1940
