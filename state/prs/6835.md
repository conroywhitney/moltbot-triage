---
number: 6835
title: "feat(discord): add per-agent webhook routing for Discord replies"
author: ericelizes1
created: 2026-02-02T03:31:37Z
updated: 2026-02-02T03:33:08Z
labels: ["channel: discord"]
additions: 276
deletions: 4
changed_files: 8
size: large
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 2
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6835
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
Add `agents.list[].discord.responseWebhook` config option that routes Discord replies through a webhook instead of the bot. This enables multi-agent setups where each agent appears with their own identity.

## Config
- `agents.list[].discord.responseWebhook`: webhook URL
- `agents.list[].discord.responseWebhookAvatar`: optional avatar URL

## Changes
- Add AgentDiscordConfig type to types.agents.ts
- Add AgentDiscordSchema validation to zod-schema.agent-runtime.ts
- Add agentId parameter to ChannelOutboundContext
- Pass agentId through deliverOutboundPayloads and channel handlers
- Create send.webhook.ts for Discord webhook message delivery
- Update Discord outbound adapter to check for webhook config

## Use Case
Multi-agent Discord bots where each agent needs a distinct visual identity (name/avatar) rather than all appearing as the same bot.

Falls back to normal bot messages when no webhook is configured.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds per-agent Discord webhook routing for outbound replies by introducing an `agents.list[].discord` config block (validated via Zod), threading an `agentId` through `ChannelOutboundContext` and the outbound delivery pipeline, and adding a new `sendDiscordWebhook` implementation for posting messages via Discord webhooks.

The core flow is: `routeReply` resolves the session’s agent ID, `deliverOutboundPayloads` passes it into the channel adapter context, and the Discord outbound adapter chooses webhook delivery when the resolved agent has `discord.responseWebhook`, otherwise falling back to the existing bot-based send path.

<h3>Confidence Score: 4/5</h3>

- This PR is generally safe to merge, with a couple of edge cases worth addressing.
- Changes are mostly additive and well-scoped (new config + context plumbing + webhook sender). Main risk is subtle runtime failures around webhook URL handling and operational confusion when webhook config is present but agentId is not propagated in some call paths.
- src/discord/send.webhook.ts, src/channels/plugins/outbound/discord.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-02)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** large (276+, 4-, 8 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: (none detected)
