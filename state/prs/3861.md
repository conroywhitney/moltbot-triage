---
number: 3861
title: "fix(config): write built-in channel enabled state to channels, not plugins.entries"
author: HirokiKobayashi-R
created: 2026-01-29T08:07:33Z
updated: 2026-01-29T08:07:33Z
labels: []
additions: 90
deletions: 17
changed_files: 2
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3861
fixes_issues: [3741]
related_prs: [3741]
duplicate_of: null
---

## Description

## Summary

- Built-in channels (telegram, slack, discord, etc.) are now auto-enabled via `channels.<channel>.enabled`
- Plugin channels continue to use `plugins.entries.<plugin>.enabled`
- Built-in channels no longer added to `plugins.allow`

## Problem

The gateway's auto-enable logic was writing built-in channel state to `plugins.entries.telegram`, which fails config validation because `telegram` is a built-in channel, not a plugin.

```
gateway: failed to persist plugin auto-enable changes: Error: Config validation failed: plugins.entries.telegram: plugin not found: telegram
```

This caused Telegram (and other built-in channels) to fail to start.

## Solution

Modified `enablePluginEntry()` to check if the channel is a built-in channel using `normalizeChatChannelId()`. If it is:
- Write enabled state to `channels.<id>.enabled`
- Skip adding to `plugins.allow`

If it's a plugin channel:
- Continue using `plugins.entries.<id>.enabled`
- Add to `plugins.allow` as before

## Test plan

- [x] Updated existing tests to reflect new behavior
- [x] All 9 plugin-auto-enable tests pass
- [x] Lint/type check pass

Fixes #3741

## Reviews


## Comments


## Stats

- **Size:** medium (90+, 17-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: #3741
