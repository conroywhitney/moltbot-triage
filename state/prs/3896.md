---
number: 3896
title: "feat(model-provider): NEAR AI model provider - private and verifiable AI inference "
author: think-in-universe
created: 2026-01-29T09:46:00Z
updated: 2026-01-29T11:22:38Z
labels: ["docs", "commands", "agents"]
additions: 519
deletions: 1
changed_files: 15
size: large
review_decision: none
reviews: [{"author":"Evrard-Nil","state":"APPROVED"},{"author":"think-in-universe","state":"COMMENTED"}]
comments_count: 2
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3896
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

# Add NEAR AI Provider Integration

## Summary

This PR adds [NEAR AI](https://near.ai/cloud) as a new model provider to Moltbot, enabling users to access privacy-focused AI inference with Intel TDX and NVIDIA TEE protection. The integration includes 8 models, authentication flow, and full provider support.

## Why NEAR AI?

NEAR AI provides **hardware-enforced privacy (TEE protected)** and **verifiable AI inference** that's essential to make the Moltbot secure and private for its users.

## What's Included

### Provider Integration
- ✅ NEAR AI provider with base URL `https://cloud-api.near.ai/v1`
- ✅ API key authentication via `NEARAI_API_KEY` environment variable
- ✅ Interactive and non-interactive onboarding support
- ✅ Model compatibility fixes (developer role → system role conversion)

### Models (8 total)

**Private (TEE-protected):**
- `zai-org/GLM-4.7` (default) - Reasoning, 131K context
- `deepseek-ai/DeepSeek-V3.1` - 128K context
- `openai/gpt-oss-120b` - Reasoning, 131K context
- `Qwen/Qwen3-30B-A3B-Instruct-2507` - 262K context
- `black-forest-labs/FLUX.2-klein-4B` - Image, 128K context

**Anonymized (proxy):**
- `anthropic/claude-sonnet-4-5` - Reasoning, 200K context
- `google/gemini-3-pro` - Reasoning, 1M context
- `openai/gpt-5.2` - Reasoning, 400K context

### Files Changed

**New Files:**
- `src/agents/nearai-models.ts` - Model catalog and provider definitions
- `docs/providers/nearai.md` - User documentation

**Modified Files (11):**
- `src/agents/model-auth.ts` - API key mapping
- `src/agents/models-config.providers.ts` - Provider resolution
- `src/agents/model-compat.ts` - Compatibility fixes
- `src/agents/model-compat.test.ts` - Test cases
- `src/commands/auth-choice-options.ts` - Auth UI options
- `src/commands/auth-choice.apply.api-providers.ts` - API key handler
- `src/commands/onboard-auth.config-core.ts` - Config functions
- `src/commands/onboard-auth.credentials.ts` - Credential storage
- `src/commands/onboard-auth.ts` - Exports
- `src/commands/onboard-types.ts` - Type definitions
- `src/commands/auth-choice.preferred-provider.ts` - Provider mapping
- `docs/providers/index.md` - Documentation links
- `docs/providers/models.md` - Documentation links

## Usage

**Get API Key:** Sign up at [cloud.near.ai](https://cloud.near.ai/) to create your API key.

```bash
# Setup
moltbot onboard --auth-choice nearai-api-key

# Use default model
moltbot chat --model nearai/zai-org/GLM-4.7 "Hello"

# List available models
moltbot models list | grep nearai
```

## Testing

- ✅ TypeScript compilation passes
- ✅ Build succeeds
- ✅ Module imports work correctly
- ✅ All integration points verified
- ✅ Tests added for model compatibility

## Notes

- Provider ID: `nearai`
- Auth choice: `nearai-api-key`
- Profile ID: `nearai:default`

## Links

- NEAR AI Cloud Introduction: https://near.ai/cloud - Learn more about NEAR AI's private inference
- Get API Keys: https://cloud.near.ai/ - Sign up and create your API key
- API URL: https://cloud-api.near.ai/v1

## Reviews

### @Evrard-Nil — APPROVED (2026-01-29)

Thanks!

### @think-in-universe — COMMENTED (2026-01-29)




## Comments

### @think-in-universe (2026-01-29)

The PR is recreated from @serrrfirat 's PR: https://github.com/moltbot/moltbot/pull/1993 since the original one is closed.

@serrrfirat @PierreLeGuen @Evrard-Nil could you please help review?

We have included the 4 new models that we have released yesterday.

- black-forest-labs/FLUX.2-klein-4B - Image, 128K context
- anthropic/claude-sonnet-4-5 - Reasoning, 200K context
- google/gemini-3-pro - Reasoning, 1M context
- openai/gpt-5.2 - Reasoning, 400K context


### @think-in-universe (2026-01-29)

@sebslight could you please help review this PR if you get a chance? 

We recreate the PR https://github.com/moltbot/moltbot/pull/1993 from the latest main branch.


## Stats

- **Size:** large (519+, 1-, 15 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
