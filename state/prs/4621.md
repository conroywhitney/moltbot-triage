---
number: 4621
title: "Refactor Dockerfile for improved dependency management"
author: ga-it
created: 2026-01-30T12:08:45Z
updated: 2026-01-30T12:08:55Z
labels: ["docker"]
additions: 92
deletions: 22
changed_files: 1
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4621
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

Updated Dockerfile to install dependencies and set up environment for pnpm and Bun. Adjusted user permissions and added Homebrew installation.

Hi maintainers,

This PR amends the Dockerfile to make OpenClaw skill installation reliable across Linux platforms and to address recent Go toolchain requirements.

Summary of changes

Replace Debian golang-go with upstream Go tarball (pinned)
Some skills (e.g., blogwatcher) declare go 1.24.0 in go.mod. Debian Bookworm’s golang-go lags and fails with invalid go version '1.24.0'. The Dockerfile now installs Go from the official upstream tarball, pinned via GO_VERSION, and selects the correct archive using dpkg --print-architecture (supports amd64 and arm64).

Ensure tool discovery for skill installers
Adds stable shims:

brew → /usr/local/bin/brew

bun/bunx → /usr/local/bin/bun and /usr/local/bin/bunx
This addresses cases where installers/subprocesses run with a sanitised PATH and incorrectly report “brew not installed” / “go not installed”.

Keep pnpm deterministic via Corepack (enabled as root)
corepack enable must run as root to create /usr/local/bin/pnpm symlinks. Global pnpm bin directory is configured to a stable location (/usr/local/share/pnpm).

Motivation / background

During openclaw-cli onboard, several skills failed with:

go.mod:3: invalid go version '1.24.0' (Go too old)

“brew not installed” (brew present but not discoverable by installer environment)

This PR makes the image resilient by:

providing the required Go toolchain version; and

ensuring brew/bun are discoverable even when PATH is restricted.

Testing

Built and ran onboarding successfully on Linux:

docker build -t openclaw:local .

docker compose run --rm openclaw-cli onboard --no-install-daemon

Verified:

go version reports go1.24.0

brew --version, bun -v, pnpm -v available in the container

Notes

Go is pinned for reproducibility (ARG GO_VERSION=1.24.0).

The arch-selection is portable across amd64 and arm64.

Happy to adjust version pinning strategy (e.g., default to latest patch of 1.24.x) if preferred.

Thanks.

## Reviews


## Comments


## Stats

- **Size:** medium (92+, 22-, 1 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: (none detected)
