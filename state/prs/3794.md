---
number: 3794
title: "fix(browser-tool): disallow close without targetId to avoid unsafe tab ownership"
author: JaydenLiang
created: 2026-01-29T05:53:43Z
updated: 2026-01-29T08:05:16Z
labels: ["agents"]
additions: 39
deletions: 1
changed_files: 2
size: small
review_decision: none
reviews: []
comments_count: 1
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3794
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## PR Description

### Background

The browser tool previously allowed the close action to fall back to closing the active tab when no `targetId` was provided.  
This implicit behavior relies on global browser state and does not establish clear ownership of the tab being closed.

While convenient, this pattern is unsafe in both concurrent automation scenarios and human-driven Chrome relay usage.

---

### Problem

Without an explicit `targetId`:

- Tab ownership cannot be reliably inferred.
- In concurrent runs, one task may accidentally close a tab created or used by another task.
- In Chrome relay (human-driven) scenarios, the tool may close a user-owned tab that was never explicitly authorized for closure.

This makes `close` a non-deterministic and potentially destructive action.

---

### Changes

- Enforce an explicit `targetId` for the `close` action.
- Remove the implicit fallback to closing the active tab.
- Fail fast with a clear error message when `close` is invoked without a `targetId`.

This makes tab closure deterministic and ownership-safe across all browser profiles.

---

### Impact

- **Breaking change (intentional):** callers must now track and supply `targetId` when closing tabs.
- Developers and users need to maintain the tabs related to their uses.
- Improves safety and predictability in concurrent agent runs.
- Prevents accidental tab closure in Chrome relay / human-driven scenarios.
- Aligns destructive browser actions with explicit ownership semantics.

---

### Unit test

Test cases for the changes are included.

---

### Notes / Follow-ups

- Other browser actions remain unchanged.
- This PR establishes a precedent that destructive actions must be explicit and ownership-aware.
- Documentation and examples may be updated in follow-up PRs if needed.

## Reviews


## Comments

### @JaydenLiang (2026-01-29)

Fixes #3605 


## Stats

- **Size:** small (39+, 1-, 2 files)
- **Age:** 1 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
