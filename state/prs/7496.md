---
number: 7496
title: "feat: add copy-templates script and workspace template resolution"
author: ThinkIbrokeIt
created: 2026-02-02T22:08:49Z
updated: 2026-02-02T23:34:19Z
labels: ["docs", "cli", "scripts", "commands", "agents"]
additions: 2615
deletions: 746
changed_files: 16
size: huge
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 3
reactions_total: 1
ci_status: passing
mergeable: false
draft: false
url: https://github.com/openclaw/openclaw/pull/7496
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

This PR adds the `scripts/copy-templates.ts` utility, includes it in the build, and adds tests and workspace template resolution behavior.

Files of interest:
- `scripts/copy-templates.ts` (+ test)  
- `src/agents/workspace.ts` (+ test)

Tests pass locally (`src/scripts/copy-templates.test.ts`).

Notes:
- This is primarily a tooling addition (templates copy + tests). Recommend @joshp123 for review (workspace / Nix familiarity).
- Backup branch with original commits: `backup/feat/pwsh-completion-install-uninstall-before-reset`.

/cc @joshp123

## Reviews

### @greptile-apps — COMMENTED (2026-02-02)

<sub>4 files reviewed, 10 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @greptile-apps (2026-02-02)

<details>
<summary>Additional Comments (1)</summary>

**`src/agents/workspace.ts`**
**Behavior change: Error handling weakened**

In the base version, `loadTemplate()` catches errors silently with empty catch block, but throws an informative error message. The new version at line 82 catches the error in a variable `err` but never uses it - the throw statement on line 83-85 still doesn't include the actual error details.

While not strictly a bug introduced by this PR (the pattern existed before), the comment at line 82 `catch (err)` suggests intention to use it. The error message remains uninformative when the template file exists but cannot be read (permissions, encoding issues, etc.).

<details><summary>Prompt To Fix With AI</summary>

`````markdown
This is a comment left during a code review.
Path: src/agents/workspace.ts
Line: 75:87

Comment:
**Behavior change: Error handling weakened**

In the base version, `loadTemplate()` catches errors silently with empty catch block, but throws an informative error message. The new version at line 82 catches the error in a variable `err` but never uses it - the throw statement on line 83-85 still doesn't include the actual error details.

While not strictly a bug introduced by this PR (the pattern existed before), the comment at line 82 `catch (err)` suggests intention to use it. The error message remains uninformative when the template file exists but cannot be read (permissions, encoding issues, etc.).

How can I resolve this? If you propose a fix, please make it concise.
`````
</details>
</details>

### @ThinkIbrokeIt (2026-02-02)

Requesting review from @joshp123 for the workspace/template behavior; tests pass locally (`src/scripts/copy-templates.test.ts`).

### @ThinkIbrokeIt (2026-02-02)

Auto-merge attempt blocked: this PR's mergeable_state is `dirty` (merge conflicts) and cannot be merged automatically. Please rebase or resolve conflicts against `main` and reopen for auto-merge. Marking this PR as **blocked** for auto-merge.

@joshp123 @steipete — FYI.


## Stats

- **Size:** huge (2615+, 746-, 16 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: (none detected)
