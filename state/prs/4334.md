---
number: 4334
title: "feat(security): add 'moltbot security wrap' CLI for external content protection [AI-assisted]"
author: marciob
created: 2026-01-30T03:11:38Z
updated: 2026-01-30T03:14:02Z
labels: ["cli"]
additions: 129
deletions: 1
changed_files: 2
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4334
fixes_issues: [4329]
related_prs: [4329]
duplicate_of: null
---

## Description

## Summary

Adds a new CLI subcommand `moltbot security wrap` that wraps external content with security boundaries, making the existing `wrapExternalContent()` function accessible for skills and manual API calls.

This addresses the gap identified in #4329 where external content protection only applies to inbound hooks, not to content agents fetch manually.

## AI Disclosure ðŸ¤–

- **AI-assisted:** Yes, generated with Claude (Moltbot agent)
- **Testing level:** Untested (builds not verified locally due to environment constraints)
- **Code understanding:** Yes - the code registers a new subcommand under `security` that reads content from stdin or URL, passes it through existing `wrapExternalContent()` and `detectSuspiciousPatterns()` functions, and outputs wrapped content with security boundaries

## Features

- Wrap content from stdin or fetch from URL
- Detect suspicious patterns (prompt injection attempts) and warn
- Output wrapped content with security warnings
- JSON output option with metadata
- Customizable source labels

## Usage

```bash
# Wrap piped content
echo "{\"data\": \"test\"}" | moltbot security wrap --stdin --source api

# Fetch and wrap URL
moltbot security wrap --url https://api.example.com/data

# Common pattern for skills
curl -s https://external-api.com | moltbot security wrap --stdin --source "external-api"
```

## Implementation

- New file: `src/cli/security-wrap-cli.ts`
- Registers under existing `security` command
- Uses existing `wrapExternalContent()` and `detectSuspiciousPatterns()` functions

## Checklist

- [x] PR focused on one thing
- [x] Described what & why
- [x] AI-assisted marked
- [ ] Tested locally (needs verification)
- [ ] Linter run

Closes #4329

## Reviews


## Comments


## Stats

- **Size:** medium (129+, 1-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #4329
