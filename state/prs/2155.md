---
number: 2155
title: "feat: add modelverse provider"
author: mfzzf
created: 2026-01-26T09:29:56Z
updated: 2026-01-28T23:25:12Z
labels: ["docs", "cli", "commands", "agents"]
additions: 551
deletions: 1
changed_files: 18
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 3
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2155
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

# 特性更新：支持 Modelverse (UCloud) 模型提供方

## 核心背景 / 目标
新增 **Modelverse (UCloud)** 作为 Clawdbot 的 OpenAI 兼容模型提供方。用户可以通过环境变量 `MODELVERSE_API_KEY` 或交互式 `onboarding` 向导快速完成鉴权。提供内置的模型目录，实现开箱即用的体验。

---

## 变更内容

### 1. 新增 Provider 核心逻辑
*   **新增 Provider**: `modelverse`
*   **Base URL**: `https://api.modelverse.cn/v1`
*   **默认模型**: `modelverse/gpt-5.2`
*   **模型定义**:
    *   新增 `modelverse-models.ts`：定义内置模型 Catalog 及 `buildModelverseModelDefinition` 工具函数。
*   **自动注入（Implicit Providers）**:
    *   修改 `models-config.providers.ts`：当检测到 `MODELVERSE_API_KEY` 环境变量或认证档案时，自动生成 `models.providers.modelverse` 配置并注入模型列表。
    *   修改 `model-auth.ts`：补充 `resolveEnvApiKey("modelverse")` 逻辑，映射至 `MODELVERSE_API_KEY`。

### 2. Onboarding / 鉴权流程支持
*   **配置项扩展**:
    *   `onboard-types.ts`: 新增 `modelverse-api-key` 选项及 `--modelverse-api-key` 命令行参数。
    *   `register.onboard.ts`: 在 `--auth-choice` 与相关帮助文案中加入 `modelverse`。
    *   `auth-choice-options.ts`: 在 Auth 选项分组中新增 **Modelverse** 类别。
*   **逻辑实现**:
    *   `auth-choice.apply.api-providers.ts`: 支持 `tokenProvider=modelverse` 自动路由至 API Key 流程。
    *   `onboard-auth.credentials.ts`: 新增 `setModelverseApiKey` 方法，支持将 Key 写入 `auth-profiles.json`。
    *   `onboard-auth.config-core.ts`: 新增 `applyModelverseProviderConfig` 与 `applyModelverseConfig`，处理 Provider 写入及默认模型设置。
    *   `auth-choice.ts`: 完善非交互式流程（支持从环境变量、Flag 或 Profile 三种来源获取配置）。

### 3. 文档更新
*   **新增**: `docs/providers/modelverse.md`
*   **补充**: 更新 `model-providers.md`、`index.md` 和 `models.md`，添加 Modelverse 的入口说明与配置示例。

### 4. 测试覆盖
*   **Provider 测试**: 新增 `models-config.providers.modelverse.test.ts`。
*   **映射测试**: 在 `auth-choice.test.ts` 中增加 `modelverse-api-key` 的映射覆盖测试。

---

## 使用方式

### 方式 A：通过命令行向导配置（推荐）
执行以下命令并按照提示输入 API Key：
```bash
clawdbot onboard --auth-choice modelverse-api-key
```

### 方式 B：通过环境变量
直接设置环境变量即可开始使用：
```bash
export MODELVERSE_API_KEY="your_api_key_here"
clawdbot chat --model modelverse/gpt-5.2
```

---

## Reviews


## Comments


## Stats

- **Size:** large (551+, 1-, 18 files)
- **Age:** 4 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
