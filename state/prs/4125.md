---
number: 4125
title: "feat(whatsapp): Add reply-based activation modes for groups"
author: rodrigogs
created: 2026-01-29T18:30:50Z
updated: 2026-01-30T16:47:38Z
labels: ["docs", "channel: whatsapp-web", "gateway"]
additions: 45
deletions: 15
changed_files: 10
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4125
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## üéØ Overview

This PR adds more granular control over WhatsApp group activation by introducing three new modes alongside the existing `mention` and `always` modes.

## ‚ú® New Activation Modes

- **`replies`**: Bot only responds when someone replies to one of its messages
- **`mention+replies`**: Bot responds to @mentions OR replies (most flexible)
- **`never`**: Bot never responds except for control commands from owners

## üîß Implementation

### Changes Made:
1. Extended `GroupActivationMode` type with new options
2. Enhanced group-gating logic to detect replies using both JID and E.164 matching
3. Updated command help text across TUI, ACP, and chat interfaces
4. Updated documentation in `docs/channels/whatsapp.md`

### Files Modified:
- `src/auto-reply/group-activation.ts` - Type definitions
- `src/web/auto-reply/monitor/group-gating.ts` - Reply detection logic
- `src/tui/commands.ts`, `src/tui/tui-command-handlers.ts` - TUI help
- `src/acp/commands.ts` - ACP command descriptions
- `src/auto-reply/reply/commands-session.ts` - Chat command help
- `docs/channels/whatsapp.md` - User documentation

## üí° Use Cases

### `replies` mode:
Ideal for busy groups where you want the bot to stay quiet unless directly engaged. When someone replies to a bot message, it indicates they want to continue the conversation.

### `mention+replies` mode:
Most natural conversation flow - start with @mention, then continue by replying to bot messages without needing to mention it repeatedly.

### `never` mode:
Temporarily disable the bot in a group without removing it. Control commands from owners still work.

## üß™ Testing

Manual testing verified:
- Reply detection works correctly with both JID and E.164 matching
- All activation modes function as expected
- Command help messages display correctly
- Backwards compatibility maintained (existing `mention` and `always` modes unchanged)

## üìù Notes

- Reply detection uses the existing `replyToSenderJid` and `replyToSenderE164` fields from Baileys
- The implementation is platform-specific to WhatsApp (uses Baileys structures)
- Control commands from owners bypass activation modes (existing behavior preserved)

## Reviews


## Comments


## Stats

- **Size:** medium (45+, 15-, 10 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: (none detected)
