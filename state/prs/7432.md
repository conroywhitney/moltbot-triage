---
number: 7432
title: "Comprehensive Ollama Support PR"
author: charlieduzstuf
created: 2026-02-02T20:27:48Z
updated: 2026-02-02T23:08:38Z
labels: ["cli", "commands", "agents"]
additions: 499
deletions: 8
changed_files: 14
size: large
review_decision: none
reviews: [{"author":"copilot-pull-request-reviewer","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/7432
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

Takes most/all of the Ollama PRs and merges them into 1 more managable PR.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR consolidates Ollama onboarding and provider support by:
- Adding an interactive auth choice handler for Ollama plus a non-interactive `--ollama-base-url` path.
- Introducing a native Ollama client (`/api/chat` + `/api/tags`) with unit tests.
- Changing provider resolution to auto-discover a local Ollama instance and populate an `ollama` provider when models are detected.

The changes fit into the existing onboarding/auth-choice flow (`src/commands/onboard-*`) and provider discovery (`src/agents/models-config.providers.ts`) by treating Ollama as an OpenAI-compatible provider and wiring it into the same config/profile mechanisms used by other providers.

<h3>Confidence Score: 3/5</h3>

- This PR looks reasonably safe to merge, but has a few integration mismatches that could cause confusing behavior in real Ollama setups.
- Core changes are straightforward and covered by unit tests for the new native client, but thereâ€™s a likely sentinel mismatch for the local API key (`ollama` vs `ollama-local`) and provider discovery now introduces a network probe during implicit provider resolution, which could degrade UX when Ollama isnâ€™t running.
- src/commands/onboard-auth.models.ts, src/agents/models-config.providers.ts, src/commands/onboard-auth.config-core.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @copilot-pull-request-reviewer â€” COMMENTED (2026-02-02)

## Pull request overview

This PR adds comprehensive Ollama support to the codebase, enabling users to configure and use Ollama for local and cloud-based model execution.

**Changes:**
- Added native Ollama API provider implementation with tool call support and availability checks
- Integrated Ollama as a new authentication choice in the onboarding flow
- Implemented automatic model discovery for local Ollama instances

### Reviewed changes

Copilot reviewed 14 out of 14 changed files in this pull request and generated 2 comments.

<details>
<summary>Show a summary per file</summary>

| File | Description |
| ---- | ----------- |
| src/providers/ollama-native.ts | Core Ollama provider implementation with chat and availability check functions |
| src/providers/ollama-native.test.ts | Comprehensive test suite for Ollama native provider functionality |
| src/commands/onboard-types.ts | Added "ollama" as a valid auth choice type |
| src/commands/onboard-non-interactive/local/auth-choice.ts | Non-interactive Ollama setup with base URL configuration |
| src/commands/onboard-auth.ts | Exported Ollama configuration functions and constants |
| src/commands/onboard-auth.models.ts | Defined Ollama base URL and default API key constants |
| src/commands/onboard-auth.credentials.ts | Added credential storage function for Ollama |
| src/commands/onboard-auth.config-core.ts | Implemented Ollama provider configuration logic |
| src/commands/auth-choice.preferred-provider.ts | Mapped "ollama" auth choice to provider |
| src/commands/auth-choice.apply.ts | Registered Ollama auth choice handler |
| src/commands/auth-choice.apply.ollama.ts | Interactive Ollama setup with auto-detection |
| src/commands/auth-choice-options.ts | Added Ollama to auth choice UI options |
| src/cli/program/register.onboard.ts | Added CLI flag for Ollama base URL |
| src/agents/models-config.providers.ts | Auto-discovery of Ollama provider when available |
</details>






---

ðŸ’¡ <a href="/openclaw/openclaw/new/main/.github/instructions?filename=*.instructions.md" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Add Copilot custom instructions</a> for smarter, more guided reviews. <a href="https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Learn how to get started</a>.

### @greptile-apps â€” COMMENTED (2026-02-02)

<sub>4 files reviewed, 4 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** large (499+, 8-, 14 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: (none detected)
