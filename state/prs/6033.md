---
number: 6033
title: "fix(app:macos): „Äê OpenClaw ‚áÑ clawdbot „Äë-  Peekaboo Bridge discovery after the OpenClaw rename"
author: lumpinif
created: 2026-02-01T06:35:53Z
updated: 2026-02-02T16:17:26Z
labels: ["app: macos"]
additions: 50
deletions: 0
changed_files: 1
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"chatgpt-codex-connector","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"},{"author":"lumpinif","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 5
reactions_total: 2
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6033
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
- Fix Peekaboo Bridge discovery after the OpenClaw rename by keeping the canonical socket at ~/Library/Application Support/OpenClaw/bridge.sock.
- Create/repair legacy compatibility symlinks at ~/Library/Application Support/clawdbot/bridge.sock and ~/Library/Application Support/clawdis/bridge.sock so older Peekaboo CLI builds keep connecting.
- Harden legacy paths by replacing stale entries and enforcing 0700 permissions.

## Testing
- pnpm lint

## AI assistance
- AI-assisted (Codex).

## Reviews

### @greptile-apps ‚Äî COMMENTED (2026-02-01)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @chatgpt-codex-connector ‚Äî COMMENTED (2026-02-01)


### üí° Codex Review

Here are some automated review suggestions for this pull request.

**Reviewed commit:** `e0ea25ac1f`
    

<details> <summary>‚ÑπÔ∏è About Codex in GitHub</summary>
<br/>

[Your team has set up Codex to review pull requests in this repo](http://chatgpt.com/codex/settings/general). Reviews are triggered when you
- Open a pull request for review
- Mark a draft as ready
- Comment "@codex review".

If Codex has suggestions, it will comment; otherwise it will react with üëç.




Codex can also answer questions or update the PR. Try commenting "@codex address that feedback".
            
</details>

### @greptile-apps ‚Äî COMMENTED (2026-02-01)

<sub>1 file reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @greptile-apps ‚Äî COMMENTED (2026-02-01)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @lumpinif ‚Äî COMMENTED (2026-02-01)



### @greptile-apps ‚Äî COMMENTED (2026-02-01)

<sub>No files reviewed, no comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @lumpinif (2026-02-01)

Short update: this fixes a real-world Peekaboo Bridge discovery issue. It keeps OpenClaw as the primary socket path and now repairs the legacy clawdbot symlink if a stale file/dir/wrong link exists. Lint passes (pnpm lint).

### @lumpinif (2026-02-01)

@greptile-apps I addressed both points: the legacy directory now sets explicit 0700 permissions, and symlink target comparison is normalized to avoid repeated recreation. Please take another look.

### @greptile-apps (2026-02-01)

# Pull Request Summary

This PR fixes a compatibility issue caused by the OpenClaw rename from "clawdbot". The main problem was that older clients still look for the Peekaboo Bridge socket at the legacy path `~/Library/Application Support/clawdbot/bridge.sock`.

## What this PR does:

**File changed:** `apps/macos/Sources/OpenClaw/PeekabooBridgeHostCoordinator.swift`

### Key changes:

1. **Adds legacy socket path support**
   - Maintains the new socket at `~/Library/Application Support/OpenClaw/bridge.sock` 
   - Creates a symlink at the old location `~/Library/Application Support/clawdbot/bridge.sock` pointing to the new socket

2. **Robust legacy path handling**
   - Creates the legacy directory structure with 0700 permissions
   - Replaces any existing files or broken symlinks at the legacy path
   - Validates existing symlinks point to the correct target before keeping them

3. **Graceful error handling**
   - Logs failures but doesn't crash if symlink creation fails
   - Uses debug-level logging to avoid noise

## Impact:
- Ensures backward compatibility for older clients during the transition period
- Allows seamless discovery of the Peekaboo Bridge regardless of client version
- Hardens the path handling to prevent issues with stale files or incorrect permissions

The implementation is clean and follows Swift best practices with proper error handling and resource management.

### @greptile-apps (2026-02-01)

Here's an updated PR description that better reflects the actual implementation:

## Summary

This PR ensures backward compatibility for the Peekaboo Bridge socket after the OpenClaw rename by implementing automatic legacy symlink management.

### What Changed
- **Primary socket location**: Maintains the socket at `~/Library/Application Support/OpenClaw/bridge.sock`
- **Legacy compatibility**: Automatically creates and manages a symlink at `~/Library/Application Support/clawdbot/bridge.sock` 
- **Robust symlink handling**: 
  - Creates the legacy directory structure with proper 0700 permissions
  - Validates existing symlinks point to the correct destination
  - Removes stale files or incorrect symlinks before creating new ones
  - Gracefully handles errors without breaking the bridge startup

### Implementation Details
- Added `legacySocketPath` computed property for the old clawdbot socket path
- Added `ensureLegacySocketSymlink()` method called during bridge startup
- Uses `FileManager` APIs for directory creation, symlink validation, and cleanup
- Includes error handling with debug logging for troubleshooting

### Backwards Compatibility
This ensures older clients that still reference the `clawdbot` socket path can continue working without modification while the app uses its new OpenClaw branding.

## Testing
- pnpm lint

## AI assistance
- AI-assisted (Codex)

### @lumpinif (2026-02-02)

@mkbehr @levifig @hugobarauna @shanselman please review this


## Stats

- **Size:** medium (50+, 0-, 1 files)
- **Age:** 1 days
- **Last activity:** 2026-02-02

## Links

- Fixes: (none detected)
