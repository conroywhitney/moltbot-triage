---
number: 7357
title: "fix(telegram): bind webhook to loopback by default and warn on missing secret"
author: unisone
created: 2026-02-02T18:45:55Z
updated: 2026-02-02T22:05:00Z
labels: ["channel: telegram"]
additions: 93
deletions: 1
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"chatgpt-codex-connector","state":"COMMENTED"},{"author":"unisone","state":"COMMENTED"},{"author":"unisone","state":"COMMENTED"},{"author":"unisone","state":"COMMENTED"}]
comments_count: 2
reactions_total: 1
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/7357
fixes_issues: [6606]
related_prs: [6606]
duplicate_of: null
---

## Description

## Summary

Hardens Telegram webhook security with two changes:

1. **Default bind address**: Changed from `0.0.0.0` (all interfaces) to `127.0.0.1` (loopback only)
2. **Missing secret warning**: Logs a clear warning when no `webhookSecret` is configured

Fixes #6606

## Security

- **CWE**: [CWE-668](https://cwe.mitre.org/data/definitions/668.html) - Exposure of Resource to Wrong Sphere
- **CVSS**: 7.5 (High) ‚Äî `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N`

Without a secret token, any network client can send forged Telegram update payloads to the webhook endpoint, potentially hijacking bot sessions and triggering unauthorized actions.

## Changes

**`src/telegram/webhook.ts`** (2 changes, +10/-1):
- Default `host` from `0.0.0.0` ‚Üí `127.0.0.1`
- Log warning when `opts.secret` is not provided

**`src/telegram/webhook.test.ts`** (3 new tests, +58):
- Verifies default host is `127.0.0.1`
- Verifies warning logged when no secret
- Verifies no warning when secret is provided

## Backward Compatibility

Users who need external access can still explicitly set `host: "0.0.0.0"` in their config. This change only affects the default.

## Testing

All 5 tests pass (2 existing + 3 new). No changes outside the telegram webhook module.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR hardens the Telegram webhook server by changing the default bind host from `0.0.0.0` to `127.0.0.1`, reducing unintended network exposure, and adds a runtime warning when no webhook secret token is configured. Tests were added to confirm the new default host behavior and the presence/absence of the warning depending on whether a secret is supplied.

The change is localized to `src/telegram/webhook.ts`, which is used by the Telegram monitor when `useWebhook` is enabled (`src/telegram/monitor.ts`), so the security posture improves by default while still allowing explicit opt-in to external binding via `host`.

<h3>Confidence Score: 4/5</h3>

- This PR is safe to merge with low risk; changes are small, well-scoped, and covered by tests.
- Behavioral change is limited to the default bind address and an added log warning; both are straightforward and the new tests exercise the expected defaults. Minor potential for test flakiness/leaked handles remains if server shutdown isn‚Äôt awaited, and the secret warning condition may be ambiguous for empty-string secrets.
- src/telegram/webhook.test.ts (server shutdown semantics), src/telegram/webhook.ts (secret presence check semantics)

<!-- greptile_other_comments_section -->

<!-- /greptile_comment -->

## Reviews

### @greptile-apps ‚Äî COMMENTED (2026-02-02)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @chatgpt-codex-connector ‚Äî COMMENTED (2026-02-02)


### üí° Codex Review

Here are some automated review suggestions for this pull request.

**Reviewed commit:** `97bc28556e`
    

<details> <summary>‚ÑπÔ∏è About Codex in GitHub</summary>
<br/>

[Your team has set up Codex to review pull requests in this repo](http://chatgpt.com/codex/settings/general). Reviews are triggered when you
- Open a pull request for review
- Mark a draft as ready
- Comment "@codex review".

If Codex has suggestions, it will comment; otherwise it will react with üëç.




Codex can also answer questions or update the PR. Try commenting "@codex address that feedback".
            
</details>

### @unisone ‚Äî COMMENTED (2026-02-02)



### @unisone ‚Äî COMMENTED (2026-02-02)



### @unisone ‚Äî COMMENTED (2026-02-02)




## Comments

### @unisone (2026-02-02)

**CI note:** The only failing checks are `checks (node, lint)` and `checks-windows (build & lint)` ‚Äî both caused by a pre-existing `preserve-caught-error` lint violation in `src/agents/tools/nodes-tool.ts`, unrelated to this PR. All test suites pass (node, bun, Windows). Format and protocol checks pass.

### @unisone (2026-02-02)

Friendly ping ‚Äî this is ready for review whenever someone has a moment. Small, focused change (default webhook bind `0.0.0.0` ‚Üí `127.0.0.1` + warn on missing secret), 6/6 new tests passing, all CI green except the pre-existing lint issue noted above.


## Stats

- **Size:** medium (93+, 1-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: #6606
