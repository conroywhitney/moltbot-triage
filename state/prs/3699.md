---
number: 3699
title: "fix(gateway): add error handling for tailscaleCleanup in shutdown"
author: Episkey-G
created: 2026-01-29T02:33:52Z
updated: 2026-01-29T02:34:00Z
labels: ["gateway"]
additions: 6
deletions: 1
changed_files: 2
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3699
fixes_issues: []
related_prs: [2112]
duplicate_of: null
---

## Description

## Summary
Add error handling to the Tailscale cleanup operation during gateway shutdown to prevent shutdown interruptions when Tailscale cleanup fails.

## Problem
During gateway shutdown, if `tailscaleCleanup()` throws an error (e.g., Tailscale not installed, permission issues, or other runtime failures), the error would propagate and potentially interrupt the shutdown sequence, leaving the gateway in an inconsistent state.

## Solution
Wrap the `tailscaleCleanup()` call in a try-catch block to:
- Catch and log any errors during Tailscale cleanup
- Allow the shutdown sequence to continue normally even if cleanup fails
- Prevent shutdown interruptions from non-critical cleanup operations

## Changes
- Added try-catch error handling around `tailscaleCleanup()` in [server-close.ts](https://github.com/moltbot/moltbot/blob/main/src/gateway/server-close.ts)
- Errors are logged but do not block the shutdown process
- Maintains graceful shutdown behavior

## Testing
- Manual testing: shutdown works correctly when Tailscale is not installed
- Manual testing: shutdown works correctly with Tailscale running
- No changes to test files needed (shutdown error handling tested in integration)

## Rebase Note
âœ… Rebased onto latest main after Moltbot rename (2026.1.27-beta.1)
âœ… Resolved CHANGELOG conflicts  
âœ… Lint passed

Supersedes #2112 (closed due to merge conflicts)

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

## Reviews


## Comments


## Stats

- **Size:** tiny (6+, 1-, 2 files)
- **Age:** 1 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
