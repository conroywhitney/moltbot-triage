---
number: 6837
title: "feat(discord): add broadcast routing for multi-agent channels"
author: ericelizes1
created: 2026-02-02T03:34:03Z
updated: 2026-02-02T03:35:52Z
labels: ["channel: discord"]
additions: 448
deletions: 6
changed_files: 10
size: large
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6837
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
Add support for broadcasting Discord messages to multiple agents based on channel configuration. This enables shared channels where multiple agents can receive and respond to the same message.

## Config
Uses the existing `broadcast` config schema (same as WhatsApp):
```json
{
  "broadcast": {
    "strategy": "parallel",
    "<channel-id>": ["agent1", "agent2"]
  }
}
```

## Changes
- Add `discord/monitor/broadcast.ts` with routing logic
- Update `message-handler.ts` to check broadcast config before dispatch
- Reuses existing broadcast config schema for consistency with WhatsApp

## Use Case
Multi-agent Discord setups where multiple agents need to monitor and potentially respond to the same channel (e.g., a shared #product channel where both a manager and an engineer agent participate).

## Behavior
- Messages in configured channels are dispatched to ALL listed agents
- Each agent processes independently and decides whether to respond
- Strategy can be 'parallel' (default) or 'sequential'
- Falls back to normal single-agent routing if channel not in broadcast config

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

Adds Discord broadcast routing so a single inbound channel can fan out to multiple agents (parallel/sequential) using the existing `cfg.broadcast` mapping. Introduces a Discord webhook sender and per-agent `agent.discord.responseWebhook` config, then plumbs `agentId` through outbound delivery so Discord replies can be routed via an agent’s webhook identity when configured.

<h3>Confidence Score: 3/5</h3>

- This PR is likely safe to merge but has a couple routing/compat edge cases worth fixing first.
- Core changes are straightforward and reuse existing broadcast semantics, but there are a few places where small mismatches can cause silent misrouting (overwriting `matchedBy`, agentId normalization differences, and webhook URL param handling).
- src/discord/monitor/broadcast.ts, src/channels/plugins/outbound/discord.ts, src/discord/send.webhook.ts

<!-- greptile_other_comments_section -->

<sub>(3/5) Reply to the agent's comments like "Can you suggest a fix for this @greptileai?" or ask follow-up questions!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-02)

<sub>3 files reviewed, 3 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** large (448+, 6-, 10 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: (none detected)
