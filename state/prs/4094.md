---
number: 4094
title: "feat(hooks): add cleanup option for webhook hook sessions"
author: tmchow
created: 2026-01-29T17:28:09Z
updated: 2026-01-30T01:56:19Z
labels: ["docs", "gateway"]
additions: 830
deletions: 10
changed_files: 13
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: false
draft: false
url: https://github.com/openclaw/openclaw/pull/4094
fixes_issues: [3890]
related_prs: [2725,3890]
duplicate_of: null
---

## Description

## Summary
- Add `cleanup` and `cleanupDelayMinutes` options to webhook hook mappings for automatic session cleanup
- Sessions with `cleanup: "delete"` are automatically removed after hook completion
- Configurable delay allows debugging/auditing before cleanup
- Registry-based cleanup with sweeper pattern (60s interval) for reliability

Fixes #3890 #2725

## Test plan
- [x] Verify `cleanup: "delete"` deletes session after hook completes
- [x] Verify `cleanup: "keep"` (default) preserves session
- [x] Verify `cleanupDelayMinutes` delays cleanup appropriately
- [x] Verify failed cleanups retry on next sweep
- [x] Verify crash recovery restores pending cleanups

## Reviews


## Comments


## Stats

- **Size:** large (830+, 10-, 13 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #3890
