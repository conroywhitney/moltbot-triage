---
number: 3057
title: "Fix TUI footer to show the actual model you're using"
author: suryaansh001
created: 2026-01-28T01:15:15Z
updated: 2026-02-03T03:54:56Z
labels: ["gateway"]
additions: 3
deletions: 2
changed_files: 1
size: tiny
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 1
reactions_total: 2
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3057
fixes_issues: [3043]
related_prs: [3043]
duplicate_of: null
---

## Description

[When you switch models via /models, the footer was still showing the old provider name instead of updating to show what you just selected. This was confusing because the token stats were live but the model name was stuck on the default.](https://github.com/moltbot/moltbot/issues/3043)
Closes #3043 

The issue was that the footer reads from the session list, which only looked at model/modelProvider fields (set after agent runs). When you manually switch models, it actually sets providerOverride/modelOverride instead, so we need to resolve the effective model considering those overrides.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates the gateway session listing to display the *effective* model/provider in the TUI footer by resolving `modelOverride`/`providerOverride` from the session entry and falling back to the configured defaults via `resolveConfiguredModelRef`. The change is localized to `src/gateway/session-utils.ts` and affects the `listSessionsFromStore` output fields `modelProvider` and `model`, which the footer uses to render the active model name.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge and fixes the footer model display, with a small type/edge-case concern around potentially undefined model/provider.
- Change is small and well-scoped, and the override resolution matches the described bug. The main concern is `resolveSessionModelRef` declaring it always returns strings while its inputs can likely yield undefined values, which could surface as missing model/provider in the UI or mismatched types downstream.
- src/gateway/session-utils.ts (resolveSessionModelRef return typing/defaulting)

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps â€” COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @greptile-apps (2026-02-03)

<details>
<summary>Additional Comments (1)</summary>

**`src/gateway/session-utils.ts`**
[P1] `resolveSessionModelRef` can return `undefined` for `provider`/`model` despite its return type.

`resolveConfiguredModelRef(...)` appears to allow `provider`/`model` to be nullable (see `getSessionDefaults` returning `resolved.provider ?? null`), but here you return `{ provider, model }` as `string`. If `resolved.provider` or `resolved.model` is undefined, `listSessionsFromStore` will emit `modelProvider/model` as undefined even though callers likely expect strings.

Consider either (a) making the return type `{ provider?: string; model?: string }`/nullable to match reality, or (b) forcing defaults here (e.g., `provider = provider ?? DEFAULT_PROVIDER`, `model = model ?? DEFAULT_MODEL`).

<details><summary>Prompt To Fix With AI</summary>

`````markdown
This is a comment left during a code review.
Path: src/gateway/session-utils.ts
Line: 466:482

Comment:
[P1] `resolveSessionModelRef` can return `undefined` for `provider`/`model` despite its return type.

`resolveConfiguredModelRef(...)` appears to allow `provider`/`model` to be nullable (see `getSessionDefaults` returning `resolved.provider ?? null`), but here you return `{ provider, model }` as `string`. If `resolved.provider` or `resolved.model` is undefined, `listSessionsFromStore` will emit `modelProvider/model` as undefined even though callers likely expect strings.

Consider either (a) making the return type `{ provider?: string; model?: string }`/nullable to match reality, or (b) forcing defaults here (e.g., `provider = provider ?? DEFAULT_PROVIDER`, `model = model ?? DEFAULT_MODEL`).

How can I resolve this? If you propose a fix, please make it concise.
`````
</details>
</details>


## Stats

- **Size:** tiny (3+, 2-, 1 files)
- **Age:** 5 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #3043
