---
number: 4127
title: "feat(agents): support OpenRouter image generation models"
author: deucebucket
created: 2026-01-29T18:37:58Z
updated: 2026-01-29T18:38:11Z
labels: ["agents"]
additions: 206
deletions: 18
changed_files: 6
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: false
draft: false
url: https://github.com/openclaw/openclaw/pull/4127
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

Add support for extracting and saving generated images from OpenRouter models that return images (like `gpt-5-image-mini`).

## Changes

- Add `extractAssistantImages()` utility to extract base64 images from assistant responses
- Save generated images using standard media store (in "generated" subdirectory)
- Send generated images to users via message channels automatically
- Support both direct agent responses and subagent image generation

## How it works

When using an OpenRouter model that returns images (like `openai/gpt-5-image-mini`), the agent now:
1. Extracts base64 image data from the response
2. Saves images to `~/.moltbot/media/generated/`
3. Sends the images to the user along with any text response

Works with both:
- Direct agent conversations (image appears in chat)
- Subagent tasks via `sessions_spawn({ model: "ImageGen", ... })`

## Testing

- [x] Lint passes
- [x] Build passes
- [x] Tested locally with gpt-5-image-mini

## Notes

- AI-assisted (Claude) - code reviewed and tested by human
- Uses existing `saveMediaBuffer` from media store for proper path handling
- No hardcoded paths - works on any moltbot installation

## Reviews


## Comments


## Stats

- **Size:** large (206+, 18-, 6 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
