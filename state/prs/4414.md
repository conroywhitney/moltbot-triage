---
number: 4414
title: "fix: slug-generator respects configured default model instead of hardcoded Opus"
author: spiceoogway
created: 2026-01-30T06:02:26Z
updated: 2026-01-30T07:10:47Z
labels: ["agents"]
additions: 450
deletions: 6
changed_files: 5
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4414
fixes_issues: [4315]
related_prs: [4315]
duplicate_of: null
---

## Description

## Summary

Fixes #4315.

The `llm-slug-generator` embedded run was hardcoded to fall back to `DEFAULT_MODEL` (`claude-opus-4-5`) because it never passed a `model` param to `runEmbeddedPiAgent()`. This caused unexpected Opus billing on every `/new` command, even when users configured a different default model via `agents.defaults.model.primary`.

## Changes

- Import `resolveDefaultModelForAgent` from `model-selection.ts`
- Resolve the user's configured default model before calling `runEmbeddedPiAgent()`
- Pass the resolved model to the embedded run

When no model is configured, `runEmbeddedPiAgent` still falls back to `DEFAULT_MODEL` as before â€” so this is fully backward-compatible.

## Testing

- TypeScript compiles clean (`tsc --noEmit`)
- Prettier passes
- Minimal, surgical change (6 lines added)

## Reviews


## Comments


## Stats

- **Size:** large (450+, 6-, 5 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #4315
