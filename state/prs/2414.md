---
number: 2414
title: "fix(slack): route DM replies to original channel, not App Home"
author: mbennett37
created: 2026-01-26T22:25:05Z
updated: 2026-02-03T03:57:39Z
labels: ["channel: slack"]
additions: 4
deletions: 1
changed_files: 1
size: tiny
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2414
fixes_issues: [2412]
related_prs: [2412]
duplicate_of: null
---

## Description

Fixes #2412

## Problem
When @mentioned in a DM between two other users (User A ↔ User B), the bot replies to App Home instead of the original DM.

## Root Cause
`prepare.ts:440` sets `slackTo = user:${message.user}` for DMs.

In `send.ts:81`, `user:X` targets trigger:
```typescript
await client.conversations.open({ users: recipient.id })
```
This opens a **new** bot↔user DM (App Home), not the original channel.

## Fix
Always use `channel:${message.channel}` — the Slack API accepts channel IDs for all conversation types (channels, DMs, MPIMs).

`lastRoute` tracking (line 538) intentionally still uses `user:X` for identity/session purposes.

## Testing
- [x] Verified code path in `send.ts` confirms `user:` prefix triggers `conversations.open`
- [x] Manual test: @mention bot in DM between two other users

Co-Authored-By: Warp <agent@warp.dev>

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR fixes Slack DM reply routing by always setting `To`/`OriginatingTo` to `channel:${message.channel}` in `src/slack/monitor/message-handler/prepare.ts`, preventing the downstream Slack sender from treating DMs as `user:` targets (which triggers `conversations.open` and creates a new bot↔user DM/App Home). Session/identity tracking via `lastRoute` remains keyed by `user:${message.user}` for DM contexts.


<h3>Confidence Score: 5/5</h3>

- This PR is safe to merge with minimal risk.
- Change is localized to Slack inbound message preparation and aligns with Slack’s API expectations: replies are now always sent to the original channel ID, avoiding the unintended `conversations.open` path that created a new bot↔user DM. No broader behavior changes beyond DM routing are apparent.
- src/slack/monitor/message-handler/prepare.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** tiny (4+, 1-, 1 files)
- **Age:** 7 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #2412
