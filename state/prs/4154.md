---
number: 4154
title: "fix(control-ui): preserve URL session parameter over localStorage defaults"
author: joeyfrasier
created: 2026-01-29T19:37:17Z
updated: 2026-01-29T19:37:30Z
labels: ["app: web-ui"]
additions: 12
deletions: 0
changed_files: 2
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4154
fixes_issues: [4150]
related_prs: [4150]
duplicate_of: null
---

## Description

## Summary

When opening the dashboard with a `?session=` URL parameter, the session was being overwritten by `applySessionDefaults()` after the gateway connected. This broke direct links to specific sessions.

## Problem

External tools (like Kanban boards with per-project sessions) open dashboard URLs like:
```
/chat?session=agent:main:project-6
```

The URL session was correctly parsed in `applySettingsFromUrl()`, but then immediately overwritten when `applySnapshot()` â†’ `applySessionDefaults()` ran after the gateway connection succeeded.

## Solution

Added a `sessionFromUrl` flag that's set when a session is explicitly provided via URL parameter. The `applySessionDefaults()` function now checks for this flag and skips overriding URL-provided sessions.

The flag is cleared after the first connection so that future reconnects can apply defaults if needed.

## Testing

- Verified typecheck passes (`npx tsc --noEmit`)
- Manual testing: open `/chat?session=agent:main:project-X` and verify the correct session loads

Fixes #4150

## Reviews


## Comments


## Stats

- **Size:** small (12+, 0-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: #4150
