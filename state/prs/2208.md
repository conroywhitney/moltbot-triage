---
number: 2208
title: "fix: validate E.164 format for Signal account number during onboarding"
author: Duartemartins
created: 2026-01-26T12:13:32Z
updated: 2026-02-03T03:57:58Z
labels: ["channel: signal"]
additions: 10
deletions: 2
changed_files: 1
size: small
review_decision: none
reviews: [{"author":"copilot-pull-request-reviewer","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2208
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

- Add proper E.164 phone number validation to Signal account prompt during onboarding
- Normalize the account value before storing to ensure consistent format

## Problem

The Signal account number prompt only validated that *some* text was entered:

```typescript
validate: (value) => (value?.trim() ? undefined : "Required"),
```

This allowed invalid values like `"ok"` to be stored if a user typed it thinking they were confirming a prompt. The Signal channel would then fail with confusing errors since `"ok"` isn't a valid phone number.

## Solution

Use the existing `normalizeE164` utility to validate the input is a proper E.164 phone number, and provide a helpful error message:

```
Invalid E.164 phone number (must start with + and country code, e.g. +15555550123)
```

Also normalize the stored value to ensure consistent format.

## Test plan

- [ ] Run `clawdbot configure` and select Signal channel
- [ ] Try entering invalid values like "ok", "test", "12345" - should show validation error
- [ ] Enter valid E.164 number like "+15555550123" - should be accepted
- [ ] Verify stored value in `clawdbot.json` is properly formatted

ü§ñ Generated with [Claude Code](https://claude.com/claude-code)

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates Signal onboarding (`src/channels/plugins/onboarding/signal.ts`) to require an E.164-formatted ‚ÄúSignal bot number‚Äù instead of only checking for non-empty input, and then normalizes the value before storing it.

The change fits into the existing onboarding flow by reusing the shared `normalizeE164` utility already used elsewhere to normalize phone inputs during channel setup.

<h3>Confidence Score: 2/5</h3>

- This PR is not safe to merge as-is because the new validation does not actually reject invalid inputs.
- Although the intent is correct, `normalizeE164` always returns a `+`-prefixed string, so the added validation condition never fails and invalid values can still be stored. The net effect is likely user-visible misconfiguration rather than improved onboarding.
- src/channels/plugins/onboarding/signal.ts

<!-- greptile_other_comments_section -->

<!-- /greptile_comment -->

## Reviews

### @copilot-pull-request-reviewer ‚Äî COMMENTED (2026-01-26)

## Pull request overview

Adds E.164 phone number validation and normalization to the Signal account prompt during onboarding to prevent storing non-phone input.

**Changes:**
- Replaces ‚Äúnon-empty‚Äù validation with E.164 validation for the Signal bot number prompt
- Normalizes the entered account value before writing it to config





---

üí° <a href="/clawdbot/clawdbot/new/main/.github/instructions?filename=*.instructions.md" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Add Copilot custom instructions</a> for smarter, more guided reviews. <a href="https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Learn how to get started</a>.

### @greptile-apps ‚Äî COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @greptile-apps ‚Äî COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** small (10+, 2-, 1 files)
- **Age:** 7 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
