---
number: 7644
title: "Fix #6998: rate limit gateway auth"
author: coygeek
created: 2026-02-03T02:32:07Z
updated: 2026-02-03T03:05:14Z
labels: ["gateway"]
additions: 155
deletions: 0
changed_files: 7
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/7644
fixes_issues: [6998]
related_prs: [6998]
duplicate_of: null
---

## Description

## Summary
- Add in-memory rate limiting for gateway auth attempts (token/password) with exponential backoff and reset.
- Return 429 + Retry-After for rate-limited gateway HTTP auth.
- Add a unit test covering repeated failed attempts.

Fixes #6998

## Severity
- **CVSS Score**: 9.1
- **Severity**: Critical
- **Vector**: `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N`

## Testing Status
- **Command**: `pnpm build && pnpm check && pnpm test`
- **Status**: timed out after 120s and 300s during test run
- **Additional**: `pnpm vitest src/gateway/auth.test.ts` (passed)

## AI-Assisted Disclosure
This fix was generated with AI assistance (Codex).

<details>
<summary>Generation Context</summary>

**Prompt used**: N/A (manual implementation in editor)
**Verification reasoning**: N/A (no `.verdict.md` artifact)

No generation logs captured.

</details>

## Confirmation
- [ ] I reviewed the changes for correctness and security impact
- [ ] The fix addresses the vulnerability described in the issue

---
*Formatted to match OpenClaw Issue Discovery Toolkit disclosure template.*

## Reviews

### @greptile-apps â€” COMMENTED (2026-02-03)

<sub>3 files reviewed, 4 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (155+, 0-, 7 files)
- **Age:** 0 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #6998
