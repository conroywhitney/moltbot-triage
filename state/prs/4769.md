---
number: 4769
title: "fix(macOS): exec approval dialog not showing command details"
author: mattflo
created: 2026-01-30T16:54:28Z
updated: 2026-02-03T02:24:58Z
labels: ["app: macos"]
additions: 11
deletions: 26
changed_files: 1
size: small
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4769
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
- Fix exec approval dialog showing empty command box instead of actual command text
- NSAlert accessory view wasn't rendering properly due to NSTextView/sizing issues

## Changes
- Replaced complex `NSTextView` + `NSScrollView` with simple wrapping `NSTextField`
- Added explicit width constraint and `setFrameSize(fittingSize)` for NSAlert accessory view

## Before
<img width="246" height="287" alt="screenshot_20260130_092922" src="https://github.com/user-attachments/assets/5381171c-19d1-42e8-a8b6-e6187fc45f14" />

*(Dialog showed "Command" header with empty box below)*

## After
Command text displays directly as readable monospace text with context details visible.
<img width="450" height="427" alt="screenshot_20260130_094514" src="https://github.com/user-attachments/assets/ff238623-fedb-4f05-9477-9001927cf6d0" />

## Testing
- [x] Tested locally on macOS 15.3 (Sequoia)
- [x] Rebuilt app with `ALLOW_ADHOC_SIGNING=1 ./scripts/package-mac-app.sh`
- [x] Verified command text now appears in approval dialog

## Notes
- [x] AI-assisted (Claude) - fully tested and understood

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR fixes the macOS exec approval dialog so it reliably shows the command details. It simplifies the accessory view by replacing an `NSTextView`/`NSScrollView` combo with a wrapping, selectable monospaced `NSTextField`, and adds explicit sizing on the accessory `NSStackView` (fixed width + `setFrameSize(fittingSize)`) to ensure `NSAlert` renders the content consistently.

The change is localized to `ExecApprovalsPromptPresenter.buildAccessoryView` where the approval UI is assembled before `NSAlert.runModal()` is called, so it fits neatly into the existing prompt flow without affecting socket/protocol logic.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge; changes are localized to macOS UI layout code.
- The diff only modifies how the `NSAlert` accessory view is built and sized; it doesn’t touch the approval/exec protocol or persistence logic. Primary risk is UI regression across macOS versions, alert sizing, or accessibility/UX (e.g., fixed width / removed header).
- apps/macos/Sources/OpenClaw/ExecApprovalsSocket.swift

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** small (11+, 26-, 1 files)
- **Age:** 3 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
