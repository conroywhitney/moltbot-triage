---
number: 2761
title: "Security: harden gateway auth exposure"
author: devatsecure
created: 2026-01-27T13:19:48Z
updated: 2026-01-28T23:25:11Z
labels: ["gateway"]
additions: 215
deletions: 11
changed_files: 13
size: large
review_decision: none
reviews: []
comments_count: 1
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2761
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

- Add rate limiting for failed authentication attempts (10 failures within 60s triggers a 5-minute block per IP)
- Enforce minimum auth token/password length (default 24 chars) when binding beyond loopback
- Add configurable `gateway.auth.minLength` setting (8-128 chars)
- Improve startup logging to show auth strength status
- Add `sendRateLimited` (HTTP 429) response for rate-limited requests
- Extend security audit to check password length (previously only checked token)

## Test plan

- [ ] Added unit tests for `resolveGatewayRuntimeConfig` covering weak auth rejection and custom min length
- [ ] Manual testing: verify rate limiting kicks in after repeated failed auth attempts
- [ ] Manual testing: verify gateway refuses to start with short token on non-loopback bind
- [ ] Verify startup logs show auth strength (ok/weak)

## Reviews


## Comments

### @devatsecure (2026-01-27)

## CI Failure Analysis

The CI failures are **not caused by this PR**. The main branch has a pre-existing lockfile synchronization issue:

1. `extensions/memory-core/package.json` references `moltbot@>=2026.1.26` as a peerDependency
2. The `pnpm-lock.yaml` still references `clawdbot@>=2026.1.24-3`
3. The package `moltbot@>=2026.1.26` doesn't exist on npm yet

This is a result of the recent rename from `clawdbot` to `moltbot`. The main branch CI is also failing with the same error:

```
ERR_PNPM_OUTDATED_LOCKFILE  Cannot install with "frozen-lockfile" because pnpm-lock.yaml is not up to date with <ROOT>/extensions/memory-core/package.json

Failure reason:
specifiers in the lockfile don't match specifiers in package.json:
* 1 dependencies were added: moltbot@>=2026.1.26
* 1 dependencies were removed: clawdbot@>=2026.1.24-3
```

Once the main branch lockfile is regenerated/fixed, this PR should pass CI.


## Stats

- **Size:** large (215+, 11-, 13 files)
- **Age:** 2 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
