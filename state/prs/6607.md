---
number: 6607
title: "feat(web-search): add Brave Search API base URL override"
author: aloysiusmartis
created: 2026-02-01T21:32:36Z
updated: 2026-02-01T21:44:54Z
labels: ["agents"]
additions: 82
deletions: 5
changed_files: 4
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6607
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

Adds `tools.web.search.baseUrl` config option and `BRAVE_API_URL` env var to allow overriding the Brave Search API endpoint.

## Motivation

This enables self-hosted search proxies that implement the Brave API format — for example, a SearXNG adapter that translates Brave API requests to SearXNG. Consuming applications (like OpenClaw itself) need zero code changes; they just point the base URL at the proxy.

## Changes

- **`src/agents/tools/web-search.ts`** — Added `resolveBraveBaseUrl()` function that checks config → env var → default. Split hardcoded endpoint into base URL + path.
- **`src/config/types.tools.ts`** — Added `baseUrl?: string` to web search config type.
- **`src/config/schema.ts`** — Added title and description for `tools.web.search.baseUrl`.
- **`src/agents/tools/web-search.test.ts`** — Added 5 tests for base URL resolution (config, env, precedence, trailing slash handling).

## Config

```json
{
  "tools": {
    "web": {
      "search": {
        "baseUrl": "http://localhost:3015"
      }
    }
  }
}
```

Or via env var:
```bash
BRAVE_API_URL=http://localhost:3015
```

Precedence: config `baseUrl` > `BRAVE_API_URL` env > default (`https://api.search.brave.com`).

This mirrors the existing `perplexity.baseUrl` pattern.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds a configurable Brave Search API base URL override for the `web_search` tool. The Brave endpoint is split into a default base (`https://api.search.brave.com`) plus a fixed path, and `resolveBraveBaseUrl()` selects the base URL from config (`tools.web.search.baseUrl`) or `BRAVE_API_URL` env var before falling back to the default.

It also updates the config type and UI schema hints, and adds unit tests covering the base URL resolution and trailing-slash normalization. This fits the existing pattern used for Perplexity’s `baseUrl` selection in the same tool module.

<h3>Confidence Score: 4/5</h3>

- This PR is generally safe to merge; the behavior change is isolated and well-tested, with a small edge-case type issue in config handling.
- Most changes are straightforward (URL composition + config/env precedence) and include targeted tests. The main concern is `resolveBraveBaseUrl()` not type-checking `search.baseUrl`, which can throw if config contains a non-string truthy value; otherwise impact is low.
- src/agents/tools/web-search.ts (config value normalization)

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-01)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (82+, 5-, 4 files)
- **Age:** 1 days
- **Last activity:** 2026-02-01

## Links

- Fixes: (none detected)
