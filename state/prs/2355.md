---
number: 2355
title: "feat: add CIDR support for trustedProxies and Railway/cloud deployment improvement"
author: pranav-singhal
created: 2026-01-26T19:49:15Z
updated: 2026-01-28T23:25:12Z
labels: ["gateway"]
additions: 65
deletions: 5
changed_files: 2
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2355
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary                                                                                                                                
  - Add CIDR notation support for `gateway.trustedProxies` (e.g., `100.64.0.0/10`)                                                          
  - Add Dockerfile entrypoint for Railway/cloud deployments that:                                                                           
    - Fixes volume permissions for non-root container user                                                                                  
    - Creates cloud-ready default config with trustedProxies and allowInsecureAuth                                                          
                                                                                                                                            
  ## Changes                                                                                                                                
  - `src/gateway/net.ts`: Add `isIpInCidr()` function for CIDR range matching in trustedProxies                                             
  - `Dockerfile`: Add entrypoint script with gosu for permission fixes and default cloud config                                             
                                                                                                                                            
  ## Test plan                                                                                                                              
  - [ ] Deployed on Railway and verified Control UI connects with token auth                                                                
  - [ ] Verified CIDR ranges like `100.64.0.0/10` correctly match IPs like `100.64.0.3`                                                     

## Reviews


## Comments


## Stats

- **Size:** medium (65+, 5-, 2 files)
- **Age:** 3 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
