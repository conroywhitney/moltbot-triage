---
number: 6285
title: "fix(skills): deduplicate skill commands"
author: Salt-Sunny
created: 2026-02-01T13:47:09Z
updated: 2026-02-03T02:22:33Z
labels: []
additions: 49
deletions: 1
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: passing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6285
fixes_issues: []
related_prs: [5671]
duplicate_of: null
---

## Description

Re-submission of ghosted PR #5671. Deduplicates skill commands by skill name across agents.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates `listSkillCommandsForAgents` to deduplicate skill command specs by `skillName` across agents (preventing the same skill from being registered multiple times), and adjusts/adds tests to assert the new behavior, including for bundled skills via `OPENCLAW_BUNDLED_SKILLS_DIR`.

<h3>Confidence Score: 2/5</h3>

- Not safe to merge as-is because the new test has a runtime-throw bug.
- Core deduplication logic is small and looks correct, but the added test calls `writeSkill` with the wrong parameter name (`dir` instead of `workspaceDir`), which will crash when building the path and cause CI failures. Also unable to run tests locally due to missing npm in this environment, so relying on static review for other issues.
- src/auto-reply/skill-commands.test.ts

<!-- greptile_other_comments_section -->

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @greptile-apps â€” COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (49+, 1-, 2 files)
- **Age:** 1 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
