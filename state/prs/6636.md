---
number: 6636
title: "feat(onboard): add Ollama provider support"
author: BruceMacD
created: 2026-02-01T22:08:56Z
updated: 2026-02-03T00:23:53Z
labels: ["cli", "commands"]
additions: 207
deletions: 3
changed_files: 11
size: large
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 1
reactions_total: 1
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6636
fixes_issues: [3494]
related_prs: [3494]
duplicate_of: null
---

## Description

## Summary
```bash
◇  Onboarding mode
│  QuickStart
│
◇  QuickStart ─────────────────────────╮
│                                      │
│  Gateway port: 18789                 │
│  Gateway bind: Loopback (127.0.0.1)  │
│  Gateway auth: Token (default)       │
│  Tailscale exposure: Off             │
│  Direct to chat channels.            │
│                                      │
├──────────────────────────────────────╯
│
◇  Model/auth provider
│  Ollama
│
◇  Ollama auth method
│  Ollama
│
◇  Ollama ────────────────────────────────────╮
│                                             │
│  Ollama detected at http://127.0.0.1:11434  │
│                                             │
├─────────────────────────────────────────────╯
│
◇  Setup complete ─────────────────────────────────────────────────────────────────────────╮
│                                                                                          │
│  Ollama configured successfully.                                                         │
│  Models will be discovered automatically from your Ollama server.                        │
│  Use `ollama pull <model>` to download models, then `openclaw models list` to see them.  │
│                                                                                          │
├──────────────────────────────────────────────────────────────────────────────────────────╯
│
◇  Default model
│  ollama/glm-4.7:cloud
│
```

- Adds Ollama as a provider option in the onboarding wizard
- Supports both default local server (127.0.0.1:11434) and custom URLs
- Models are discovered dynamically from the Ollama server at runtime

## Test plan

- [x] Ran onboarding wizard and selected Ollama provider
- [x] Tested with default localhost URL
- [x] Tested with custom Ollama server URL

Generated partially with `Claude Code`/`Kimi-K2.5`/`Ollama`

Resolves #3494

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds **Ollama** as an onboarding auth/provider option in both interactive and non-interactive flows. It introduces a new `applyAuthChoiceOllama` handler that auto-detects a local Ollama server (via `/api/tags`), allows a custom server URL, and then writes an `ollama:default` auth profile plus an `ollama` provider entry using an OpenAI-compatible base URL (`.../v1`). It also wires the new `ollama` auth choice through option/group lists, preferred-provider resolution, CLI flags (`--ollama-base-url`), and onboarding option types.

Key integration points are the onboarding auth-choice dispatcher (`src/commands/auth-choice.apply.ts`) and the config/credential helpers in `src/commands/onboard-auth.*` used by both interactive and non-interactive onboarding.

<h3>Confidence Score: 3/5</h3>

- Reasonably safe to merge, but there are a couple of configuration/credentials edge cases worth fixing first.
- The changes are localized to onboarding/config wiring and don’t touch core runtime behavior heavily, but the non-interactive path appears to write the Ollama credential without honoring the onboarding agent directory context, and the provider-config helper unconditionally resets the provider model list which could surprise existing configs.
- src/commands/onboard-non-interactive/local/auth-choice.ts, src/commands/onboard-auth.config-core.ts

<!-- greptile_other_comments_section -->

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-01)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @greptile-apps — COMMENTED (2026-02-03)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @greptile-apps (2026-02-01)

<details>
<summary>Additional Comments (1)</summary>

**`src/commands/onboard-types.ts`**
`OnboardOptions` adds `ollamaBaseUrl?: string`, but there’s no corresponding usage in the onboarding flow or auth-choice handler in this PR (a grep only finds this type addition). If this was intended to support non-interactive onboarding, it currently won’t have any effect.

If it’s not needed, consider removing it to avoid a misleading public option; if it is needed, wire it through the non-interactive path / CLI args parsing so it actually configures the Ollama base URL.

<details><summary>Prompt To Fix With AI</summary>

`````markdown
This is a comment left during a code review.
Path: src/commands/onboard-types.ts
Line: 70:82

Comment:
`OnboardOptions` adds `ollamaBaseUrl?: string`, but there’s no corresponding usage in the onboarding flow or auth-choice handler in this PR (a grep only finds this type addition). If this was intended to support non-interactive onboarding, it currently won’t have any effect.

If it’s not needed, consider removing it to avoid a misleading public option; if it is needed, wire it through the non-interactive path / CLI args parsing so it actually configures the Ollama base URL.

How can I resolve this? If you propose a fix, please make it concise.
`````
</details>
</details>


## Stats

- **Size:** large (207+, 3-, 11 files)
- **Age:** 1 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #3494
