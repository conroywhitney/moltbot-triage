---
number: 3266
title: "fix(cli): add 'approve' command for exec approval requests (#3258) [AI-assisted]"
author: robbyczgw-cla
created: 2026-01-28T10:18:33Z
updated: 2026-01-28T23:25:09Z
labels: ["cli"]
additions: 254
deletions: 0
changed_files: 3
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/moltbot/moltbot/pull/3266
fixes_issues: [3258]
related_prs: [3258]
duplicate_of: null
---

## Description

## Summary

Fixes #3258 - Agent suggests non-existent 'clawdbot approve' CLI command.

## The Problem

The agent incorrectly tells users to run `clawdbot approve <id>` when they need to approve an exec request, but this command doesn't exist. Only the `/approve` chat command works.

## The Solution

Add a new CLI command `moltmate approve <id> <decision>` that mirrors the `/approve` chat command functionality:

```bash
# Allow once
moltmate approve abc123 allow-once
moltmate approve abc123 once

# Allow always (adds to allowlist)
moltmate approve abc123 allow-always
moltmate approve abc123 always

# Deny
moltmate approve abc123 deny
moltmate approve abc123 reject
```

## Changes

- **`src/cli/approve-cli.ts`**: New CLI command that:
  - Takes `<id> <decision>` arguments
  - Supports decision aliases (once, always, reject, block, etc.)
  - Calls the `exec.approval.resolve` gateway method
  - Provides user-friendly success/error messages

- **`src/cli/approve-cli.test.ts`**: Comprehensive tests covering:
  - All three decision types (allow-once, allow-always, deny)
  - Alias support (once, always, reject, block)
  - Invalid decision handling
  - Gateway error handling

- **`src/cli/program/command-registry.ts`**: Register the new command

## Testing

All 8 tests pass:
```
 ✓ src/cli/approve-cli.test.ts (8 tests)
   ✓ resolves approval with allow-once
   ✓ resolves approval with allow-always
   ✓ resolves approval with deny
   ✓ accepts decision aliases
   ✓ accepts 'once' alias for allow-once
   ✓ accepts 'reject' alias for deny
   ✓ rejects invalid decision
   ✓ handles gateway errors
```

## Reviews


## Comments


## Stats

- **Size:** large (254+, 0-, 3 files)
- **Age:** 1 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #3258
