---
number: 2884
title: "fix: Create memory directory and symlink identity files during workspace setup"
author: webdevtodayjason
created: 2026-01-27T17:26:15Z
updated: 2026-01-28T23:25:11Z
labels: ["agents"]
additions: 98
deletions: 0
changed_files: 2
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2884
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
- Creates `memory/` directory during workspace setup when `ensureBootstrapFiles` is true
- Symlinks identity files (SOUL.md, USER.md, AGENTS.md, IDENTITY.md) into `memory/` so they are indexed by memory search
- Gracefully handles symlink failures on Windows and preserves existing files

## Problem
The memory search system looks for files in `~/clawd/memory/` but workspace setup only created identity files at the workspace root. This caused:
- `clawdbot memory status` to report "no memory files found"
- The AI to incorrectly claim "I have no memories" despite having identity files
- Users having to manually create the `memory/` directory and copy/symlink files

## Solution
During `ensureAgentWorkspace()` with `ensureBootstrapFiles: true`:
1. Create `memory/` subdirectory
2. Symlink identity files into it so memory search can index them
3. Skip if files already exist (preserves user customizations)
4. Gracefully handle symlink failures (e.g., Windows without privileges)

## Test plan
- [x] Added unit tests for memory directory creation
- [x] Added test for symlink creation
- [x] Added test for not overwriting existing files
- [x] All 6 workspace tests pass
- [x] Lint passes

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

## Reviews


## Comments


## Stats

- **Size:** medium (98+, 0-, 2 files)
- **Age:** 2 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
