---
number: 3603
title: "`dotenv` -> `dotenvx` (secure dotenv)"
author: motdotla
created: 2026-01-28T22:13:34Z
updated: 2026-02-03T03:52:37Z
labels: []
additions: 164
deletions: 19
changed_files: 3
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 2
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3603
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

Hi guys, I love moltbot! I'm the creator of dotenv, and I'd like to use moltbot with my encrypted .env files (to mitigate potential attacks [1])

In this PR, I've switched `dotenv` to `@dotenvx/dotenvx` [2]. Dotenvx works just like dotenv - no changes - but with the option to add encryption. [3]

Thank you for considering this PR.

[1] https://x.com/mrnacknack/status/2016134416897360212?s=20
[2] https://www.npmjs.com/package/@dotenvx/dotenvx
[3] https://dotenvx.com/docs/quickstart#add-encryption

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR swaps the project’s environment loading helper from `dotenv` to `@dotenvx/dotenvx` by updating `package.json`/`pnpm-lock.yaml` and changing the import in `src/infra/dotenv.ts`.

The change is localized to the `loadDotEnv` helper (still calling `config()` twice: once for CWD, once for a global fallback file), but it introduces a new dependency tree via `dotenvx` (including a CLI-oriented dependency set) and relies on `dotenvx` having the same ESM export shape as the prior `dotenv` usage.

<h3>Confidence Score: 3/5</h3>

- This PR is mostly safe, but may break at runtime depending on `@dotenvx/dotenvx`’s ESM export shape.
- The change is small and isolated, but the switch to a different package name with a default import is the main risk: if `dotenvx` does not provide a default export compatible with `dotenv.config`, the app will fail early during startup. Lockfile changes also introduce additional transitive deps (including an extra commander major), which is likely acceptable but worth noting.
- src/infra/dotenv.ts; pnpm-lock.yaml

<!-- greptile_other_comments_section -->

<sub>(3/5) Reply to the agent's comments like "Can you suggest a fix for this @greptileai?" or ask follow-up questions!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @motdotla (2026-01-31)

This PR will also help mitigate this attack: https://www.moltbook.com/post/cbd6474f-8478-4894-95f1-7b104a73bcd5

<img width="1133" height="408" alt="Screenshot 2026-01-30 at 6 40 38 PM" src="https://github.com/user-attachments/assets/d8aeef1a-99b0-4a56-bf5d-b3a315505cd8" />


### @greptile-apps (2026-02-03)

<details>
<summary>Additional Comments (1)</summary>

**`package.json`**
[P2] Adding `@dotenvx/dotenvx` introduces a second `commander` major in the dependency graph.

The repo already depends on `commander@^14` (top-level). `@dotenvx/dotenvx` pulls `commander@11.1.0` (see lockfile), so you’ll ship/resolve two different `commander` majors. That’s usually fine, but it’s extra weight and can be surprising if any tooling expects a single version. If `dotenvx` doesn’t need the CLI path for this repo, you may want to confirm this is acceptable.

<sub>Note: If this suggestion doesn't match your team's coding style, reply to this and let me know. I'll remember it for next time!</sub>

<details><summary>Prompt To Fix With AI</summary>

`````markdown
This is a comment left during a code review.
Path: package.json
Line: 182:182

Comment:
[P2] Adding `@dotenvx/dotenvx` introduces a second `commander` major in the dependency graph.

The repo already depends on `commander@^14` (top-level). `@dotenvx/dotenvx` pulls `commander@11.1.0` (see lockfile), so you’ll ship/resolve two different `commander` majors. That’s usually fine, but it’s extra weight and can be surprising if any tooling expects a single version. If `dotenvx` doesn’t need the CLI path for this repo, you may want to confirm this is acceptable.

<sub>Note: If this suggestion doesn't match your team's coding style, reply to this and let me know. I'll remember it for next time!</sub>

How can I resolve this? If you propose a fix, please make it concise.
`````
</details>
</details>


## Stats

- **Size:** medium (164+, 19-, 3 files)
- **Age:** 5 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
