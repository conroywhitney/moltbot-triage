---
number: 3814
title: "feat(gateway): add device auto-approve policy for Tailscale connections"
author: tmchow
created: 2026-01-29T06:37:52Z
updated: 2026-01-29T06:43:51Z
labels: ["docs", "gateway"]
additions: 341
deletions: 1
changed_files: 11
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3814
fixes_issues: [3795]
related_prs: [3795]
duplicate_of: null
---

## Description

## Summary

Add `gateway.devices.autoApprove` config option to auto-approve device pairing when requests come via Tailscale Serve with verified identity.

- Add "none" (default) and "tailscale" modes for autoApprove policy
- Auto-approve devices when Tailscale auth succeeds (verified via `tailscale whois`)
- Add `autoApproved` and `autoApproveReason` fields to `device.pair.resolved` event for observability
- Add security audit info finding when tailscale mode is enabled
- Add comprehensive tests for config validation and auto-approve logic
- Add documentation in gateway configuration guide

## Config

```json
{
  "gateway": {
    "devices": {
      "autoApprove": "tailscale"  // "none" | "tailscale"
    }
  }
}
```

## Test Plan

- [x] Config schema accepts valid values, rejects invalid
- [x] `shouldAutoApprove` flag computed correctly for each scenario:
  - Local client: always auto-approve
  - Tailscale auth + config=tailscale: auto-approve
  - Tailscale auth + config=none: require manual
  - Token auth + config=tailscale: require manual
- [x] Security audit emits info finding when tailscale mode enabled
- [x] All 4843 tests pass

Fixes #3795

## Reviews


## Comments


## Stats

- **Size:** large (341+, 1-, 11 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: #3795
