---
number: 2887
title: "fix(daemon): use correct service name for node install/uninstall"
author: MohammadErfan-Jabbari
created: 2026-01-27T17:35:51Z
updated: 2026-01-28T23:25:11Z
labels: ["gateway"]
additions: 2
deletions: 2
changed_files: 1
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/moltbot/moltbot/pull/2887
fixes_issues: [2855]
related_prs: [2855]
duplicate_of: null
---

## Description

## Summary

`clawdbot node install` was failing on headless Linux servers with:

```
Node install failed: Error: systemctl enable failed: Failed to enable unit: Unit file clawdbot-gateway.service does not exist.
```

## Root Cause

In `src/daemon/systemd.ts`, both `installSystemdService` and `uninstallSystemdService` were hardcoded to use `resolveGatewaySystemdServiceName(env.CLAWDBOT_PROFILE)` instead of `resolveSystemdServiceName(env)`.

The problem:
1. `resolveSystemdUnitPath()` correctly uses `resolveSystemdServiceName(env)` which respects the `CLAWDBOT_SYSTEMD_UNIT` environment variable
2. But when calling `systemctl enable/disable`, it was directly using `resolveGatewaySystemdServiceName()`, ignoring the override

This caused:
1. The correct unit file to be created at `~/.config/systemd/user/clawdbot-node.service`
2. But `systemctl enable clawdbot-gateway.service` to fail because that file doesn't exist

## Fix

Replace `resolveGatewaySystemdServiceName(env.CLAWDBOT_PROFILE)` with `resolveSystemdServiceName(env)` in both functions so they respect the `CLAWDBOT_SYSTEMD_UNIT` override set by the node service installer.

## Testing

- [x] `pnpm lint` passes
- [x] `pnpm build` passes  
- [x] `pnpm test src/daemon/systemd.test.ts` passes (10 tests)
- [x] Verified the fix logic matches the existing `stopSystemdService` and `restartSystemdService` functions which already use `resolveSystemdServiceName(env)`

Fixes #2855

---

ðŸ¤– AI-assisted: This fix was developed with Claude Opus 4.5. The bug was identified by analyzing the source code and tracing the service name resolution path.

## Reviews


## Comments


## Stats

- **Size:** tiny (2+, 2-, 1 files)
- **Age:** 1 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #2855
