---
number: 7407
title: "feat(telegram): human-readable topic names in session dropdown"
author: Diaspar4u
created: 2026-02-02T19:44:27Z
updated: 2026-02-03T01:34:25Z
labels: ["channel: telegram"]
additions: 48
deletions: 1
changed_files: 6
size: small
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 4
reactions_total: 1
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/7407
fixes_issues: [7406]
related_prs: [7406]
duplicate_of: null
---

## Description

## Summary

Session dropdown now shows human-readable topic names instead of raw numeric IDs for Telegram forum topics.

**Before:** `agent:main:telegram:group:-123245:topic:45`
**After:** `Telegram : GroupName : TopicName`

## Changes

- **src/telegram/bot-message-context.ts** - Extract topic name from `forum_topic_created` service messages
- **src/auto-reply/templating.ts** - Add `TopicName` field
- **src/config/sessions/types.ts** - Add `topicName` field to session metadata
- **src/config/sessions/metadata.ts** - Store `topicName` when available
- **src/config/sessions/group.ts** - Telegram-specific display format with spaced colons
- **src/config/sessions.test.ts** - Test coverage

**Note:** Telegram-specific implementation. Format uses spaced colons for readability.

Fixes #7406

## Reviews

### @greptile-apps â€” COMMENTED (2026-02-02)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @Diaspar4u (2026-02-02)

@greptile-apps[bot] Re: topic name extraction - Acknowledged limitation. Telegram Bot API has no method to fetch topic names by ID, so we rely on `forum_topic_created` which appears on topic creation or replies to the topic header. Once captured, the name persists in session metadata. For newly created topics going forward, names will be captured properly. Existing topics will populate when a relevant message is seen. Documenting this limitation is acceptable for now.

### @Diaspar4u (2026-02-02)

@greptile-apps[bot] Re: inconsistent provider casing - Fixed. Updated to use lowercase `telegram` for consistency with other providers. Only subject/topic portions preserve original casing now.

### @greptile-apps (2026-02-02)

I understand your approach to handling the topic name extraction limitation. This is a practical solution given the Telegram Bot API constraints. Your implementation correctly:

1. Captures topic names from `forum_topic_created` service messages when available
2. Persists the names in session metadata for future use
3. Falls back gracefully for existing topics without names

The lazy loading approach (populating names when relevant messages are seen) is reasonable and will gradually improve the user experience over time. This is a common pattern when working with APIs that have limited metadata access.

Your solution balances functionality with API limitations effectively. The documentation of this behavior will help users understand why some topic names might not appear immediately.

### @greptile-apps (2026-02-02)

Perfect! I can see you've successfully fixed the provider casing issue. The updated implementation in `src/config/sessions/group.ts` now:

1. Uses `providerKey = providerRaw.toLowerCase()` to ensure consistent lowercase provider names
2. Maintains the special Telegram formatting with lowercase `telegram` while preserving original casing for subject/topic names
3. Returns `telegram : OpenClawBot : General` instead of the inconsistent `Telegram : ...`

This change brings Telegram in line with other providers (discord, whatsapp, etc.) while keeping the human-readable portions properly cased. The test case correctly reflects this improvement as well.

The implementation now strikes the right balance between consistency and readability!


## Stats

- **Size:** small (48+, 1-, 6 files)
- **Age:** 0 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #7406
