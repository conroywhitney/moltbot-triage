---
number: 7563
title: "fix: expand transient network error detection"
author: kaigritun
created: 2026-02-03T00:23:19Z
updated: 2026-02-03T00:24:24Z
labels: []
additions: 18
deletions: 0
changed_files: 1
size: small
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: passing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/7563
fixes_issues: []
related_prs: [7474,7558]
duplicate_of: null
---

## Description

Add message-based detection for additional transient network errors:
- socket hang up
- network error/failure
- connection reset/timed out/refused
- dns lookup failed
- host not found

These errors are now logged as warnings instead of crashing the gateway, making OpenClaw resilient to unstable network connections (Starlink, mobile hotspots, etc).

Extends #7558, addresses #7474

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

Expands `isTransientNetworkError` to also detect transient network failures by scanning error message text (e.g., socket hang up, connection refused, DNS lookup failures), so these unhandled rejections are logged as warnings instead of crashing the gateway.

This change integrates into the existing unhandled rejection flow in `installUnhandledRejectionHandler`, which already treats aborts, fatal errors, and config errors specially; transient network errors now have broader coverage beyond just error codes and undici’s `fetch failed` wrapper.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge after addressing a small runtime edge case in message inspection.
- The change is localized and conceptually straightforward, but the new `"message" in err` check can throw when `err` is a non-null primitive, which is plausible for `unhandledRejection` reasons and would undermine the resiliency goal.
- src/infra/unhandled-rejections.ts (message inspection in transient detection / abort detection)

<!-- greptile_other_comments_section -->

<sub>(4/5) You can add custom instructions or style guidelines for the agent [here](https://app.greptile.com/review/github)!</sub>

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** small (18+, 0-, 1 files)
- **Age:** 0 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
