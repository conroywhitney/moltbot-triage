---
number: 2958
title: "fix(media): wire tools.media.image.maxBytes config to image processin…"
author: shamsulalam1114
created: 2026-01-27T21:10:10Z
updated: 2026-01-28T23:25:10Z
labels: ["agents"]
additions: 64
deletions: 1
changed_files: 5
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/moltbot/moltbot/pull/2958
fixes_issues: [2954]
related_prs: [2954]
duplicate_of: null
---

## Description

…g pipeline

Fixes #2954

The configuration setting tools.media.image.maxBytes was defined but not wired through the image sanitization pipeline. This resulted in hardcoded constants being used instead of the user-configured value.

Changes:
- Modified sanitizeSessionMessagesImages() to accept maxBytes in options
- Modified sanitizeSessionHistory() to accept and pass maxBytes parameter
- Updated attempt.ts to pass config value through the sanitization chain
- All sanitizeContentBlocksImages() calls now receive the configured maxBytes

This ensures that when users configure a custom image size limit, it is actually used throughout the image processing pipeline instead of being ignored.

## Reviews


## Comments


## Stats

- **Size:** medium (64+, 1-, 5 files)
- **Age:** 1 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #2954
