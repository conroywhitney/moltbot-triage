---
number: 3662
title: "fix(wizard): handle undefined token input during onboarding"
author: hclsys
created: 2026-01-29T00:56:45Z
updated: 2026-01-29T02:12:29Z
labels: ["commands"]
additions: 2
deletions: 2
changed_files: 2
size: tiny
review_decision: none
reviews: [{"author":"orzelig","state":"APPROVED"}]
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3662
fixes_issues: [3384]
related_prs: [3384]
duplicate_of: null
---

## Description

## Summary

Fixes #3384

When user leaves token blank during onboarding or `configure gateway`, `text()` may return `undefined` at runtime (despite TypeScript type declaring `string`). `String(undefined)` produces the literal string `"undefined"` which is truthy, so `randomToken()` was never called.

### Changes
- `src/wizard/onboarding.gateway-config.ts:183`: `String(tokenInput)` â†’ `(tokenInput ?? "")`
- `src/commands/configure.gateway.ts:178`: Same fix

### Why this fix
Nullish coalescing `??` converts `undefined` to empty string before `.trim()`, allowing the `|| randomToken()` fallback to work correctly.

## Test plan
- [ ] CI tests pass
- [ ] Manual test: run onboarding, leave token blank, verify random token is generated

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

## Reviews

### @orzelig â€” APPROVED (2026-01-29)

Good fix! Properly handles undefined token input by using nullish coalescing before trim(). LGTM!


## Comments


## Stats

- **Size:** tiny (2+, 2-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: #3384
