---
number: 2027
title: "[AI-Assisted] Fix ExtensionRunner initialization in embedded mode"
author: ArtemHorik
created: 2026-01-26T02:07:59Z
updated: 2026-01-28T23:25:13Z
labels: []
additions: 69
deletions: 0
changed_files: 1
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/moltbot/moltbot/pull/2027
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary                                                                                                                            
  - Initialize `extensionRunner` in embedded mode to fix auto-compaction summaries                                                      
  - Without this, `ctx.model` remains undefined and compaction hooks fall back to "Summary unavailable..."                              
                                                                                                                                        
  ## Why                                                                                                                                
  In embedded mode (used by bots), `extensionRunner.initialize()` was never called, unlike interactive mode where the UI calls it. This caused `compaction-safeguard` to skip real summarization.                                                                             
                                                                                                                                        
  ## Changes                                                                                                                            
  - Call `extensionRunner.initialize()` after session creation in `attempt.ts`                                                          
  - `getActiveTools` returns only valid string tool names (filters undefined)                                                           
  - `setModel` validates API key and returns `Promise<boolean>`                                                                         
  - `compact` forwards `onComplete`/`onError` callbacks properly                                                                        
                                                                                                                                        
  ## Testing                                                                                                                            
  ✅ Fully tested locally with Clawdbot instance                                                                                        
  - Verified compaction now produces actual summaries instead of "Summary unavailable..."                                               
                                                                                                                                        
  ## AI Disclosure                                                                                                                      
  - Code & review: Codex, Claude Code                                                                                                   
  - ✅ Tested locally, code reviewed and understood 

## Reviews


## Comments


## Stats

- **Size:** medium (69+, 0-, 1 files)
- **Age:** 3 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
