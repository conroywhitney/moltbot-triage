---
number: 6003
title: "feat(slack): auto-follow threads where bot was mentioned in root message"
author: SWYZZWH
created: 2026-02-01T05:57:56Z
updated: 2026-02-02T05:59:32Z
labels: ["channel: slack"]
additions: 134
deletions: 1
changed_files: 4
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"SWYZZWH","state":"COMMENTED"},{"author":"SWYZZWH","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6003
fixes_issues: [6002,6005]
related_prs: [6002,6005]
duplicate_of: null
---

## Description

## Summary

Closes #6005
Closes #6002

When a user mentions the bot in a Slack channel message, the bot now automatically follows the resulting thread — subsequent replies no longer require re-mentioning the bot.

## Changes
- **New:** `src/slack/monitor/thread-mention-cache.ts` — Bounded LRU cache (max 1000 entries, 1h TTL) that tracks `channelId:threadTs` pairs where the bot was explicitly mentioned in the root message
- **Modified:** `src/slack/monitor/message-handler/prepare.ts` — Records mentions for root-level messages; checks cache during thread reply processing to set `implicitMention = true`
- **New:** `src/slack/monitor/thread-mention-cache.test.ts` — Unit tests for the cache
- **Modified:** `src/channels/mention-gating.test.ts` — Added test case for implicit mention (thread auto-follow scenario)

## How it works
1. When a channel message explicitly mentions the bot and is NOT a thread reply, record `{channelId, messageTs}` in the cache
2. When processing a thread reply, look up `{channelId, threadTs}` in the cache
3. If found (and not expired), treat the reply as an implicit mention → bypasses `requireMention` gating

## Testing
- 10 tests pass (6 mention-gating + 4 thread-mention-cache)
- TypeScript compiles clean (`tsc --noEmit`)
- Lint clean (`oxlint`)
- Format clean (`oxfmt`)

## AI Disclosure
- [x] AI-assisted (built with Claude)
- [x] Fully tested
- [x] I understand what the code does

## Reviews

### @greptile-apps — COMMENTED (2026-02-01)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @SWYZZWH — COMMENTED (2026-02-01)



### @SWYZZWH — COMMENTED (2026-02-01)




## Comments


## Stats

- **Size:** medium (134+, 1-, 4 files)
- **Age:** 1 days
- **Last activity:** 2026-02-02

## Links

- Fixes: #6002
- Fixes: #6005
