---
number: 4503
title: "feat(search): add optional proxy configuration for the web_search tool"
author: kdwycz
created: 2026-01-30T08:28:50Z
updated: 2026-01-30T08:29:02Z
labels: ["docs", "agents"]
additions: 23
deletions: 3
changed_files: 3
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4503
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

  Adds optional proxy configuration for the web_search tool to support network environments that require proxies
  to access Brave Search API or Perplexity.

## Changes

  - Add proxy field to ToolsWebSearchSchema in src/config/zod-schema.agent-runtime.ts
  - Add resolveProxy() helper function in src/agents/tools/web-search.ts
  - Update runPerplexitySearch() and runWebSearch() to accept and use proxy parameter
  - Use undici's ProxyAgent for both Brave Search and Perplexity providers
  - Update docs/tools/web.md with proxy configuration examples

## Example Config

```json
  {
    "tools": {
      "web": {
        "search": {
          "apiKey": "YOUR_BRAVE_API_KEY",
          "proxy": "http://127.0.0.1:7890"  // supports http
        }
      }
    }
  }
```

  The proxy setting works with both Brave Search and Perplexity providers.

## Testing

  - Build passes (pnpm build)
  - All tests pass (pnpm test)
  - Verified web search works with proxy configured
  - Verified web search works without proxy (backward compatible)

## Reviews


## Comments


## Stats

- **Size:** small (23+, 3-, 3 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: (none detected)
