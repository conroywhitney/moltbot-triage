---
number: 2535
title: "fix(google-antigravity): use 127.0.0.1 instead of localhost for OAuth redirect                 "
author: brian033
created: 2026-01-27T03:05:51Z
updated: 2026-02-03T03:57:33Z
labels: ["extensions: google-antigravity-auth"]
additions: 1
deletions: 1
changed_files: 1
size: tiny
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 1
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2535
fixes_issues: []
related_prs: [2463]
duplicate_of: null
---

## Description

## Summary                                                                                                                                                                                                                                                  
  - Fix Google Antigravity OAuth authentication failure caused by Google blocking HTTP localhost redirects                                                                                                                                                    
  - Change redirect URI from `http://localhost:51121` to `http://127.0.0.1:51121`                                                                                                                                                                             
 
## Why
Google's OAuth 2.0 security policy blocks `http://localhost` redirects but explicitly allows loopback IP addresses (`127.0.0.1`) for native app flows. This is documented in [Google's OAuth 2.0 policy](https://developers.google.com/identity/protocols/oauth2/policies#secure-response-handling).                                                                                                                                                         

Fixes [#2463](https://github.com/clawdbot/clawdbot/issues/2463)

### AI Disclosure
I've used claude code for this commit, thanks

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates the Google Antigravity OAuth redirect URI from `http://localhost:51121/oauth-callback` to `http://127.0.0.1:51121/oauth-callback` to comply with Google’s OAuth loopback redirect policy, and adds a small UX improvement to print the raw auth URL to the terminal during manual flow.

The change is isolated to the `google-antigravity-auth` extension: it affects how the auth URL is constructed and how the local callback server is reached, without changing token exchange or credential persistence logic.

<h3>Confidence Score: 5/5</h3>

- This PR is safe to merge with minimal risk.
- Change is narrowly scoped (string/redirect host update plus extra logging) and aligns with existing callback server binding to 127.0.0.1; no control-flow or security-sensitive logic was altered beyond the redirect URI used in OAuth requests.
- extensions/google-antigravity-auth/index.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @greptile-apps (2026-02-03)

<details>
<summary>Additional Comments (1)</summary>

**`extensions/google-antigravity-auth/index.ts`**
The hint string still says `PKCE + localhost callback`, but the redirect/host are now `127.0.0.1` (`REDIRECT_URI` and `server.listen(...)`). This will be user-visible and confusing when debugging OAuth.

```suggestion
          hint: "PKCE + 127.0.0.1 callback",
```

<details><summary>Prompt To Fix With AI</summary>

`````markdown
This is a comment left during a code review.
Path: extensions/google-antigravity-auth/index.ts
Line: 381:381

Comment:
The hint string still says `PKCE + localhost callback`, but the redirect/host are now `127.0.0.1` (`REDIRECT_URI` and `server.listen(...)`). This will be user-visible and confusing when debugging OAuth.

```suggestion
          hint: "PKCE + 127.0.0.1 callback",
```

How can I resolve this? If you propose a fix, please make it concise.
`````
</details>
</details>


## Stats

- **Size:** tiny (1+, 1-, 1 files)
- **Age:** 6 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
