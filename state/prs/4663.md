---
number: 4663
title: "fix: per-profile browser caching to allow parallel connections"
author: tsukhani
created: 2026-01-30T13:46:40Z
updated: 2026-01-30T13:46:40Z
labels: []
additions: 24
deletions: 13
changed_files: 1
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4663
fixes_issues: [4289]
related_prs: [3605,4289]
duplicate_of: null
---

## Description

## Summary
Changes global singleton `cached`/`connecting` variables to per-URL Maps, allowing different browser profiles to connect in parallel instead of blocking each other.

## Problem
When using multiple browser profiles (e.g., `linkedin` on port 18805 and `clawd` on port 18800), operations on one profile blocked operations on the other due to shared global state.

## Solution
- Replace `let cached` and `let connecting` with `Map<string, ...>` keyed by CDP URL
- Each profile now maintains its own connection state
- `closePlaywrightBrowserConnection()` now closes all cached connections

## Testing
- [x] Tested locally with multiple browser profiles
- [x] Linter passes

## AI Assistance ðŸ¤–
This PR was AI-assisted (Claude). The fix was identified by analyzing the root cause reported in #4289 and #3605.

Fixes #4289, #3605

## Reviews


## Comments


## Stats

- **Size:** small (24+, 13-, 1 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #4289
