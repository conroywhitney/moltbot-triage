---
number: 4653
title: "fix(gateway): improve crash resilience for mDNS and network errors"
author: AyedAlmudarra
created: 2026-01-30T13:34:16Z
updated: 2026-01-30T13:34:27Z
labels: ["cli"]
additions: 179
deletions: 1
changed_files: 6
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4653
fixes_issues: [3815,3821,4501]
related_prs: [3815,3821,4501]
duplicate_of: null
---

## Description

## Summary
Fixes critical gateway stability issues caused by mDNS/Bonjour errors during network interface changes.

## Issues Fixed
- Fixes #3821 - Gateway crash loop on mDNS network changes (sleep/wake, WiFi reconnect)
- Fixes #3815 - Gateway crashes from unhandled fetch failures  
- Fixes #4501 - Unhandled promise rejection causing gateway crash

## Changes

### 1. Error Handling (`src/infra/bonjour-ciao.ts`)
- Added error patterns for transient mDNS issues
- Catches AssertionError from MDNServer

### 2. Network Error Detection (`src/infra/unhandled-rejections.ts`)
- Added ERR_ASSERTION to transient network codes
- Better detection of mDNS-related assertion errors

### 3. CLI Flag (`src/cli/gateway-cli/run.ts`)
- Added `--no-bonjour` flag to disable mDNS advertising

### 4. Tests & Docs
- Added unit and integration tests (42 total, all passing)
- Updated CHANGELOG.md

## Checklist
- [x] Code follows project style
- [x] Tests added and passing
- [x] CHANGELOG.md updated
- [x] No breaking changes

## Reviews


## Comments


## Stats

- **Size:** medium (179+, 1-, 6 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #3815
- Fixes: #3821
- Fixes: #4501
