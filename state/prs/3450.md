---
number: 3450
title: "feat: Agent routing in webhook mappings (Issue #3432)"
author: anandsuraj
created: 2026-01-28T16:33:08Z
updated: 2026-01-28T23:25:09Z
labels: ["gateway"]
additions: 76
deletions: 1
changed_files: 4
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3450
fixes_issues: [3432]
related_prs: [3432]
duplicate_of: null
---

## Description

## Description

Implements agent routing capability in webhook mappings by adding an `agentId` field support across the webhook/hooks infrastructure.

## Changes

### Type Definitions
- Added `agentId?: string;` field to `HookMappingConfig` in `src/config/types.hooks.ts`
- Added `agentId?: string;` field to `HookMappingResolved` in `src/gateway/hooks-mapping.ts`
- Added `agentId?: string;` field to `HookAction` union type in `src/gateway/hooks-mapping.ts`

### Implementation
- Added `agentId?: string;` field to `HookAgentPayload` type in `src/gateway/hooks.ts`
- Implemented agentId extraction and normalization in `normalizeAgentPayload()` function
  - Extracts `agentId` from webhook payload
  - Validates and trims whitespace
  - Defaults to `undefined` if not provided or empty

### Tests
- Created comprehensive test suite in `test/hooks.agentId.test.ts`
- Tests cover:
  - Valid agentId string acceptance
  - Whitespace trimming
  - Missing/undefined agentId handling
  - Empty string handling
  - Non-string agentId handling

## Relates to

Closes #3432

## Testing

- All new tests pass
- Changes are backward compatible (agentId is optional)
- Webhook configuration without agentId continues to work as before

## Reviews


## Comments


## Stats

- **Size:** medium (76+, 1-, 4 files)
- **Age:** 1 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #3432
