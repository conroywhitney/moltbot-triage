---
number: 6969
title: "feat: add Azure AI Foundry provider support"
author: alexpwrd
created: 2026-02-02T07:36:20Z
updated: 2026-02-02T13:45:11Z
labels: ["docs", "agents"]
additions: 446
deletions: 0
changed_files: 4
size: large
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"alexpwrd","state":"COMMENTED"},{"author":"alexpwrd","state":"COMMENTED"}]
comments_count: 1
reactions_total: 2
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6969
fixes_issues: [6056]
related_prs: [6056]
duplicate_of: null
---

## Description

## Summary

- Adds native Azure AI Foundry (now Microsoft Foundry) provider support, addressing #6056
- Two provider IDs sharing one API key: `azure-ai-foundry` (OpenAI-compatible) and `azure-ai-foundry-anthropic` (Anthropic-compatible)
- Static model catalog with standard Azure model IDs (GPT-5/4.1/4o series, Claude 4.5/4/3.5 series, o3/o4 reasoning models)
- Auth fallback chain: `AZURE_AI_FOUNDRY_API_KEY` → `AZURE_FOUNDRY_API_KEY` → `AZURE_OPENAI_API_KEY`
- Endpoint auto-discovery via `AZURE_FOUNDRY_OPENAI_ENDPOINT` / `AZURE_FOUNDRY_ANTHROPIC_ENDPOINT`
- Custom deployment names supported via explicit `models.providers` config
- Documentation and test included

## Notes

- Microsoft renamed Azure AI Foundry to "Microsoft Foundry" in Jan 2026. Provider ID uses `azure-ai-foundry` since the API endpoints still use Azure domains. Can be aliased/renamed later.
- Model costs default to `0` (typical for Azure credit/sponsorship users). Users on pay-as-you-go can override via explicit config.
- Follows the static catalog pattern used by Minimax/Moonshot providers.

## Test plan

- [x] Type-check passes (`tsc --noEmit`)
- [x] Unit test passes (`vitest run`)
- [x] Tested locally with Azure AI Foundry endpoint (Claude Opus 4.5 via Anthropic-compatible API)
- [x] Verified `openclaw models list` shows all catalog models with auth
- [x] Verified gateway WebChat works end-to-end with Azure-hosted model

Closes #6056

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds a new Azure AI Foundry provider integration by:

- Extending auth resolution to support `azure-ai-foundry` / `azure-ai-foundry-anthropic` with an env-var fallback chain.
- Auto-registering two implicit providers (OpenAI-compatible and Anthropic-compatible) based on `AZURE_FOUNDRY_*_ENDPOINT` env vars and a static model catalog.
- Adding provider documentation and a small unit test.

The new providers plug into the existing `resolveImplicitProviders` flow (used by `ensureOpenClawModelsJson` to write/merge `models.json`) and into the shared env auth resolution in `src/agents/model-auth.ts`.

<h3>Confidence Score: 2/5</h3>

- Not safe to merge as-is due to incorrect API key resolution for implicit providers.
- The Azure AI Foundry provider addition is straightforward, but `resolveImplicitProviders` currently assigns the env var *name* (e.g. `AZURE_AI_FOUNDRY_API_KEY`) as the apiKey value, which will break authentication when the implicit providers are used. Aside from that, the changes are localized and consistent with existing provider patterns.
- src/agents/models-config.providers.ts (implicit provider apiKey resolution), plus a quick scan of other implicit providers using `resolveEnvApiKeyVarName`.

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-02)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @alexpwrd — COMMENTED (2026-02-02)



### @alexpwrd — COMMENTED (2026-02-02)




## Comments

### @Takhoffman (2026-02-02)

Hello, have you tested this with some of the other models that azure provides too such as deepseek?


## Stats

- **Size:** large (446+, 0-, 4 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: #6056
