---
number: 7425
title: "fix(signal): preserve case for group IDs (base64 is case-sensitive)"
author: lailoo
created: 2026-02-02T20:14:01Z
updated: 2026-02-02T20:48:00Z
labels: []
additions: 15
deletions: 1
changed_files: 3
size: small
review_decision: none
reviews: []
comments_count: 1
reactions_total: 1
ci_status: pending
mergeable: false
draft: false
url: https://github.com/openclaw/openclaw/pull/7425
fixes_issues: [7354]
related_prs: [7299,7354]
duplicate_of: null
---

## Description

## Summary

Fixes #7354, #7299

The `normalizeSignalMessagingTarget` function was lowercasing Signal group IDs, but base64 is case-sensitive. This caused the `message` tool to fail with 'Group not found' when targeting Signal groups.

## Problem

```javascript
// Original group ID (base64)
mJ6qA3MrX09n1PzxIhv1u3KWKd/eDiNoWY0Hy1z2jas=

// Was incorrectly lowercased to
mj6qa3mrx09n1pzxihv1u3kwkd/edinowy0hy1z2jas=
```

Base64 is case-sensitive - lowercasing changes the decoded bytes entirely, causing Signal API to return 'Group not found'.

## Solution

Remove `.toLowerCase()` from group ID normalization in `normalizeSignalMessagingTarget()`.

## Reproduction

**Before fix:**
```
pnpm vitest run src/channels/plugins/normalize/signal.test.ts

√ó preserves case for group IDs (base64 is case-sensitive)
  Expected: "group:mJ6qA3MrX09n1PzxIhv1u3KWKd/eDiNoWY0Hy1z2jas="
  Received: "group:mj6qa3mrx09n1pzxihv1u3kwkd/edinowy0hy1z2jas="
```

**After fix:**
```
‚úì preserves case for group IDs (base64 is case-sensitive)
7 passed (7)
```

## Changes

- `src/channels/plugins/normalize/signal.ts`: Remove `.toLowerCase()` from group ID return
- `src/channels/plugins/normalize/signal.test.ts`: Add tests for case preservation

## Testing

- ‚úÖ 7/7 unit tests pass
- ‚úÖ Lint passes

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR fixes Signal target normalization by **preserving the original case of `group:` IDs** in `normalizeSignalMessagingTarget`, since Signal group IDs are base64 and therefore case-sensitive. It also adds unit tests covering case preservation for both `group:` and `signal:group:` inputs, and documents the fix in the changelog.

The change is localized to the Signal normalization plugin (`src/channels/plugins/normalize/signal.ts`), which normalizes user-supplied recipient identifiers into canonical forms used by downstream Signal messaging logic; preserving case for group IDs prevents ‚ÄúGroup not found‚Äù failures caused by corrupting the base64 payload.

<h3>Confidence Score: 5/5</h3>

- This PR is safe to merge with minimal risk; it corrects a clearly incorrect normalization step and adds targeted tests.
- The behavioral change is narrow (only `group:` targets stop being lowercased), aligns with base64 semantics, and is covered by new unit tests. No broad refactors or external dependencies are involved.
- No files require special attention

<!-- greptile_other_comments_section -->

<!-- /greptile_comment -->

## Reviews


## Comments

### @gerigk-agent (2026-02-02)

Nice fix! We hit this exact issue and debugged it thoroughly before seeing your PR.

One interesting detail from our investigation: the error messages from signal-cli show a *different* corrupted ID than what OpenClaw sends. For example:

- OpenClaw sends: `...ri=`
- Error shows: `...rg=`

This happens because signal-cli decodes the (corrupted) base64, gets garbage bytes, then re-encodes them for the error message. So `I‚Üíi‚Üíg` isn't a second bug ‚Äî it's just the round-trip through decode/encode after the lowercase corruption.

LGTM üëç


## Stats

- **Size:** small (15+, 1-, 3 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: #7354
