---
number: 2204
title: "fix: exclude Linux native builds when downloading signal-cli on macOS/Windows"
author: Duartemartins
created: 2026-01-26T12:06:04Z
updated: 2026-02-03T03:57:47Z
labels: ["channel: signal"]
additions: 16
deletions: 2
changed_files: 1
size: small
review_decision: none
reviews: [{"author":"copilot-pull-request-reviewer","state":"COMMENTED"},{"author":"Duartemartins","state":"COMMENTED"},{"author":"Duartemartins","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2204
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

- Fix signal-cli auto-install on macOS (and Windows) by excluding Linux native builds from fallback selection
- Previously, `pickAsset()` would select the first archive found when no platform-specific build existed, which could be the Linux native build
- This caused `spawn Unknown system error -8` (ENOEXEC) on macOS ARM since the Linux ELF binary cannot execute there

## Problem

On macOS ARM, running `clawdbot doctor` or setting up Signal would download `signal-cli-X.X.X-Linux-native.tar.gz` instead of the JVM version `signal-cli-X.X.X.tar.gz`. The Linux ELF binary fails to execute with error code -8 (ENOEXEC).

## Solution

Update the fallback logic in `pickAsset()` to explicitly exclude platform-specific native builds (`linux-native`, `windows`) when selecting an archive on non-matching platforms. This ensures the cross-platform JVM version is selected.

## Test plan

- [ ] Test on macOS: `clawdbot` should download `signal-cli-X.X.X.tar.gz` (JVM version)
- [ ] Test on Linux: `clawdbot` should still prefer `signal-cli-X.X.X-Linux-native.tar.gz`
- [ ] Verify signal-cli starts successfully after install on macOS

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adjusts `pickAsset()` in `src/commands/signal-install.ts` to avoid selecting Linux native `signal-cli` archives as a fallback on macOS/Windows, ensuring the cross-platform JVM archive is chosen when no platform-specific build exists. This addresses macOS ENOEXEC failures when a Linux ELF binary is accidentally downloaded and extracted.

The change fits into the existing auto-install flow by only affecting asset selection; download/extraction and binary discovery remain unchanged.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge, with a small risk of edge-case asset selection on Windows/WSL.
- The change is localized to selection logic and clearly targets a real failure mode (macOS selecting Linux-native). Main concern is the `win32` fallback still permitting Windows-native archives in some scenarios, which could break in mixed environments; otherwise behavior is unchanged.
- src/commands/signal-install.ts (asset selection logic and platform fallback behavior)

<!-- greptile_other_comments_section -->

<sub>(3/5) Reply to the agent's comments like "Can you suggest a fix for this @greptileai?" or ask follow-up questions!</sub>

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @copilot-pull-request-reviewer â€” COMMENTED (2026-01-26)

## Pull request overview

Fixes signal-cli auto-install asset selection on non-Linux platforms by preventing Linux native archives from being chosen as a fallback.

**Changes:**
- Update macOS fallback selection to avoid choosing `linux-native` (and Windows) native archives when a platform-specific build isnâ€™t found.
- Update Windows fallback selection to avoid choosing `linux-native` archives when a platform-specific build isnâ€™t found.





---

ðŸ’¡ <a href="/clawdbot/clawdbot/new/main/.github/instructions?filename=*.instructions.md" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Add Copilot custom instructions</a> for smarter, more guided reviews. <a href="https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Learn how to get started</a>.

### @Duartemartins â€” COMMENTED (2026-01-26)



### @Duartemartins â€” COMMENTED (2026-01-26)



### @greptile-apps â€” COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** small (16+, 2-, 1 files)
- **Age:** 7 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
