---
number: 5064
title: "fix(auth): update deprecated User-Agent headers"
author: mfortin014
created: 2026-01-31T01:09:16Z
updated: 2026-02-03T02:22:35Z
labels: ["extensions: google-antigravity-auth"]
additions: 2
deletions: 2
changed_files: 1
size: tiny
review_decision: none
reviews: []
comments_count: 2
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/5064
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

Resolves the critical error: "This version of Antigravity is no longer supported."

Updates the client identifiers (User-Agent and X-Goog-Api-Client) to match modern VS Code extensions, bypassing the server-side block on deprecated clients.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates the HTTP client-identifying headers used by the Google Antigravity auth extension when calling the `loadCodeAssist` endpoint, changing `User-Agent` and `X-Goog-Api-Client` to values that match modern VS Code extensions. The intent is to avoid a server-side block applied to deprecated clients that was surfacing as “This version of Antigravity is no longer supported.”

Change is localized to `extensions/google-antigravity-auth/index.ts` in the `fetchProjectId` request headers; the rest of the OAuth flow and token exchange logic remains unchanged.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge; it’s a small, isolated header change with low blast radius.
- The diff only adjusts two request headers in one function (`fetchProjectId`) and doesn’t alter control flow, token handling, or persistence. Main remaining risk is functional (whether these particular header values are correct/accepted by Google’s backend over time) rather than code correctness.
- extensions/google-antigravity-auth/index.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews


## Comments

### @mfortin014 (2026-01-31)

Note: I observed that the upstream dependency @mariozechner/pi-ai also uses the deprecated vscode_cloudshelleditor header. That package will likely need a patch and a version bump in openclaw to fully resolve the issue across all providers.

### @Oceanswave (2026-01-31)

@mariozechner/pi-ai is patched in main https://github.com/badlogic/pi-mono/blob/main/packages/ai/src/providers/google-gemini-cli.ts Suggest that the fix is to update the dependency. https://github.com/openclaw/openclaw/pull/4919


## Stats

- **Size:** tiny (2+, 2-, 1 files)
- **Age:** 2 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
