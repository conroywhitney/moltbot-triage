---
number: 3880
title: "fix: drop assistant messages with stopReason 'error' to avoid orphaning tool results (#3860)"
author: SalimBinYousuf1
created: 2026-01-29T09:00:20Z
updated: 2026-01-29T09:00:30Z
labels: ["agents"]
additions: 9
deletions: 0
changed_files: 1
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3880
fixes_issues: []
related_prs: [3860]
duplicate_of: null
---

## Description

This PR fixes issue #3860 where assistant messages with stopReason 'error' (e.g., from content filtering) would have synthetic tool results added by the transcript repair logic. These tool results would then become orphaned if the provider filtered out the errored assistant message on subsequent requests, leading to 400 errors.

The fix ensures that assistant messages with an error stop reason are dropped during transcript repair, preventing the addition of synthetic tool results for them.

## Reviews


## Comments


## Stats

- **Size:** tiny (9+, 0-, 1 files)
- **Age:** 1 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
