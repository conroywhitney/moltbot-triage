---
number: 2138
title: "ci: add path filtering for macOS CI jobs"
author: lovincyrus
created: 2026-01-26T08:20:19Z
updated: 2026-02-03T03:57:46Z
labels: []
additions: 156
deletions: 141
changed_files: 2
size: large
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: passing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2138
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

This PR moves the checks-macos and macos-app CI jobs from ci.yml to a dedicated ci-macos.yml workflow with native GitHub Actions path filtering. The macOS jobs will now only run on PRs that touch relevant files (Node source code, Swift app code, or related config files), preventing them from blocking unrelated PRs like docs-only changes.

## Motivation

macOS CI jobs were blocking PRs even when the changes didn't affect macOS-related code. This wastes CI minutes and delays PR merges unnecessarily.

## Changes

The new `ci-macos.yml` workflow only triggers on PRs that modify:
- **Node source**: `src/**`, `extensions/**`, `package.json`, `pnpm-lock.yaml`, `tsconfig.json`, `vitest.config.ts`, `**/*.test.ts`
- **Swift app**: `apps/macos/**`, `.swiftlint.yml`, `.swiftformat`

PRs that only touch docs, Android, iOS, or other unrelated files will no longer trigger macOS runners.

## Test plan

- [x] Verify CI passes on this PR

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR extracts the macOS-specific CI jobs (`checks-macos` and `macos-app`) out of `.github/workflows/ci.yml` into a new `.github/workflows/ci-macos.yml` workflow, and adds GitHub Actions `pull_request.paths` filtering so macOS runners are only used for PRs that touch (intended) macOS-relevant code paths.

Overall this keeps Linux/Windows CI behavior unchanged while preventing macOS jobs from running on unrelated PRs, but correctness depends on the `paths:` list fully covering inputs that can affect `pnpm test` and the macOS Swift build/lint.

<h3>Confidence Score: 4/5</h3>

- This PR is largely safe to merge; main risk is unintentionally skipping macOS CI for relevant PRs due to incomplete path filtering.
- The change is limited to CI workflow restructuring and gating; it doesn’t affect runtime code paths. The primary failure mode is coverage gaps in the `pull_request.paths` filters causing macOS checks not to run when they should, which could allow platform-specific regressions to slip through.
- .github/workflows/ci-macos.yml (paths filter coverage)

<!-- greptile_other_comments_section -->

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** large (156+, 141-, 2 files)
- **Age:** 7 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
