---
number: 2614
title: "fix(discord): allow all channels when no channel allowlist is configured"
author: wakingcan
created: 2026-01-27T06:28:14Z
updated: 2026-01-28T23:25:11Z
labels: ["channel: discord"]
additions: 11
deletions: 1
changed_files: 2
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: passing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2614
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Problem

When a guild is in the allowlist with `groupPolicy: "allowlist"` but has no `channels` configured, messages from that guild were being blocked.

### Root Cause

`resolveDiscordChannelConfigWithFallback` only checked for `!channels` (null/undefined), but when config.patch sets `channels: null`, it can result in an empty object `{}` instead. An empty object is truthy, so the function continued and returned `{ allowed: false }` when no channel match was found.

### Fix

Added check for empty object: `Object.keys(channels).length === 0`

Now both null/undefined AND empty object return `null`, which results in `channelAllowed = true` (allowing all channels when no allowlist is configured).

## Testing

- Guild in allowlist with no `channels` config → all channels allowed ✅
- Guild in allowlist with specific `channels` → only those channels allowed ✅

## Reviews


## Comments


## Stats

- **Size:** small (11+, 1-, 2 files)
- **Age:** 3 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
