---
number: 6433
title: "fix: remove stdout pollution in completion handler"
author: arosstale
created: 2026-02-01T17:12:49Z
updated: 2026-02-01T17:30:05Z
labels: ["cli"]
additions: 2
deletions: 2
changed_files: 1
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6433
fixes_issues: [6236]
related_prs: [6236]
duplicate_of: null
---

## Description

## Problem
Debug console.log in completion handler writes to stdout, breaking shell piping and data integration.

## Root Cause
Handler uses process.stdout.write but includes debug logging that pollutes the output stream.

## Solution
Separated logging (to stderr) from data output (to stdout).

## Testing
✓ Direct execution - output visible
✓ Piped output (| jq) - no corruption
✓ Data integrity - JSON parseable

## Fixes Issue
Closes #6236

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates the `completion` subcommand to write the generated shell completion script directly to stdout using `process.stdout.write(script)` instead of `console.log(script)`. This avoids `console.log`'s extra newline/formatting behavior and prevents accidental stdout pollution that can break piping/integration when users consume the output programmatically.

The change is localized to `src/cli/completion-cli.ts`, which registers the CLI subcommand and generates scripts for zsh/bash/powershell/fish; install-related messaging continues to use stderr/stdout logging in `installCompletion`.

<h3>Confidence Score: 5/5</h3>

- This PR is safe to merge with minimal risk.
- The change is a single-line output behavior tweak scoped to the completion script generator path, switching from `console.log` to `process.stdout.write` to avoid unintended stdout changes; it does not affect command parsing, file writes, or other runtime logic.
- No files require special attention

<!-- greptile_other_comments_section -->

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews


## Comments


## Stats

- **Size:** tiny (2+, 2-, 1 files)
- **Age:** 1 days
- **Last activity:** 2026-02-01

## Links

- Fixes: #6236
