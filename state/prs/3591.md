---
number: 3591
title: "CLI: add OpenAI-compatible endpoint auth choice"
author: surak
created: 2026-01-28T21:54:07Z
updated: 2026-02-03T02:53:23Z
labels: ["commands"]
additions: 102
deletions: 1
changed_files: 5
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3591
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
- add OpenAI-compatible endpoint auth flow for base URL + bearer token
- expose the new auth choice and preferred provider mapping
- make the canvas host test create a temporary A2UI bundle if missing

## Testing
- not run (not requested)

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds a new onboarding/auth selection for an OpenAI-compatible endpoint (base URL + bearer token), wires it into the OpenAI auth apply flow, and maps the choice to the `openai` provider. It also updates the canvas host test to ensure an A2UI bundle exists so the scaffold can be served during tests.

Overall, the changes fit into the existing onboarding CLI by extending `AuthChoice` and the auth-choice option/group builders, and by adding a new branch in `applyAuthChoiceOpenAI` for collecting/storing endpoint env vars.

<h3>Confidence Score: 3/5</h3>

- Mostly safe to merge, but there is at least one test-related reliability issue that could break CI in some environments.
- The main functional change is straightforward and localized to onboarding/auth selection. The primary concern is the canvas-host test writing into the repository tree, which can fail in read-only or parallelized test setups and can dirty the working tree during runs.
- src/canvas-host/server.test.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps â€” COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (102+, 1-, 5 files)
- **Age:** 5 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
