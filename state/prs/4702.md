---
number: 4702
title: "fix(windows): resolve command execution and binary detection issues"
author: bsormagec
created: 2026-01-30T14:58:09Z
updated: 2026-01-30T16:31:45Z
labels: ["agents"]
additions: 25
deletions: 13
changed_files: 3
size: small
review_decision: none
reviews: [{"author":"copilot-pull-request-reviewer","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4702
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

This PR addresses Ä°ki critical issues encountered when running OpenClaw on Windows environments, specifically ensuring that binary files for various skills are correctly detected and executed:

1. **Binary Detection**: Enhances the `hasBinary` check to account for Windows-specific file extensions (`.exe`, `.cmd`, `.bat`). This change ensures that binary files belonging to various skills are correctly detected, which was previously failing due to missing platform-specific extensions.
2. **Command Execution**: Enables `shell: true` in the exec process for Windows to correctly handle scripts (like `.cmd` files) that cannot be spawned directly without a shell context.


### Technical Details

#### 1. Binary Detection (Extension Support)
Files: [src/agents/skills/config.ts](src/agents/skills/config.ts) and [src/hooks/config.ts](src/hooks/config.ts)
Modifies `hasBinary` to iterate through common Windows extensions when running on `win32`.

#### 2. Shell Support (Execution Context)
File: [src/process/exec.ts](src/process/exec.ts)
Adds `shell: process.platform === 'win32'` to the `spawn` options in `runCommandWithTimeout`.

### Why is this necessary?
Google Cloud SDK (`gcloud`), Go, or custom `.bat` scripts were not being detected or executed correctly on Windows. This patch removes these functionality barriers by ensuring skill binaries are found and executable via the shell.

## Reviews

### @copilot-pull-request-reviewer â€” COMMENTED (2026-01-30)

## Pull request overview

This PR enhances Windows compatibility for OpenClaw by addressing binary detection and command execution issues that prevented proper operation with Windows-specific executables like gcloud.cmd and .bat scripts.

**Changes:**
- Added Windows-specific file extension handling in binary detection
- Enabled shell execution context for Windows command spawning
- Applied changes to both hooks and skills configuration modules

### Reviewed changes

Copilot reviewed 3 out of 3 changed files in this pull request and generated 5 comments.

| File | Description |
| ---- | ----------- |
| src/process/exec.ts | Enables shell mode for Windows processes to support .cmd/.bat file execution |
| src/hooks/config.ts | Adds Windows extension support (.exe, .cmd, .bat) to hasBinary function |
| src/agents/skills/config.ts | Adds Windows extension support (.exe, .cmd, .bat) to hasBinary function |





---

ðŸ’¡ <a href="/openclaw/openclaw/new/main/.github/instructions?filename=*.instructions.md" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Add Copilot custom instructions</a> for smarter, more guided reviews. <a href="https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Learn how to get started</a>.


## Comments


## Stats

- **Size:** small (25+, 13-, 3 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: (none detected)
