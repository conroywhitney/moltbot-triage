---
number: 7620
title: "feat(cli-backends): add enableNativeTools option"
author: jpeggdev
created: 2026-02-03T01:38:47Z
updated: 2026-02-03T02:20:21Z
labels: ["agents"]
additions: 5
deletions: 1
changed_files: 3
size: tiny
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 1
reactions_total: 1
ci_status: failing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/7620
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

Adds a new `enableNativeTools` config option for CLI backends that allows the CLI's native file/shell tools to be used instead of being disabled via system prompt injection.

## Problem

Currently, CLI backends like Claude CLI have their native tools (Read, Write, Bash) disabled via a hard-coded system prompt injection: *"Tools are disabled in this session. Do not call tools."*

This prevents sub-agents using CLI backends from performing file operations or running commands, even though the CLI itself supports these capabilities.

## Solution

Add an `enableNativeTools` boolean option to CLI backend config:
- When `true`: Skip the tool-disabling prompt, allowing native CLI tools
- When `false` or unset (default): Current behavior preserved for backward compatibility

## Example Config

```json
{
  "agents": {
    "defaults": {
      "cliBackends": {
        "claude-cli": {
          "enableNativeTools": true
        }
      }
    }
  }
}
```

## Changes

- `src/config/types.agent-defaults.ts`: Added `enableNativeTools?: boolean` to `CliBackendConfig`
- `src/config/zod-schema.core.ts`: Added Zod validation for the new field
- `src/agents/cli-runner.ts`: Conditionally skip tool-disabling prompt when `enableNativeTools` is true

## Testing

Tested locally with Claude CLI backend - sub-agents can now create/read files using Claude CLI's native tools when this option is enabled.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds an `enableNativeTools?: boolean` flag to CLI backend config, wires it into the Zod schema, and uses it in `runCliAgent` to skip injecting the hard-coded “Tools are disabled…” system prompt when enabled. This fits into the existing CLI-backend architecture where backend-specific options are configured via `CliBackendConfig` and then consumed by the CLI runner when building the system prompt and launching the CLI process.

<h3>Confidence Score: 3/5</h3>

- This PR is likely safe, but may not fully deliver the intended behavior for enabling native tools.
- The change is small and gated behind an opt-in config flag, but it appears to only remove the tool-disabling prompt while still building the system prompt with `tools: []`, which could mean native tool usage remains unavailable depending on how CLI backends interpret tool availability.
- src/agents/cli-runner.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @jpeggdev (2026-02-03)

Thanks for the review! This is actually working as intended.

**The `tools: []` in `buildSystemPrompt` refers to OpenClaw's tools**, not the CLI's native tools. CLI backends like Claude CLI have their own built-in tools (Read, Write, Bash, etc.) that are:

1. Compiled into the CLI itself
2. Not passed via system prompt
3. Already enabled via `--dangerously-skip-permissions` in the default args

The only thing preventing their use was the prompt injection: *"Tools are disabled in this session. Do not call tools."*

**Tested and working**: With `enableNativeTools: true`, Claude CLI sub-agents can now create/read files using their native tools. The `tools: []` for OpenClaw tools is correct — we don't want OpenClaw tools in CLI backend sessions (as noted in the docs: "No OpenClaw tools - the CLI backend never receives tool calls").


## Stats

- **Size:** tiny (5+, 1-, 3 files)
- **Age:** 0 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
