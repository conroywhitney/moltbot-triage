---
number: 4782
title: "fix: Auto-discover Ollama models without requiring explicit API key"
author: spiceoogway
created: 2026-01-30T17:24:10Z
updated: 2026-01-30T17:26:45Z
labels: ["agents"]
additions: 8
deletions: 6
changed_files: 1
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4782
fixes_issues: [4544]
related_prs: [4544]
duplicate_of: null
---

## Description

## Summary

Fixes #4544

When Ollama is running locally with models installed, they were showing as 'missing' in `openclaw models list` because the provider was only registered if an explicit API key was configured.

## Root Cause

In `src/agents/models-config.providers.ts`, the `resolveImplicitProviders()` function only added the Ollama provider when an API key was explicitly configured via environment variables or auth profiles.

Since Ollama is a local service that doesn't require traditional API authentication (it runs on localhost:11434), this prevented auto-discovery of locally installed models.

## Changes

- Modified the Ollama provider registration logic to auto-discover models by attempting to query the local instance
- If models are found (`models.length > 0`), the provider is registered automatically
- Uses a placeholder API key `'ollama-local'` for local instances
- Still respects explicit configuration if provided (backward compatible)

## Testing

- ✅ Linted the changed file: no warnings or errors
- ✅ Aligns with patterns used for other local/unauthenticated providers (e.g., qwen-portal with OAuth placeholder)

## Expected Behavior After Fix

1. User runs `ollama pull deepseek-r1:latest`
2. User runs `openclaw models list`
3. Ollama models are now listed as **available** (not missing)
4. User can set default model: `openclaw models set ollama/deepseek-r1:latest`
5. Chat can successfully use the Ollama model

## Impact

- **Low risk**: Only affects Ollama provider discovery
- **High value**: Enables out-of-the-box Ollama support without manual configuration
- **Backward compatible**: Existing configurations with explicit API keys still work

---

**Note**: This change makes OpenClaw's Ollama integration work the same way as other local model servers - auto-discover and register if running.

## Reviews


## Comments


## Stats

- **Size:** small (8+, 6-, 1 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #4544
