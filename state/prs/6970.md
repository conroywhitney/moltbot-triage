---
number: 6970
title: "fix: correct ToolDefinition.execute parameter order after pi-coding-agent 0.51.0 update"
author: supremvanam
created: 2026-02-02T07:36:36Z
updated: 2026-02-02T07:54:35Z
labels: ["agents"]
additions: 9
deletions: 9
changed_files: 1
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 3
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6970
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary                                                                                                                                                                                                                                      
  - Fixes parameter order in `toToolDefinitions` and `toClientToolDefinitions` execute signatures                                                                                                                                                 
  - Commit cf1d3f7a7 updated pi-coding-agent to 0.51.0 but incorrectly placed `signal` before `onUpdate` instead of after `ctx`                                                                                                                   
                                                                                                                                                                                                                                                  
  ## What changed                                                                                                                                                                                                                                 
  The `ToolDefinition.execute` signature in pi-coding-agent 0.51.0 expects:                                                                                                                                                                       
  ```typescript                                                                                                                                                                                                                                   
  (toolCallId, params, onUpdate, ctx, signal?)                                                                                                                                                                                                    
                                                                                                                                                                                                                                                  
  The adapter had:                                                                                                                                                                                                                                
  (toolCallId, params, signal, onUpdate, _ctx)  // wrong                                                                                                                                                                                          
                                                                                                                                                                                                                                                  
  Now fixed to:                                                                                                                                                                                                                                   
  (toolCallId, params, onUpdate, _ctx, signal)  // correct

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates the adapter in `src/agents/pi-tool-definition-adapter.ts` to match the `ToolDefinition.execute` signature expected by `@mariozechner/pi-coding-agent` v0.51.0, moving the `signal` parameter to the last position and ensuring `onUpdate` and `ctx` are passed in the correct order. This keeps tool execution wiring consistent with the upstream libraryâ€™s API so cancellations and progress callbacks are routed correctly.

<h3>Confidence Score: 5/5</h3>

- This PR is safe to merge with minimal risk.
- Change is limited to a parameter reordering to match an upstream signature; the updated order aligns with how `tool.execute` is invoked and does not alter tool logic otherwise.
- No files require special attention

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews


## Comments


## Stats

- **Size:** small (9+, 9-, 1 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: (none detected)
