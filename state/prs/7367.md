---
number: 7367
title: "refactor(cron): rename wakeMode to postRun"
author: BrennerSpear
created: 2026-02-02T19:04:14Z
updated: 2026-02-02T19:04:35Z
labels: ["docs", "app: macos", "app: web-ui", "gateway", "cli", "commands", "agents"]
additions: 480
deletions: 210
changed_files: 68
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: true
draft: true
url: https://github.com/openclaw/openclaw/pull/7367
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

- Renames the confusing `wakeMode` field to `postRun` across the entire codebase
- `wakeMode: "now"` â†’ `postRun: "trigger-heartbeat"` and `wakeMode: "next-heartbeat"` â†’ `postRun: null`
- Adds backwards-compatible migration so existing `jobs.json` configs are automatically upgraded on load

## Motivation

The `wakeMode` name misleadingly suggests it controls *whether* cron jobs run, when it actually only controls post-execution heartbeat behavior. `postRun` with explicit values makes the purpose clear at a glance.

## Changes

- **Core types**: `CronWakeMode` â†’ `CronPostRun`, old type kept as deprecated alias
- **Migration** (`normalize.ts`): reads legacy `wakeMode`, maps to `postRun`, deletes old key
- **Schemas** (TypeBox + Zod): accept both old and new field names for backwards compat
- **CLI**: `--post-run` flag added, `--wake` kept as deprecated alias
- **Gateway hooks**: configs accept both `wakeMode` and `postRun`
- **Swift macOS app**: `CronWakeMode` enum â†’ `CronPostRun` with coding key migration
- **Web UI**: labels updated ("Post-run" / "Trigger heartbeat" / "None")
- **Tests**: all updated (804/805 pass â€” sole failure is unrelated macOS-only launchd test)
- **Docs**: English + Chinese updated with new naming and backwards compat notes

## Testing

- `bun test` passes 804/805 test files (4996/4999 tests)
- Only failure: `launchd.test.ts` â€” macOS-specific, pre-existing, unrelated to this change
- TypeScript build (`bun run build`) passes cleanly

> ðŸ¤– This PR was AI-assisted. All changes were reviewed and the full test suite was run.

## Reviews


## Comments


## Stats

- **Size:** large (480+, 210-, 68 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: (none detected)
