---
number: 6705
title: "feat(hooks): add agent:response hook event"
author: nijikokun
created: 2026-02-01T23:49:13Z
updated: 2026-02-02T12:07:10Z
labels: []
additions: 78
deletions: 0
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6705
fixes_issues: [6701]
related_prs: [6701]
duplicate_of: null
---

## Description

## Summary

Adds a new `agent:response` hook event that fires after the agent generates a response, before it's sent to the user.

## Motivation

This enables post-response processing like:
- Logging/auditing agent outputs  
- Response analytics and monitoring
- Custom notification triggers
- Integration with external systems

Currently the only agent hook is `agent:bootstrap` which fires *before* the response, not after. The docs mention planned `message:sent` and `message:received` events — this provides a more specific hook for agent response handling.

## Implementation

The hook fires only for user-visible responses (not empty/tool-only responses). It's triggered fire-and-forget (`void triggerInternalHook(...)`) to avoid blocking response delivery.

### New Types

```typescript
export type AgentResponseHookContext = {
  responseText?: string;  // Combined text from payloads
  payloads: ReplyPayload[];  // Full payload array
  model?: string;
  provider?: string;
  cfg?: OpenClawConfig;
  sessionKey?: string;
  sessionId?: string;
  agentId?: string;
  workspaceDir?: string;
};

export type AgentResponseHookEvent = InternalHookEvent & {
  type: "agent";
  action: "response";
  context: AgentResponseHookContext;
};
```

### Type Guard

```typescript
export function isAgentResponseEvent(event: InternalHookEvent): event is AgentResponseHookEvent
```

## Usage Example

```typescript
// hooks/my-hook/handler.ts
const handler: HookHandler = async (event) => {
  if (event.type !== 'agent' || event.action !== 'response') {
    return;
  }
  
  const { responseText, model, sessionKey } = event.context;
  console.log(`Agent responded with ${responseText?.length ?? 0} chars using ${model}`);
};

export default handler;
```

## Testing

- [x] TypeScript compiles without errors
- [ ] Unit tests (happy to add if approach is approved)

Closes #6701

## Reviews

### @greptile-apps — COMMENTED (2026-02-01)

<sub>2 files reviewed, 4 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (78+, 0-, 2 files)
- **Age:** 1 days
- **Last activity:** 2026-02-02

## Links

- Fixes: #6701
