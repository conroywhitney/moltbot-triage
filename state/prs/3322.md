---
number: 3322
title: "fix: merge provider config api into registry model"
author: nulone
created: 2026-01-28T12:50:27Z
updated: 2026-01-30T01:58:13Z
labels: ["agents"]
additions: 39
deletions: 1
changed_files: 2
size: small
review_decision: none
reviews: []
comments_count: 1
reactions_total: 2
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3322
fixes_issues: [1695]
related_prs: [1695]
duplicate_of: null
---

## Description

Fixes #1695

## Problem
When `modelRegistry.find()` returns a model, provider config `models.providers.*.api` was ignored — registry model was used as-is.

## Solution
Shallow clone + merge provider config api when `model.api` is missing.

## Changes
- `src/agents/pi-embedded-runner/model.ts` — 3 lines
- `src/agents/pi-embedded-runner/model.test.ts` — regression test

## Testing
All related tests pass ✓

## Reviews


## Comments

### @nulone (2026-01-30)

CI is failing on canvas-host (503) and workspace-paths (timeout/ENOENT) — this PR only touches model.ts + model.test.ts. Happy to rebase if needed.


## Stats

- **Size:** small (39+, 1-, 2 files)
- **Age:** 2 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #1695
