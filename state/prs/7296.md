---
number: 7296
title: "feat: telegram edit streaming"
author: obviyus
created: 2026-02-02T17:09:33Z
updated: 2026-02-03T04:50:27Z
labels: ["docs", "channel: telegram", "gateway"]
additions: 600
deletions: 218
changed_files: 22
size: large
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 2
ci_status: failing
mergeable: true
draft: true
url: https://github.com/openclaw/openclaw/pull/7296
fixes_issues: [7123]
related_prs: [7123]
duplicate_of: null
---

## Description

## What
- Telegram edit streaming: single-message edits driven by block + partial stream
- Faster edit cadence (cutoff-only, no extra throttling)
- Simplified config: `channels.telegram.streamMode` = off | edit | partial
- Draft chunking removed (no block draft mode)
- Docs + tests updated

## Why
- Closer to desired stream UX: frequent edits without config knobs
- Clearer mode switch, fewer moving parts

## How
- New edit-stream helper drives send/edit with adaptive cutoff
- Partial stream events feed edits; block replies still merge
- RetryAfter + “message is not modified” handled

## Testing
- pnpm vitest src/telegram/bot-message-dispatch.test.ts
- pnpm vitest src/config/config.legacy-config-detection.rejects-routing-allowfrom.test.ts src/auto-reply/reply.block-streaming.test.ts

Fixes #7123.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds Telegram “edit streaming”: when `channels.telegram.streamMode` is set to `edit` (now the default), block-streamed chunks are used to repeatedly edit a single Telegram message, instead of sending multiple incremental messages. It also simplifies Telegram draft streaming to only support the `partial` mode (DM topics via `sendMessageDraft`), removing the previous `block` draft chunking configuration and tests.

Implementation-wise, the new behavior is wired into the Telegram reply dispatcher (`src/telegram/bot-message-dispatch.ts`), which decides between:
- edit streaming (single message edits)
- draft streaming (draft bubble updates)
- normal delivery (multi-message block replies / final)

Config schema + docs are updated accordingly (`channels.telegram.streamMode: off | edit | partial`, default `edit`).

<h3>Confidence Score: 3/5</h3>

- This PR is likely safe to merge, but there is at least one test expectation that appears inconsistent with the implementation and should be corrected.
- Core logic changes are fairly contained to Telegram dispatch/edit streaming, and docs/config updates are consistent. However, the new edit-streaming test assertions don’t match how `editStream.update` is invoked, suggesting CI may fail or the test isn’t exercising the intended path yet.
- src/telegram/bot-message-dispatch.test.ts, src/telegram/bot-message-dispatch.ts

<!-- greptile_other_comments_section -->

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-02)

<sub>3 files reviewed, 3 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** large (600+, 218-, 22 files)
- **Age:** 0 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #7123
