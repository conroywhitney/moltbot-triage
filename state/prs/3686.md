---
number: 3686
title: "fix(security): bind temporary media server to loopback by default"
author: MaxMiksa
created: 2026-01-29T01:54:44Z
updated: 2026-01-29T06:24:09Z
labels: []
additions: 10
deletions: 2
changed_files: 3
size: small
review_decision: none
reviews: [{"author":"orzelig","state":"APPROVED"}]
comments_count: 1
reactions_total: 0
ci_status: failing
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3686
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
The temporary media host (`startMediaServer`) was starting via `app.listen(port)` which binds to all interfaces by default. This is easy to misread as “localhost-only” (especially since the log message suggested `http://localhost:...`).

This PR binds the temporary media server to loopback (`127.0.0.1`) by default and aligns the log output accordingly.

## Security impact
Reduces unintended LAN exposure of temporary hosted media files.

## Changes
- Bind temporary media server to `127.0.0.1` by default (`src/media/server.ts`).
- Update startup log to reflect the actual bind host (`src/media/host.ts`).
- Add a unit test to ensure the default bind address is loopback (`src/media/server.test.ts`).

## Testing
- Added unit test coverage, but I couldn't run `pnpm test` locally because `pnpm install` is currently blocked by a workspace package naming mismatch (see outpost note: ISSUE-0003). CI should validate.

Related outpost analysis: ISSUE-0002-media-server-binds-all-interfaces.

## Reviews

### @orzelig — APPROVED (2026-01-29)

Good security improvement! Binding to loopback by default prevents unintended LAN exposure. Test coverage validates the bind address properly. LGTM!


## Comments

### @MaxMiksa (2026-01-29)

Thanks for the review!

FYI the only failing check on this PR is currently `checks-windows (node, test, pnpm canvas:a2ui:bundle && pnpm test)`.

The Windows failure appears unrelated to this PR’s changes: `src/media-understanding/apply.test.ts` attempts to create `file<test>.txt`, which is an invalid filename on Windows, leading to `ENOENT` at `apply.test.ts#L557`.
Job: https://github.com/moltbot/moltbot/actions/runs/21465485525/job/61826683347

I also see the same pattern on recent Windows runs on other branches / `main`, so it looks like a repo-wide Windows test regression rather than something introduced here.


## Stats

- **Size:** small (10+, 2-, 3 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
