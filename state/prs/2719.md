---
number: 2719
title: "fix(error): Fix OpenAI's Rate Limit error being classified as Context Overflow error"
author: dzz007
created: 2026-01-27T10:25:51Z
updated: 2026-02-03T03:56:05Z
labels: ["agents"]
additions: 2
deletions: 0
changed_files: 1
size: tiny
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/2719
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

Currently OpenAI's RateLimit error is being classified as a ContextLimit error resulting in undefined behaviors. 

This is because 'Request Rate limit reached for gpt-5.2 in organization org-xxx on tokens per min (TPM): Limit 500000, Used 362512, Requested 153920. Please try again in 1.971s' is matching CONTEXT_OVERFLOW_HINT_RE. 

The fix is simple, we should exclude RateLimit errors from ContextLimit errors

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR prevents OpenAI rate-limit errors (e.g., TPM quota messages) from being misclassified as context overflow by adding an early `isRateLimitErrorMessage` guard in `isLikelyContextOverflowError`.

This fits into the existing error-classification helpers in `src/agents/pi-embedded-helpers/errors.ts`, which normalize raw provider error strings into higher-level categories (context overflow, rate limit, overloaded, timeout, etc.) used for UI messaging and failover decisions.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge and narrowly scoped to error classification.
- Change is a simple early-return guard with low blast radius, but correctness depends on how `isContextOverflowError` and the hint regex interact with provider error strings; no tests were added here to lock behavior in.
- src/agents/pi-embedded-helpers/errors.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps â€” COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** tiny (2+, 0-, 1 files)
- **Age:** 6 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
