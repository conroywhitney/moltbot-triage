---
number: 2114
title: "fix(gateway): close server in canBindToHost error handler"
author: Episkey-G
created: 2026-01-26T07:12:05Z
updated: 2026-01-29T02:10:50Z
labels: ["gateway"]
additions: 2
deletions: 0
changed_files: 2
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/moltbot/moltbot/pull/2114
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
- Fix resource leak in `canBindToHost` function ([net.ts:139-151](https://github.com/clawdbot/clawdbot/blob/main/src/gateway/net.ts#L139-L151))
- Ensure `testServer.close()` is called in both success and error paths

## Issue
When `testServer.listen()` fails, the error handler resolves with `false` but doesn't close the server, potentially leaking file descriptors.

## Solution
Added `testServer.close()` call in the error handler (line 143) to match the cleanup in the success handler (line 146).

## Testing
- Manual code review verified the fix follows Node.js best practices
- The change is minimal and defensive: calling `close()` on a server in error state is safe (no-op if not listening)
- Ensures proper resource cleanup in both code paths

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

## Reviews


## Comments


## Stats

- **Size:** tiny (2+, 0-, 2 files)
- **Age:** 3 days
- **Last activity:** 2026-01-29

## Links

- Fixes: (none detected)
