---
number: 2360
title: "feat(security): add mention gating context to open groups warning"
author: spanishflu-est1918
created: 2026-01-26T19:52:33Z
updated: 2026-01-28T23:25:12Z
labels: []
additions: 87
deletions: 10
changed_files: 1
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/moltbot/moltbot/pull/2360
fixes_issues: [2322]
related_prs: [2322]
duplicate_of: null
---

## Description

## Summary

- Adds mention gating context to the `groupPolicy="open"` security audit warning
- Checks if `requireMention` is enabled and `mentionPatterns` are configured
- Downgrades severity from "critical" to "warn" when mention gating is in place
- New checkId: `security.exposure.open_groups_mitigated`

## Changes

- Updated `collectExposureMatrixFindings()` to analyze mention gating configuration
- Added `listGroupPolicyOpenWithMentionInfo()` helper to extract channel/account info
- Shows configured mention patterns in the finding detail
- Provides actionable guidance for both gated and ungated scenarios

## Example Output

**With mention gating:**
```
WARN  security.exposure.open_groups_mitigated  Open groupPolicy with mention gating
  Found groupPolicy="open" at:
  - channels.whatsapp.groupPolicy
  Mitigation detected: requireMention=true with patterns: ["@Hermes", "@mybot"]
  Risk: Reduced but not eliminated (attackers can still mention the bot).
  Fix: Consider switching to groupPolicy="allowlist" for defense in depth.
```

**Without mention gating:**
```
CRITICAL  security.exposure.open_groups_with_elevated  Open groupPolicy with elevated tools enabled
  Found groupPolicy="open" at:
  - channels.whatsapp.groupPolicy
  With tools.elevated enabled, a prompt injection in those rooms can become a high-impact incident.
  Tip: Configure messages.groupChat.mentionPatterns to enable mention gating.
  Fix: Set groupPolicy="allowlist" and keep elevated allowlists extremely tight.
```

## Test plan

- [x] Build passes
- [x] Lint passes
- [x] Format passes
- [x] Existing tests pass

Closes #2322

## Reviews


## Comments


## Stats

- **Size:** medium (87+, 10-, 1 files)
- **Age:** 2 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #2322
