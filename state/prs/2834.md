---
number: 2834
title: "Fix plugin installation to respect manifest ID  "
author: HA2345567
created: 2026-01-27T15:45:09Z
updated: 2026-02-03T03:56:07Z
labels: ["docker"]
additions: 13
deletions: 3
changed_files: 1
size: small
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 3
reactions_total: 1
ci_status: failing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/2834
fixes_issues: [2796]
related_prs: [2796]
duplicate_of: null
---

## Description

fixes #2796

### Summary

Previously, plugin installation derived the install directory from the npm package name,
ignoring the `id` defined in `clawdbot.plugin.json`. This forced verbose plugin IDs and caused
warnings when the manifest ID differed from the package name.

This PR updates the installer to prefer the manifest `id` when available, while keeping the
`package.json` name as a fallback to preserve backward compatibility.

### Changes
- Prefer `clawdbot.plugin.json` `id` as `pluginId`
- Fallback to `package.json` name when manifest ID is missing
- Added tests to verify correct installation behavior with manifest-based IDs

### Result
Plugins can now use clean, short IDs without breaking existing plugins or workflows.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

Updates `.dockerignore` to stop ignoring the entire `apps/` tree and instead ignore only specific large platform app directories (`apps/android/`, `apps/ios/`, `apps/macos/`). Adds clarifying comments about not ignoring `apps/shared/` and `vendor/` if they’re required for builds, while keeping other large top-level directories excluded from Docker contexts.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge; it only adjusts Docker ignore patterns but may increase build context size unexpectedly.
- Only one file changed (`.dockerignore`) and the edits are straightforward. Main concern is behavioral drift: previously ignored large directories (`Swabble/`, possibly `vendor/`) may now be included in Docker contexts, which can slow builds or break assumptions. No code/runtime logic changes.
- .dockerignore

<!-- greptile_other_comments_section -->

<sub>(3/5) Reply to the agent's comments like "Can you suggest a fix for this @greptileai?" or ask follow-up questions!</sub>

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @dial481 (2026-02-01)

Related issue #2796 was closed was closed by triage for inactivity. I don't think the failing checks are related to macOS Swift issues. The plugin fix itself looks like it passes relevant tests. I think this is ready for review. 

### @dial481 (2026-02-02)

I noticed this PR's fix commit appears to have been lost during the rebase on Jan 28 - the branch now only contains formatting changes without the actual `loadPluginManifest` logic.                                                           
                                                                                                                                       
  I've submitted a fresh fix in #7090 that:                                                                                 
  - Imports `loadPluginManifest` from `./manifest.js`                                                                                  
  - Prefers manifest ID over package name for the install folder                                                                       
  - Normalizes manifest ID via `unscopedPackageName()` (trim, strip scope prefix)                                                  
  - Integrates with the new `validatePluginId()` security check                                                                        
  - Falls back to package name if no manifest exists (backward compatible)                                                       
                                                                                                                                       
If you'd prefer to restore this PR instead, please do so and close the new PR. Just wanted to unblock the fix since it's affecting external plugin installations.       

### @greptile-apps (2026-02-03)

<details>
<summary>Additional Comments (1)</summary>

**`.dockerignore`**
The previous `.dockerignore` ignored several large top-level folders (`Swabble/`, `vendor/`, etc.). In this change, `Swabble/` and `vendor/` are no longer ignored, but the comment block suggests they should remain excluded (and `Swabble/` is likely still a large app tree).

If the intent is to keep Docker build contexts small, consider re-adding `Swabble/` (and explicitly deciding on `vendor/` based on whether your Docker build actually needs it). Otherwise, the build context size/regressions may be surprising.

Also note: the “DO NOT ignore vendor (required for A2UI)” comment conflicts with the previous ignore behavior—worth double-checking which is correct for current Docker builds.

<details><summary>Prompt To Fix With AI</summary>

`````markdown
This is a comment left during a code review.
Path: .dockerignore
Line: 54:59

Comment:
The previous `.dockerignore` ignored several large top-level folders (`Swabble/`, `vendor/`, etc.). In this change, `Swabble/` and `vendor/` are no longer ignored, but the comment block suggests they should remain excluded (and `Swabble/` is likely still a large app tree).

If the intent is to keep Docker build contexts small, consider re-adding `Swabble/` (and explicitly deciding on `vendor/` based on whether your Docker build actually needs it). Otherwise, the build context size/regressions may be surprising.

Also note: the “DO NOT ignore vendor (required for A2UI)” comment conflicts with the previous ignore behavior—worth double-checking which is correct for current Docker builds.

How can I resolve this? If you propose a fix, please make it concise.
`````
</details>
</details>


## Stats

- **Size:** small (13+, 3-, 1 files)
- **Age:** 6 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #2796
