---
number: 6612
title: "Add Neo4j skill for AGI relational reasoning"
author: tescolopio
created: 2026-02-01T21:35:25Z
updated: 2026-02-01T21:45:03Z
labels: []
additions: 161
deletions: 0
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"copilot-pull-request-reviewer","state":"COMMENTED"},{"author":"diffray-bot","state":"COMMENTED"}]
comments_count: 2
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6612
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

Adds a Neo4j skill enabling graph-based memory for AGI. Includes MCP server with tools for queries, updates, centrality, and visualization. Secured with RAK framework, containerized.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

Adds a new `neo4j` skill definition and a Dockerfile intended to run a Neo4j MCP server from a Python container. `SKILL.md` documents environment variables and includes an example Python MCP server implementation with tools for querying/updating/centrality/visualization.

Main issues are around packaging correctness and documented security guarantees: the Docker image currently can‚Äôt build because the referenced server file isn‚Äôt included, and the docs claim ‚Äúread-only by default‚Äù while the example server exposes an ungated `update_graph` tool. There are also a couple of reproducibility and usability nits (unpinned deps/EOL base image, and an env var wildcard in `docker run` that won‚Äôt behave as intended).

<h3>Confidence Score: 2/5</h3>

- Not safe to merge as-is due to a build-breaking Dockerfile and mismatched safety claims in docs.
- The Dockerfile references a server file that isn‚Äôt added in the PR, so container builds will fail. Separately, `SKILL.md` states updates are read-only by default, but the provided MCP server example includes an unrestricted update tool, which is a sharp edge for users relying on the documented guarantees. Remaining issues are smaller (reproducibility and command correctness).
- skills/neo4j/Dockerfile, skills/neo4j/SKILL.md

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps ‚Äî COMMENTED (2026-02-01)

<sub>2 files reviewed, 6 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @copilot-pull-request-reviewer ‚Äî COMMENTED (2026-02-01)

## Pull request overview

This PR adds a Neo4j graph database skill for AGI relational reasoning, providing an MCP (Model Context Protocol) server with tools for querying, updating, computing centrality, and visualizing knowledge graphs. The implementation includes embedded Python code in documentation and a Dockerfile for containerization.

**Changes:**
- Added `skills/neo4j/SKILL.md` with MCP server implementation for Neo4j graph operations
- Added `skills/neo4j/Dockerfile` for containerized deployment with security hardening

### Reviewed changes

Copilot reviewed 2 out of 2 changed files in this pull request and generated 21 comments.

| File | Description |
| ---- | ----------- |
| skills/neo4j/SKILL.md | Documentation and embedded Python MCP server code providing four tools: query_graph, update_graph, compute_centrality, and visualize_graph |
| skills/neo4j/Dockerfile | Container definition running the MCP server as non-root user with Python 3.9-slim base |





---

üí° <a href="/openclaw/openclaw/new/main/.github/instructions?filename=*.instructions.md" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Add Copilot custom instructions</a> for smarter, more guided reviews. <a href="https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Learn how to get started</a>.

### @diffray-bot ‚Äî COMMENTED (2026-02-01)




## Comments

### @diffray-bot (2026-02-01)

## Changes Summary

Adds a new Neo4j skill that provides MCP tools for graph database operations including Cypher queries, graph updates, centrality computation, and visualization. The skill is containerized via Docker for secure execution and designed to enable graph-based relational reasoning for AI agents.

**Type:** feature

**Components Affected:** skills, infrastructure, documentation

<details>
<summary><strong>Files Changed</strong></summary>

| File | Summary | Change | Impact |
|:-----|:--------|:------:|:------:|
| `/tmp/workspace/skills/neo4j/Dockerfile` | Dockerfile for containerized Neo4j MCP server using Python 3.9-slim with neo4j driver and non-root user | ‚ûï | üî¥ |
| `/tmp/workspace/skills/neo4j/SKILL.md` | Documentation and embedded MCP server implementation for Neo4j graph operations with setup instructions and security notes | ‚ûï | üî¥ |

</details>

<details>
<summary><strong>Architecture Impact</strong></summary>

- **New Patterns:** MCP tool server pattern, Containerized skill execution, Graph database integration
- **Dependencies:** added: neo4j Python driver, added: Docker runtime dependency
- **Coupling:** Introduces external dependency on Neo4j database instance requiring network connectivity and credentials

</details>

**Risk Areas:** CRITICAL: Dockerfile references neo4j_mcp_server.py file that doesn't exist in the PR - container build will fail, Security mismatch: Documentation claims 'updates are read-only by default' (line 13) but update_graph tool has no approval enforcement, only a comment placeholder (line 79), Cypher injection vulnerability: All tools execute user-provided queries/cypher without validation or sanitization (lines 75, 80, 84, 89), Python 3.9 EOL in October 2025 - consider using Python 3.11+ for longer support, Unpinned dependency: 'pip install neo4j' installs latest version, creating reproducibility issues, Docker command in line 112 uses -e NEO4J_* wildcard which won't expand in docker run (shell doesn't expand before docker sees it), Missing error handling: JSON parsing (line 103), database connection failures, and query execution errors can crash the server, Credentials stored in environment variables with hardcoded defaults (line 36) - default password 'password' is insecure, No input validation on tool parameters before database execution, Missing read-only filesystem claim enforcement in Dockerfile - no --read-only flag documented

<details>
<summary><strong>Suggestions</strong></summary>

- Add the missing neo4j_mcp_server.py file to the repository or remove the COPY instruction from Dockerfile
- Implement actual approval checking mechanism for update_graph tool or remove the misleading 'read-only by default' claim from documentation
- Add input validation and sanitization for all Cypher queries to prevent injection attacks
- Pin neo4j driver to specific version (e.g., 'pip install neo4j==5.15.0')
- Upgrade base image to python:3.11-slim or python:3.12-slim for extended support
- Fix Docker command example to properly pass environment variables: docker run --rm -e NEO4J_URI -e NEO4J_USER -e NEO4J_PASSWORD ...
- Add try-except blocks for JSON parsing, database operations, and query execution with proper error responses
- Remove hardcoded default credentials or add warnings about changing them
- Consider parameterized queries or allowlists for common query patterns
- Add --read-only flag to Docker run command if claiming read-only filesystem protection
- Add connection pooling configuration and timeout settings for production use
- Consider adding schema validation for tool input parameters

</details>


<sub>Full review in progress... | Powered by <a href="https://diffray.ai?utm_source=github-summary">diffray</a></sub>

### @diffray-bot (2026-02-01)

## Review Summary

> **Free public review** - Want AI code reviews on your PRs? Check out [diffray.ai](https://diffray.ai/open-source/?utm_source=github-public)

Validated 14 issues: 10 kept, 4 filtered (2 false positives, 2 low confidence)

### Issues Found: 10

üí¨ See 10 individual line comment(s) for details.

üìä 7 unique issue type(s) across 10 location(s)

<details>
<summary>üìã Full issue list (click to expand)</summary>


#### üî¥ CRITICAL - COPY instruction references non-existent file

**Agent:** docker

**Category:** bug

**File:** `skills/neo4j/Dockerfile:5`

**Description:** The Dockerfile attempts to copy 'neo4j_mcp_server.py' but this file does not exist in the skills/neo4j directory. The Docker build will fail.

**Suggestion:** Create the neo4j_mcp_server.py file in the skills/neo4j directory (the code is shown in SKILL.md lines 27-109) before building the Docker image.

**Confidence:** 100%

**Rule:** `docker_copy_missing_source`

---

#### üî¥ CRITICAL - Cypher Injection - Arbitrary Query Execution (2 occurrences)

**Agent:** [security](https://diffray.ai/agents/security)

**Category:** security

<details>
<summary>üìç View all locations</summary>

| File | Description | Suggestion | Confidence |
|------|-------------|------------|------------|
| `skills/neo4j/SKILL.md:75-80` | The query_graph and update_graph tools execute user-supplied Cypher queries without parameterization... | Implement parameterized queries using Neo4j's parameter syntax. Add query allowlisting or strict val... | 95% |
| `skills/neo4j/SKILL.md:83` | The compute_centrality function builds Cypher queries using f-string interpolation with user-control... | Use parameterized queries instead of string interpolation, or validate inputs against an allowlist o... | 92% |

</details>

**Rule:** `sec_semgrep_scan`

---

#### üü† HIGH - Base image not pinned with digest

**Agent:** microservices

**Category:** security

**File:** `skills/neo4j/Dockerfile:1`

**Description:** The FROM instruction uses python:3.9-slim without a SHA256 digest. This creates a security vulnerability and non-reproducible builds.

**Suggestion:** Pin the base image with both a specific patch version and content digest. Example: FROM python:3.9.18-slim@sha256:<digest>

**Confidence:** 95%

**Rule:** `docker_pin_exact_versions_with_digests_for_base`

---

#### üü† HIGH - Unpinned pip dependency

**Agent:** [quality](https://diffray.ai/agents/quality)

**Category:** quality

**File:** `skills/neo4j/Dockerfile:3`

**Description:** The neo4j package is installed without a version pin. This can introduce breaking changes or unexpected behavior when new versions are released.

**Suggestion:** Pin to a specific version: 'RUN pip install neo4j==5.15.0' (use latest stable version appropriate for your use case)

**Confidence:** 95%

**Rule:** `docker_unpinned_base_image`

---

#### üü† HIGH - Neo4j Docker image using 'latest' tag (3 occurrences)

**Agent:** [quality](https://diffray.ai/agents/quality)

**Category:** quality

<details>
<summary>üìç View all locations</summary>

| File | Description | Suggestion | Confidence |
|------|-------------|------------|------------|
| `skills/neo4j/SKILL.md:21` | The setup instructions use 'neo4j:latest' which is explicitly unpinned. This can introduce breaking ... | Pin to a specific Neo4j version: 'neo4j:5.15.0' or 'neo4j:5.15.0-community' | 90% |
| `skills/neo4j/SKILL.md:112` | The runtime example uses 'python:3.9-slim' without OS distribution pin, demonstrating poor practice ... | Update to 'python:3.9-slim-bookworm' to match the pinned Dockerfile recommendation | 75% |
| `skills/neo4j/SKILL.md:22` | The setup instructions install the neo4j package without version pinning, which can lead to inconsis... | Pin to a specific version in the documentation: 'pip install neo4j==5.15.0' and document which versi... | 70% |

</details>

**Rule:** `config_unpinned_dependencies`

---

#### üü† HIGH - Package manager cache not cleaned

**Agent:** microservices

**Category:** performance

**File:** `skills/neo4j/Dockerfile:3`

**Description:** The 'pip install' command does not use --no-cache-dir flag, causing pip to cache downloaded packages in the image layer and unnecessarily increasing image size.

**Suggestion:** Add --no-cache-dir flag to pip install: RUN pip install --no-cache-dir neo4j

**Confidence:** 90%

**Rule:** `docker_no_cache_clean`

---

#### üü° MEDIUM - Missing HEALTHCHECK instruction

**Agent:** microservices

**Category:** quality

**File:** `skills/neo4j/Dockerfile:11`

**Description:** This Dockerfile launches a service but lacks a HEALTHCHECK instruction. Container orchestrators cannot detect when the application becomes unresponsive.

**Suggestion:** Add a HEALTHCHECK instruction before CMD to verify the service is responding correctly.

**Confidence:** 75%

**Rule:** `docker_no_healthcheck`

---

</details>

üîó [View full review details](https://app.diffray.ai/reviews/6202737f-f748-4c9e-ab3d-0a3a89fbe78b)

---
<sub>Review ID: `6202737f-f748-4c9e-ab3d-0a3a89fbe78b`</sub>
<sub>Rate it üëç or üëé to improve future reviews | Powered by <a href="https://diffray.ai?utm_source=github-private-note">diffray</a></sub>


## Stats

- **Size:** medium (161+, 0-, 2 files)
- **Age:** 1 days
- **Last activity:** 2026-02-01

## Links

- Fixes: (none detected)
