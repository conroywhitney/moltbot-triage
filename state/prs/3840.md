---
number: 3840
title: "fix(gateway): prevent unnecessary restarts from meta.lastTouchedAt changes"
author: ai-fanatic
created: 2026-01-29T07:27:18Z
updated: 2026-01-29T07:27:28Z
labels: ["gateway"]
additions: 7
deletions: 0
changed_files: 2
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3840
fixes_issues: [3811]
related_prs: [3811]
duplicate_of: null
---

## Description

## Summary
- Adds `{ prefix: "meta", kind: "none" }` to `BASE_RELOAD_RULES_TAIL` in config-reload.ts
- Adds test case to verify `meta.lastTouchedAt` is treated as no-op

## Problem
When a tool modifies the config (e.g., `clawdbot agents add`), the `meta.lastTouchedAt` field gets updated. This triggered a full gateway restart via SIGUSR1, which aborted any in-flight LLM requests.

**Impact**: User experience was broken - the agent would do agentic work (run tools), but never send a final response because the HTTP request to Anthropic/OpenAI was aborted.

**Reproduction**:
1. User messages agent
2. Agent calls a tool that modifies clawdbot.json
3. Tool completes, writes to config
4. Config watcher detects change
5. Reload logic sees `meta.lastTouchedAt` changed
6. No rule exists for `meta` prefix â†’ falls through to `restartGateway = true`
7. Gateway restarts, aborting in-flight requests

## Solution
Add `meta` to the list of no-op prefixes, similar to `identity`, `wizard`, and other metadata-like fields. Changes to `meta.*` fields will no longer trigger gateway restarts.

## Files changed
- `src/gateway/config-reload.ts` - Add `{ prefix: "meta", kind: "none" }` rule
- `src/gateway/config-reload.test.ts` - Add test case for `meta.lastTouchedAt`

## Test plan
- [x] Added unit test: `meta.lastTouchedAt` treated as no-op
- [ ] Manual test: Trigger a tool that modifies config during conversation, verify no restart

Fixes #3811

---

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

## Reviews


## Comments


## Stats

- **Size:** tiny (7+, 0-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: #3811
