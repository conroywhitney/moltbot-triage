---
number: 3622
title: "fix(agents): drop orphan tool results"
author: mickobizzle
created: 2026-01-28T23:00:02Z
updated: 2026-01-28T23:00:12Z
labels: ["agents"]
additions: 30
deletions: 0
changed_files: 3
size: small
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/3622
fixes_issues: [3621]
related_prs: [3621]
duplicate_of: null
---

## Description

## Summary
Drops orphan toolResult messages that arrive without a matching pending tool call, preventing corrupted transcripts that can trigger repeated "No tool call found" loops.

## Details
- Adds a guard option (default enabled) to ignore orphan toolResult messages.
- Wires the option through the guard wrapper.
- Adds a test to cover the orphan-drop behavior.

## Why
A session can end up with a toolResult persisted without its toolCall (e.g., interrupted tool call). Replaying that session repeatedly hits the error and can burn tokens. This prevents new corruption at persistence time.

## Tests
- `pnpm vitest src/agents/session-tool-result-guard.test.ts`

## Issue
Closes #3621

## Reviews


## Comments


## Stats

- **Size:** small (30+, 0-, 3 files)
- **Age:** 1 days
- **Last activity:** 2026-01-28

## Links

- Fixes: #3621
