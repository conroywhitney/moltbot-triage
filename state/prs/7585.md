---
number: 7585
title: "Tests: fix lint in discord auto-thread race test"
author: justinhuangcode
created: 2026-02-03T00:43:14Z
updated: 2026-02-03T00:44:16Z
labels: ["channel: discord"]
additions: 83
deletions: 1
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: pending
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/7585
fixes_issues: []
related_prs: [7517]
duplicate_of: null
---

## Description

## Summary
- remove unused local in the new discord auto-thread race test to satisfy oxlint

## Testing
- not run (lint-only change)

## Notes
- fixes the lint failure reported on #7517

AI-assisted: Yes (Codex). Prompts/session logs available on request.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates Discord auto-thread creation logic to handle a race where another agent already created a thread: on thread creation failure, it refetches the message and reuses the existing thread ID if present. It also adds unit coverage for the race-condition fallback path in `maybeCreateDiscordAutoThread` and updates the log message to be more specific about creation failures.

<h3>Confidence Score: 4/5</h3>

- This PR is safe to merge with low risk.
- Changes are small and localized (a fallback refetch in one function plus tests). Main remaining concern is reduced observability because the refetch failure is silently swallowed, which could hinder debugging but shouldn’t break core behavior.
- src/discord/monitor/threading.ts

<!-- greptile_other_comments_section -->

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (83+, 1-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-02-03

## Links

- Fixes: (none detected)
