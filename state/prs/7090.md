---
number: 7090
title: "fix: plugin install uses manifest ID for folder name (#2796)"
author: dial481
created: 2026-02-02T11:22:59Z
updated: 2026-02-02T11:55:37Z
labels: []
additions: 7
deletions: 1
changed_files: 1
size: tiny
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 2
reactions_total: 1
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/7090
fixes_issues: [2796]
related_prs: [2796]
duplicate_of: null
---

## Description

**AI Assisted**
**Tested**

 ## Summary                                                                                                                           
- Plugin installation now prefers the `id` from `openclaw.plugin.json` over the npm package name for the installation folder         
- Falls back to package name if no manifest or ID is found (backward compatible)                                                     
                                                                                                                                       
 ## Problem                                                                                                                           
When installing a plugin like `openclaw-penfield` (npm package name), it would install to `/extensions/openclaw-penfield/` even if he manifest specified `id: "penfield"`.                                                                                             
                                                                                                                                       
## Solution                                                                                                                          
Read `openclaw.plugin.json` during install and use the manifest ID if available.                                                     
                                                                                                                                       
  ## Tests                                                                                                    
 - [x] Tested with openclaw-penfield plugin (manifest ID differs from package name)                                                   
 - [x] Verified fallback works when no manifest exists                                                                                
 - [ ] Existing unit tests pass                                                                                                       
                                                                                                                                       
Fixes #2796

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR updates plugin installation to prefer the `id` from `openclaw.plugin.json` when choosing the extensions folder name, falling back to the npm package name when no valid manifest/id is available. The change is localized to `src/plugins/install.ts` and reuses the existing `loadPluginManifest()` helper used elsewhere in the plugins subsystem, keeping the rest of the install flow (copy, dependency install, backups on update) unchanged.

<h3>Confidence Score: 4/5</h3>

- This PR is generally safe to merge; it’s a small behavioral change in plugin directory naming with limited surface area.
- The change is simple and leverages existing manifest parsing, but it introduces a new source of truth for `pluginId` that may contain unexpected characters or formatting differences compared to npm-derived IDs, which can affect install paths and `expectedPluginId` checks.
- src/plugins/install.ts

<!-- greptile_other_comments_section -->

<sub>(3/5) Reply to the agent's comments like "Can you suggest a fix for this @greptileai?" or ask follow-up questions!</sub>

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-02)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @dial481 (2026-02-02)

Resolved @greptile-apps sanitization issue.

### @greptile-apps (2026-02-02)

Great! I can see you've addressed the sanitization concern by applying the same `unscopedPackageName()` normalization to the manifest ID that was already being applied to the package name. This ensures consistent handling and prevents any potential path traversal issues that could arise from using raw manifest IDs.

The change at lines 153-157 properly sanitizes the manifest ID by:
1. Extracting the raw manifest ID from the plugin manifest
2. Applying `unscopedPackageName()` to normalize it (removes scope prefixes, trims whitespace)
3. Using the normalized manifest ID or falling back to the package name

This maintains the security benefits of the existing sanitization while implementing the feature. The fix looks solid!


## Stats

- **Size:** tiny (7+, 1-, 1 files)
- **Age:** 0 days
- **Last activity:** 2026-02-02

## Links

- Fixes: #2796
