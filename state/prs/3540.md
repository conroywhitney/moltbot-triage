---
number: 3540
title: "fix: respect toolsEnabled config for CLI backends [AI-assisted]"
author: ryanmcmillan
created: 2026-01-28T19:54:21Z
updated: 2026-01-28T23:25:08Z
labels: ["agents"]
additions: 4
deletions: 1
changed_files: 2
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3540
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Problem
When using CLI backends like Claude CLI with `--allowedTools`, the system prompt incorrectly states "Tools are disabled in this session. Do not call tools." even though tools ARE enabled.

This causes the model to refuse to use tools that are actually available.

## Solution
Add a `toolsEnabled` boolean option to `CliBackendConfig`. When `true`, the "Tools are disabled" system prompt injection is skipped.

Default behavior is unchanged (tools assumed disabled unless explicitly enabled).

## Usage
```json
{
  "agents": {
    "defaults": {
      "cliBackends": {
        "claude-cli": {
          "args": ["-p", "--output-format", "json", "--allowedTools", "Bash Edit Write"],
          "toolsEnabled": true
        }
      }
    }
  }
}
```

## Testing
- Tested locally on a moltbot instance with Claude CLI and `--allowedTools`
- Linted with `npm run lint`

ðŸ¤– AI-assisted (Claude Code) - fully tested on live instance

## Reviews


## Comments


## Stats

- **Size:** tiny (4+, 1-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
