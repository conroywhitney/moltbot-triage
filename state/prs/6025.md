---
number: 6025
title: "signal: resolve mentions in inbound messages"
author: lightclient
created: 2026-02-01T06:28:48Z
updated: 2026-02-01T22:49:03Z
labels: ["channel: signal"]
additions: 137
deletions: 2
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 3
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6025
fixes_issues: [1926]
related_prs: [1926]
duplicate_of: null
---

## Description

fixes #1926

Signal messages with mentions embed `U+FFFC` (Object Replacement Character) as a placeholder in the message body, with the actual mention data (name, UUID, start position, length) in a separate dataMessage.mentions array. OpenClaw was passing the raw message text through without resolving these placeholders, so mentions appeared as invisible/broken characters to the agent.

This adds resolveSignalMentions() which replaces each U+FFFC placeholder with @name using the mention metadata. Since signal-cli sometimes puts the UUID as the name field (for users not in the local address book), a name cache is seeded from listContacts profile data at startup and continuously updated from envelope.sourceName on every inbound SSE event, with fallbacks to phone number then UUID.

Tested in a live Signal group with mentions of both contacts (resolved via profile name from listContacts) and non-contacts/bots (resolved via the SSE sourceName cache). Also includes a new SignalMention type and mentions field on SignalDataMessage.

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR adds Signal mention support by introducing a `SignalMention` type on inbound `SignalDataMessage`, seeding a UUID→display-name cache from `listContacts`, updating it opportunistically from `envelope.sourceName`, and replacing U+FFFC placeholders in `dataMessage.message` with `@name` based on the `mentions` metadata.

The change is localized to the Signal SSE receive path (`src/signal/monitor/event-handler.ts`) and the associated payload typings (`src/signal/monitor/event-handler.types.ts`), improving how inbound messages are rendered for downstream routing/command detection/agent prompts.

<h3>Confidence Score: 3/5</h3>

- This PR is likely safe to merge, but has a couple edge-case correctness issues around mention seeding and offset handling.
- Core logic is straightforward and scoped, but mention index handling currently trusts external offsets (can corrupt text on malformed/inconsistent payloads) and the cache seeding guard can permanently disable seeding after a transient failure and may still allow overlapping calls early on.
- src/signal/monitor/event-handler.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-01)

<sub>1 file reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (137+, 2-, 2 files)
- **Age:** 1 days
- **Last activity:** 2026-02-01

## Links

- Fixes: #1926
