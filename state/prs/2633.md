---
number: 2633
title: "feat(signal): auto-detect persistent storage for containerized deployments"
author: steve-rodri
created: 2026-01-27T07:29:17Z
updated: 2026-01-28T23:25:11Z
labels: ["channel: signal"]
additions: 84
deletions: 0
changed_files: 1
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/2633
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary

- Adds `setupSignalDataPersistence()` function to auto-detect and configure persistent storage for signal-cli in containerized environments
- Automatically symlinks `~/.local/share/signal-cli` to persistent storage when detected
- Prevents Signal account data loss on container restarts

## Implementation Details

The function follows this priority order for persistent storage:

1. `SIGNAL_CLI_DATA_DIR` environment variable (explicit override)
2. `/data/.local/share/signal-cli` (Fly.io convention)
3. `/var/lib/clawdbot/.local/share/signal-cli` (alternative persistent location)
4. Default `~/.local/share/signal-cli` (no symlink needed)

The persistence setup:
- Runs automatically when spawning the Signal daemon
- Checks for existing directories/symlinks before creating new ones
- Creates necessary parent directories and the `data` subdirectory
- Logs actions for visibility
- Gracefully handles errors without breaking daemon startup

## Test plan

- [x] Build passes (`pnpm build`)
- [x] Type checks pass
- [x] Tested on Fly.io deployment with persistent `/data` volume
- [x] Signal account data persists across container restarts
- [x] Works in non-containerized environments (uses default path)

## Benefits

- **Zero configuration**: Works automatically in common containerized environments
- **Backwards compatible**: Doesn't affect existing deployments or non-containerized setups
- **Flexible**: Supports environment variable override for custom setups
- **Safe**: Preserves existing directories and symlinks

ðŸ¤– Generated with Claude Opus 4.5

## Reviews


## Comments


## Stats

- **Size:** medium (84+, 0-, 1 files)
- **Age:** 2 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
