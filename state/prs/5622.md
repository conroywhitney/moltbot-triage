---
number: 5622
title: "fix(onboard): parse space-separated channel allowlist entries"
author: niemesrw
created: 2026-01-31T18:49:05Z
updated: 2026-01-31T18:53:39Z
labels: []
additions: 75
deletions: 1
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"},{"author":"copilot-pull-request-reviewer","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/5622
fixes_issues: [5617]
related_prs: [5617]
duplicate_of: null
---

## Description

## Summary

Fixes #5617

The channel allowlist prompt during `openclaw onboard` says "comma-separated" but users often enter space-separated values like `#ryan #openclaw-discussion`. Previously this was saved as a single config key, causing channel matching to fail silently.

**Before:** `"#ryan #openclaw-discussion": { "allow": true }` (one broken key)
**After:** `"#ryan": { "allow": true }, "#openclaw-discussion": { "allow": true }` (two correct keys)

## Changes

- Updated `parseAllowlistEntries()` to split on comma, semicolon, space, or newline
- Added comprehensive test coverage for the parsing function

## Test plan

- [x] All 14 new tests pass
- [x] Verified fix handles: comma-separated, space-separated, semicolon-separated, newline-separated, and mixed inputs
- [x] Edge cases covered: empty input, single entry, extra whitespace

ü¶û Generated with [Claude Code](https://claude.ai/claude-code)

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR fixes `openclaw onboard` allowlist parsing so users can enter channels separated by spaces (and other common separators) instead of only commas/newlines. The core change updates `parseAllowlistEntries()` to split on commas, semicolons, and whitespace, and adds a new `channel-access.test.ts` suite with a range of parsing/formatting cases.

This fits into the onboarding plugin by ensuring `promptChannelAllowlist()` produces a normalized `string[]` even when user input doesn‚Äôt match the prompt‚Äôs stated ‚Äúcomma-separated‚Äù format, preventing silent allowlist mismatches in downstream channel matching logic.

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge and should fix the reported onboarding allowlist parsing issue.
- Change is localized to a small helper function and adds targeted unit tests. The main risk is subtle over-splitting due to using `\s` (broader than space/newline) and the tests using type casts for null/undefined despite the function being typed as `string`.
- src/channels/plugins/onboarding/channel-access.ts

<!-- greptile_other_comments_section -->

<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps ‚Äî COMMENTED (2026-01-31)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>

### @copilot-pull-request-reviewer ‚Äî COMMENTED (2026-01-31)

## Pull request overview

This PR attempts to fix issue #5617 where users enter space-separated channel names during the onboarding wizard, but these are incorrectly saved as a single configuration key. The fix modifies the `parseAllowlistEntries()` function to split on commas, semicolons, spaces, and newlines instead of just commas and newlines.

**Changes:**
- Modified regex pattern in `parseAllowlistEntries()` from `/[,\n]/g` to `/[,;\s]+/g` to support multiple separator types
- Added 14 new test cases covering various separator combinations and edge cases

### Reviewed changes

Copilot reviewed 2 out of 2 changed files in this pull request and generated 4 comments.

| File | Description |
| ---- | ----------- |
| src/channels/plugins/onboarding/channel-access.ts | Updated regex pattern to split allowlist entries on comma, semicolon, space, or newline |
| src/channels/plugins/onboarding/channel-access.test.ts | Added comprehensive test coverage for the parsing function with various separator types |





---

üí° <a href="/openclaw/openclaw/new/main/.github/instructions?filename=*.instructions.md" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Add Copilot custom instructions</a> for smarter, more guided reviews. <a href="https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot" class="Link--inTextBlock" target="_blank" rel="noopener noreferrer">Learn how to get started</a>.


## Comments


## Stats

- **Size:** medium (75+, 1-, 2 files)
- **Age:** 2 days
- **Last activity:** 2026-01-31

## Links

- Fixes: #5617
