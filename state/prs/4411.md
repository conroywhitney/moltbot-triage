---
number: 4411
title: "fix(telegram): guard against empty message text in sendTelegramText"
author: lennox-saint
created: 2026-01-30T05:56:35Z
updated: 2026-01-30T05:56:44Z
labels: ["channel: telegram"]
additions: 5
deletions: 1
changed_files: 1
size: tiny
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4411
fixes_issues: [4409]
related_prs: [323,4409]
duplicate_of: null
---

## Description

## The Problem

Block replies occasionally fail with:
```
[telegram] block reply failed: GrammyError: Call to 'sendMessage' failed! (400: Bad Request: message text is empty)
```

The Telegram Bot API rejects `sendMessage` calls when the `text` parameter is empty.

## Root Cause

The `sendTelegramText` function in `src/telegram/bot/delivery.ts` doesn't check if text is empty before calling `bot.api.sendMessage()`.

## The Fix

1. **Guard in sendTelegramText()** - Early return if text is empty/whitespace-only:
   ```typescript
   if (!text?.trim()) {
     logVerbose("sendTelegramText: skipping empty message");
     return undefined;
   }
   ```

2. **Strengthen chunk iteration check** - Skip chunks with empty html:
   ```typescript
   if (!chunk?.html?.trim()) continue;
   ```

## References

- Telegraf Issue #323 (same error): https://github.com/telegraf/telegraf/issues/323
- TelegramBotAPI Errors: https://github.com/TelegramBotAPI/errors

Closes #4409

## Reviews


## Comments


## Stats

- **Size:** tiny (5+, 1-, 1 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #4409
