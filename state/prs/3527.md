---
number: 3527
title: "fix: detect and manage systemd system services"
author: growthringsadvisory
created: 2026-01-28T18:57:36Z
updated: 2026-01-29T21:48:06Z
labels: ["gateway"]
additions: 186
deletions: 165
changed_files: 1
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: false
draft: false
url: https://github.com/openclaw/openclaw/pull/3527
fixes_issues: [1818]
related_prs: [1818,3440]
duplicate_of: null
---

## Description

## Problem

The CLI only detected and managed systemd user services (~/.config/systemd/user/), which failed on VPS/server installs where the gateway runs as a system service (/etc/systemd/system/).

This caused:
- clawdbot status to incorrectly report "Gateway service | systemd not installed"
- clawdbot gateway restart to fail with "systemctl --user unavailable"

Fixes #1818

## Related Work

Complements PR #3440 which adds systemd templates for production deployment. This PR makes the CLI actually detect and manage those system services once installed.

## Changes

- Check both user and system service paths for unit files
- Try user service first, fall back to system service with sudo
- Update isSystemdServiceEnabled to check both locations
- Update readSystemdServiceRuntime to read from both locations  
- Update stop/restart to work with both service types
- Add resolveSystemdSystemUnitPathForName helper

## Testing

- [ ] Test on system with user service (should work as before)
- [ ] Test on system with system service (should now detect correctly)
- [ ] Test clawdbot status shows correct service status
- [ ] Test service management commands work with system service

## Backwards Compatibility

User services are still preferred. The changes only add fallback to system services when user services aren't found or accessible.

## Reviews


## Comments


## Stats

- **Size:** large (186+, 165-, 1 files)
- **Age:** 1 days
- **Last activity:** 2026-01-29

## Links

- Fixes: #1818
