---
number: 3510
title: "fix(voice-call): wait for TTS completion before notify hangup"
author: hershey-g
created: 2026-01-28T18:09:58Z
updated: 2026-01-28T23:25:08Z
labels: ["channel: voice-call"]
additions: 185
deletions: 93
changed_files: 4
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3510
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
Fix voice call notify mode hanging up before TTS completes

## Problems Fixed
1. Notify mode used fixed timer (3s default) that cut off longer messages
2. No handling for Telnyx `call.speak.ended` webhook event

## Solution
- Add `call.speak.ended` event type and handler
- Track calls pending speak completion in `pendingNotifyHangup` Set
- Hangup triggers on speak completion event (with fallback timer)
- Fix sandbox vs embedded mode detection for RPC

## Testing
- Tested on Telnyx provider with various message lengths
- Short messages complete correctly
- Long messages now wait for TTS to finish

## Reviews


## Comments


## Stats

- **Size:** large (185+, 93-, 4 files)
- **Age:** 0 days
- **Last activity:** 2026-01-28

## Links

- Fixes: (none detected)
