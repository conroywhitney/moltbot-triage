---
number: 3868
title: "fix(slack): support multiple file attachments in messages"
author: HirokiKobayashi-R
created: 2026-01-29T08:16:55Z
updated: 2026-01-29T08:20:42Z
labels: ["channel: slack", "agents"]
additions: 186
deletions: 26
changed_files: 5
size: large
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: pending
mergeable: true
draft: false
url: https://github.com/moltbot/moltbot/pull/3868
fixes_issues: [2348]
related_prs: [148,2348]
duplicate_of: null
---

## Description

## Summary
- Add `resolveSlackMediaAll()` function that returns all successfully downloaded files
- Update `prepareSlackMessage` to use `MediaPaths`, `MediaUrls`, `MediaTypes` for multiple files
- Maintain backward compatibility by keeping `MediaPath`/`MediaType`/`MediaUrl` for first file

Fixes #2348

Also related to metelix/rin-agent#148 (thread image attachments not working)

## Changes
- `src/slack/monitor/media.ts`: New `resolveSlackMediaAll()` function, deprecate single-file `resolveSlackMedia()`
- `src/slack/monitor/message-handler/prepare.ts`: Use new multi-file API
- `src/slack/monitor/media.test.ts`: Add tests for multi-file handling

## Test plan
- [x] New unit tests for `resolveSlackMediaAll()`
- [x] All existing Slack tests pass (129 tests)
- [x] `pnpm lint && pnpm build` passes

## Reviews


## Comments


## Stats

- **Size:** large (186+, 26-, 5 files)
- **Age:** 0 days
- **Last activity:** 2026-01-29

## Links

- Fixes: #2348
