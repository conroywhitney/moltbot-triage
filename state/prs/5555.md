---
number: 5555
title: "fix: skip audio/video from text extraction in extractFileBlocks"
author: kxevol
created: 2026-01-31T16:42:16Z
updated: 2026-02-02T00:43:47Z
labels: []
additions: 5
deletions: 1
changed_files: 1
size: tiny
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/5555
fixes_issues: [5209]
related_prs: [5209,5236]
duplicate_of: null
---

## Description

## Summary

Always skip audio/video from text extraction in `extractFileBlocks` — they are handled by the transcription/description pipeline in `runCapability`.

## Problem

The old `!textLike` guard was bypassed by `resolveUtf16Charset` detecting binary null bytes in OGG/audio data as UTF-16, causing raw binary content to be dumped as a `<file>` block in the conversation.

## Fix

Replace the `kind === "audio" && !textLike` condition with `kind === "audio" || kind === "video"` to unconditionally skip both audio and video files from text extraction, since they have their own dedicated processing pipeline.

Fixes #5209

---

*Split from #5236 as requested by @sfo2001.*

## Reviews

### @greptile-apps — COMMENTED (2026-01-31)

<sub>No files reviewed, no comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** tiny (5+, 1-, 1 files)
- **Age:** 2 days
- **Last activity:** 2026-02-02

## Links

- Fixes: #5209
