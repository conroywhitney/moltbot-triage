---
number: 6458
title: "fix(discord): pass message parameter through for forum thread creation"
author: David-Marsh-Photo
created: 2026-02-01T17:37:43Z
updated: 2026-02-01T23:55:40Z
labels: ["channel: discord", "agents"]
additions: 115
deletions: 6
changed_files: 8
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 0
reactions_total: 1
ci_status: failing
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/6458
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

## Summary
Wire up the message parameter in the message tool's thread-create action handler so forum posts can be created via the message tool.

## Changes
1. **handle-action.ts**: Read the `message` param and transform to `{ content: ... }` object
2. **discord-actions-messaging.ts**: Extract the message object from params and pass it to `createThreadDiscord`
3. Also includes the underlying forum thread support from commit 23fd4b960 (adds message/appliedTags to DiscordThreadCreate type and updates createThreadDiscord)

## Usage
```
message action=thread-create channelId=<forum-channel-id> threadName="Test Post" message="This is the content"
```

## Testing
- `pnpm test src/discord/send.creates-thread.test.ts` - all 19 tests pass

Closes weston-5d9

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR wires a `message` payload through the Discord “thread create” action so forum/media channel posts can be created without a source `messageId`. Concretely:
- `handle-action.ts` now reads the `message` string param for `thread-create` and maps it to `{ content }`.
- `discord-actions-messaging.ts` now forwards an optional `{ content }` object into `createThreadDiscord`.
- `createThreadDiscord` gains a forum-post branch (no `messageId`, has `message`) that posts to `Routes.threads(channelId)` and supports `applied_tags`.
- Tests add coverage for forum posts, applied tags, and archive duration.

Overall the change fits the existing Discord send surface by extending the `DiscordThreadCreate` payload and keeping the existing “thread from existing message” behavior as the default route.

<h3>Confidence Score: 4/5</h3>

- This PR is reasonably safe to merge; changes are small and covered by targeted tests.
- Behavioral change is localized to Discord thread creation and mostly additive (new forum-post path plus payload plumbing). Tests cover the new branches. The main concern is a minor falsy check (`autoArchiveMinutes`) that could drop an explicit 0 value, plus some light runtime type validation gaps for the new `message` object.
- src/discord/send.messages.ts (autoArchiveMinutes truthiness check); src/agents/tools/discord-actions-messaging.ts (message.content validation)

<!-- greptile_other_comments_section -->

**Context used:**

- Context from `dashboard` - CLAUDE.md ([source](https://app.greptile.com/review/custom-context?memory=fd949e91-5c3a-4ab5-90a1-cbe184fd6ce8))
- Context from `dashboard` - AGENTS.md ([source](https://app.greptile.com/review/custom-context?memory=0d0c8278-ef8e-4d6c-ab21-f5527e322f13))

<!-- /greptile_comment -->

## Reviews

### @greptile-apps — COMMENTED (2026-02-01)

<sub>2 files reviewed, 2 comments</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments


## Stats

- **Size:** medium (115+, 6-, 8 files)
- **Age:** 1 days
- **Last activity:** 2026-02-01

## Links

- Fixes: (none detected)
