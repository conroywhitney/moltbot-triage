---
number: 4196
title: "fix: add missing firecrawl schema to tools.web.fetch config"
author: abimaelmartell
created: 2026-01-29T21:12:19Z
updated: 2026-02-03T02:51:31Z
labels: []
additions: 52
deletions: 0
changed_files: 2
size: medium
review_decision: none
reviews: [{"author":"greptile-apps","state":"COMMENTED"}]
comments_count: 1
reactions_total: 1
ci_status: failing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4196
fixes_issues: [2527]
related_prs: [2527]
duplicate_of: null
---

## Description

# Summary

- Adds missing firecrawl nested object schema to tools.web.fetch config
- Adds missing readability boolean to tools.web.fetch config
- Fixes config validation error: Unrecognized key: "firecrawl"

## Details

The tools.web.fetch schema used .strict() (equivalent to additionalProperties: false) but was missing the firecrawl and readability properties that were already:

1. Documented in uiHints (tools.web.fetch.firecrawl.*)
2. Used by the code in src/agents/tools/web-fetch.ts

This prevented users from configuring self-hosted Firecrawl instances via config since baseUrl has no env var fallback.

## Test plan

- Added test to ensure config works
- Type check passes
- All tests pass
- Lint passes


Fixes #2527

<!-- greptile_comment -->

<h2>Greptile Overview</h2>

<h3>Greptile Summary</h3>

This PR extends the runtime config Zod schema for `tools.web.fetch` to include previously-documented-but-rejected keys: `readability` and a nested `firecrawl` object (enabled/apiKey/baseUrl/onlyMainContent/maxAgeMs/timeoutSeconds). This aligns the strict schema (`.strict()`) with what `src/agents/tools/web-fetch.ts` already reads from config and what the UI hints in `src/config/schema.ts` already describe.

A new config schema test was added to ensure `tools.web.fetch.firecrawl` and `tools.web.fetch.readability` are accepted by the schema.

Note: the new test currently uses `MoltbotSchema.safeParse` directly; most existing config tests go through `validateConfigObject`, which exercises the full validation pipeline (legacy checks + default application).

<h3>Confidence Score: 4/5</h3>

- This PR is likely safe to merge; changes are additive schema updates with a small test addition.
- The schema update is straightforward and aligns with existing type definitions, UI hints, and runtime consumption in `src/agents/tools/web-fetch.ts`. No behavioral changes beyond allowing previously-rejected config keys. Main remaining concern is test coverage fidelity (test bypasses `validateConfigObject`).
- src/config/config.web-fetch-firecrawl.test.ts

<!-- greptile_other_comments_section -->

<sub>(3/5) Reply to the agent's comments like "Can you suggest a fix for this @greptileai?" or ask follow-up questions!</sub>

<!-- /greptile_comment -->

## Reviews

### @greptile-apps â€” COMMENTED (2026-02-03)

<sub>1 file reviewed, 1 comment</sub>

<sub>[Edit Code Review Agent Settings](https://app.greptile.com/review/github) | [Greptile](https://greptile.com?utm_source=greptile_expert&utm_medium=github&utm_campaign=code_reviews)</sub>


## Comments

### @tmchow (2026-01-29)

thanks for doing this! i was about to add this myself.


## Stats

- **Size:** medium (52+, 0-, 2 files)
- **Age:** 4 days
- **Last activity:** 2026-02-03

## Links

- Fixes: #2527
