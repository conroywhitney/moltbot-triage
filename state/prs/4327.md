---
number: 4327
title: "Gateway Web Chat: add image/file upload (attach, drag-drop, paste)"
author: RogerHsu7
created: 2026-01-30T02:48:39Z
updated: 2026-01-30T02:52:41Z
labels: ["docs"]
additions: 315
deletions: 0
changed_files: 5
size: large
review_decision: none
reviews: []
comments_count: 1
reactions_total: 0
ci_status: pending
mergeable: unknown
draft: false
url: https://github.com/openclaw/openclaw/pull/4327
fixes_issues: []
related_prs: []
duplicate_of: null
---

## Description

Summary

• Adds attachment support in Gateway web Chat: attach button, drag & drop, and paste-from-clipboard for images.
• Backend: multipart upload endpoint that stores files under the instance media dir and returns MEDIA:/ paths; message API extended to accept media[].
• Frontend: composer queue with file chips, upload progress; message renderer for thumbnails and file tiles.
Motivation
Users of the web console need to share screenshots/logs directly in the browser. Today there is no upload mechanism.

Implementation (draft)

• Backend
• POST /api/media/upload (multipart, repeatable file field). Saves to ~/.clawdbot/media/inbound/<uuid>.<ext>, returns { files: [{ path: 'MEDIA:/...', mime, name, size }] }.
• Extend message creation to accept media[] in addition to text.
• Frontend
• Attach button + hidden input[type=file] multiple.
• Drag & drop overlay and handlers on composer.
• Paste handler captures image blobs from clipboard.
• Attachment queue with progress; after upload, send text + media paths.
• Message renderer displays thumbnails for images and links for other files.
Config & Limits

• Defaults: 25MB per file; up to 5 files per message. Configurable via gateway config.
Security

• Sanitized filenames; type/size validation; stored under instance media path; served via existing media route (auth/signed URLs as applicable).
Acceptance Criteria

• Drag/paste/attach works; messages show thumbnails or file tiles; assistant receives MEDIA:/path.
Notes
This PR ships as a draft to align on API shape and UI placement. Happy to adjust to the codebase conventions and routing.

## Reviews


## Comments

### @RogerHsu7 (2026-01-30)

Plan and next steps (draft)
Scope: add image/file upload to Moltbot Gateway web chat (attach button, drag & drop, paste images)
Backend (draft in drafts/webchat-upload/backend/mediaUpload.ts)
POST /api/media/upload (multipart) → save under instance media dir → return MEDIA:/path
Follow-up: align with existing auth/session, config, and media serving route
Frontend (drafts/webchat-upload/frontend/*)
Composer: queue, upload progress; paste/drag/attach
Renderer: thumbnails for images, file tiles for others
Config defaults: 25MB/file, up to 5 files/message (configurable)
Integration plan

Move backend upload route into gateway server module; use the project’s router/middleware
Wire upload limits to config (gateway.webchat.uploads.*)
Serve MEDIA:/ via existing media route or signed URLs
Extend session message API to accept media[]; persist metadata
Integrate composer UI into the current chat input component
Render media in transcript; click to open/download
Error states: oversize/unsupported type/progress fail
Tests: unit (multipart, limits), e2e (attach/drag/paste)
Acceptance criteria

Drag/paste/attach works in web chat; messages show thumbnails/file tiles
Assistant receives MEDIA:/path and can consume images/files
Notes

This PR is draft to align API/placement; happy to adjust to maintainers’ preferences before wiring everything into the proper dirs.


## Stats

- **Size:** large (315+, 0-, 5 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: (none detected)
