---
number: 4786
title: "fix: Add timezone-based auto-detection for MiniMax API region"
author: spiceoogway
created: 2026-01-30T17:28:28Z
updated: 2026-01-30T17:28:40Z
labels: ["commands"]
additions: 76
deletions: 3
changed_files: 2
size: medium
review_decision: none
reviews: []
comments_count: 0
reactions_total: 0
ci_status: failing
mergeable: true
draft: false
url: https://github.com/openclaw/openclaw/pull/4786
fixes_issues: [4647]
related_prs: [4647]
duplicate_of: null
---

## Description

Fixes #4647

## Summary
Implemented automatic region detection for MiniMax API endpoints based on user timezone. Chinese users (mainland, Hong Kong, Macau, Taiwan) now automatically use the China-specific endpoint (api.minimaxi.com), while overseas users continue using the global endpoint (api.minimax.io).

## Changes
- Added detectMinimaxRegion() function with timezone-based detection
- Created region-specific endpoint mappings for both model and usage APIs
- Added MINIMAX_REGION environment variable for manual override

## Benefits
- Zero configuration for most users - works out of the box
- No breaking changes - existing configurations continue to work
- Resolves connectivity issues for users in mainland China
- Manual override available via environment variable

## Testing
- Linter passed (oxlint): 0 warnings, 0 errors
- Follows project code standards (104 rules, 8 threads)

## Implementation Details

### Timezone Detection
Checks user's timezone against known China regions:
- Asia/Shanghai
- Asia/Chongqing  
- Asia/Urumqi
- Asia/Hong_Kong
- Asia/Macau
- Asia/Taipei

Falls back to global endpoint if detection fails or timezone doesn't match.

### Environment Variable Override
Users can manually specify region:
```bash
export MINIMAX_REGION=cn    # Force China endpoint
export MINIMAX_REGION=global # Force global endpoint
```

### Files Modified
1. src/commands/onboard-auth.models.ts - Model API endpoints
2. src/infra/provider-usage.fetch.minimax.ts - Usage API endpoints

## Related
- Issue: #4647
- Reporter: @shipinliang
- MiniMax Official Docs confirm two separate regional endpoints

## Reviews


## Comments


## Stats

- **Size:** medium (76+, 3-, 2 files)
- **Age:** 0 days
- **Last activity:** 2026-01-30

## Links

- Fixes: #4647
